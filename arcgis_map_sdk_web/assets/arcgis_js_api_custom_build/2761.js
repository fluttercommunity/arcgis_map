"use strict";(self.webpackChunkarcgis_webpack01=self.webpackChunkarcgis_webpack01||[]).push([[2761,5850],{20776:(e,t,a)=>{a.d(t,{Z:()=>d});var r=a(66341),i=a(70375),n=a(78668),s=a(20182),o=a(12928);const c=[137,80,78,71,13,10,26,10];function l(e){const t=new Uint8Array(e);return!c.some(((e,a)=>e!==t[a]))}function h(e){if(!l(e))return!1;const t=new DataView(e),a=new Uint8Array(e);let r,i=8;do{const e=t.getUint32(i);if(r=String.fromCharCode.apply(String,Array.prototype.slice.call(a.subarray(i+4,i+8))),"acTL"===r)return!0;i+=12+e}while("IEND"!==r&&i<a.length);return!1}var u=a(29573),g=a(60211);const f=[71,73,70];function m(e){if(!function(e){const t=new Uint8Array(e);return!f.some(((e,a)=>e!==t[a]))}(e))return!1;const t=new DataView(e),a=t.getUint8(10);let r=13+(128&a?3*2**(1+(7&a)):0),i=0,n=!1;for(;!n;){switch(t.getUint8(r++)){case 33:if(!s())return!1;break;case 44:o();break;case 59:n=!0;break;default:return!1}if(i>1)return!0}function s(){switch(t.getUint8(r++)){case 249:r++,r+=4,c();break;case 1:i++,r++,r+=12,c();break;case 254:c();break;case 255:r++,r+=8,r+=3,c();break;default:return!1}return!0}function o(){i++,r+=8;const e=t.getUint8(r++);r+=128&e?3*2**(1+(7&e)):0,r++,c()}function c(){let e;for(;e=t.getUint8(r++);)r+=e}return!1}class d{constructor(){this._resourceMap=new Map,this._inFlightResourceMap=new Map,this.geometryEngine=null,this.geometryEnginePromise=null}destroy(){this._inFlightResourceMap.clear(),this._resourceMap.clear()}getResource(e){return this._resourceMap.get(e)??null}async fetchResource(e,t){const a=this._resourceMap.get(e);if(a)return{width:a.width,height:a.height};let c=this._inFlightResourceMap.get(e);return c?c.then((e=>({width:e.width,height:e.height}))):(c=async function(e,t){const{arrayBuffer:a,mediaType:c}=await async function(e,t){let a;const s=";base64,";if(e.includes(s)){const t=e.indexOf(s),r=e.indexOf(s)+s.length,i=e.substring(r),n=atob(i),o=new Uint8Array(n.length);for(let e=0;e<n.length;e++)o[e]=n.charCodeAt(e);a={arrayBuffer:o.buffer,mediaType:e.substring(0,t).replace("data:","")}}else try{const i=await(0,r.default)(e,{responseType:"array-buffer",...t});a={arrayBuffer:i.data,mediaType:i.getHeader("Content-Type")}}catch(t){if(!(0,n.D_)(t))throw new i.Z("mapview-invalid-resource",`Could not fetch requested resource at ${e}`)}return a}(e,t),l="image/png"===c;return"image/gif"===c&&m(a)?async function(e,t){const a=(0,g.p)(e),r=(0,g.d)(a,!0),{width:i,height:n}=a.lsd,s=document.createElement("canvas");s.width=i,s.height=n;const c=s.getContext("2d",{willReadFrequently:!0}),l=[],h=[];for(const e of r){h.push((0,o.HA)(e.delay||100));const t=new ImageData(e.patch,e.dims.width,e.dims.height),a=(0,u.E0)(t),r=3===e.disposalType?c.getImageData(e.dims.left,e.dims.top,e.dims.width,e.dims.height):void 0;c.drawImage(a,e.dims.left,e.dims.top);const s=c.getImageData(0,0,i,n);l.push(s),1===e.disposalType||(2===e.disposalType?c.clearRect(e.dims.left,e.dims.top,e.dims.width,e.dims.height):3===e.disposalType&&c.putImageData(r,e.dims.left,e.dims.top))}return{frameDurations:h,getFrame:e=>l[e],width:i,height:n}}(a):l&&h(a)?async function(e,t){const a=(0,s.p)(e);if(a instanceof Error)throw a;await a.createImages(),(0,n.k_)(t);const{frames:r,width:i,height:c}=a,l=document.createElement("canvas");l.width=i,l.height=c;const h=l.getContext("2d",{willReadFrequently:!0}),u=[],g=[];for(const e of r){g.push((0,o.HA)(e.delay||100));const t=e.imageElement;0===e.blendOp?h.globalCompositeOperation="copy":h.globalCompositeOperation="source-over";const a=2===e.disposeOp?h.getImageData(e.left,e.top,e.width,e.height):void 0;h.drawImage(t,e.left,e.top);const r=h.getImageData(0,0,i,c);u.push(r),0===e.disposeOp||(1===e.disposeOp?h.clearRect(e.left,e.top,e.width,e.height):2===e.disposeOp&&h.putImageData(a,e.left,e.top))}return{frameDurations:g,getFrame:e=>u[e],width:i,height:c}}(a,t):async function(e,t){const a=window.URL.createObjectURL(e);try{const{data:e}=await(0,r.default)(a,{...t,responseType:"image"});return e}catch(e){if(!(0,n.D_)(e))throw new i.Z("mapview-invalid-resource",`Could not fetch requested resource at ${a}`);throw e}finally{window.URL.revokeObjectURL(a)}}(new Blob([a],{type:c}),t)}(e,t),this._inFlightResourceMap.set(e,c),c.then((t=>(this._inFlightResourceMap.delete(e),this._resourceMap.set(e,t),{width:t.width,height:t.height})),(()=>({width:0,height:0}))))}deleteResource(e){this._inFlightResourceMap.delete(e),this._resourceMap.delete(e)}}},2059:(e,t,a)=>{a.r(t),a.d(t,{CIMSymbolRasterizer:()=>v,GeometryStyle:()=>r});var r,i,n=a(30936),s=a(66341),o=a(61681),c=a(78668),l=a(95550),h=a(24361),u=a(20776),g=a(34245),f=a(95215),m=a(556),d=a(88005),w=a(60789),p=a(97500),y=a(37939);(i=r||(r={})).Legend="legend",i.Preview="preview";const b=e=>e&&e.scaleFactor?e.scaleFactor:1;class v{constructor(e,t){this._spatialReference=e,this._avoidSDF=t,this._resourceCache=new Map,this._imageDataCanvas=null,this._pictureMarkerCache=new Map,this._textRasterizer=new d.Z,this._cimResourceManager=new u.Z,this._rasterizer=new m.Z(this._cimResourceManager)}get resourceManager(){return this._cimResourceManager}async rasterizeCIMSymbolAsync(e,t,a,r,i,n,s,o){if(!e)return null;const{data:c}=e;if(!c||"CIMSymbolReference"!==c.type||!c.symbol)return null;const{symbol:l}=c;n||(n=(0,w.JW)(l));const h=await f.E0.resolveSymbolOverrides(c,t,this._spatialReference,i,n,s,o);this._imageDataCanvas||(this._imageDataCanvas=document.createElement("canvas"));const u=this._imageDataCanvas,m=this._cimResourceManager,d=[];f.B$.fetchResources(h,m,d),d.length>0&&await Promise.all(d);const{width:p,height:y}=a,b=function(e,t,a,r){const i=1,n=-t/2+i,s=t/2-i,o=a/2-i,c=-a/2+i;switch(e){case"esriGeometryPoint":return{x:0,y:0};case"esriGeometryPolyline":return{paths:[[[n,0],[0,0],[s,0]]]};default:return"legend"===r?{rings:[[[n,o],[s,0],[s,c],[n,c],[n,o]]]}:{rings:[[[n,o],[s,o],[s,c],[n,c],[n,o]]]}}}(n,p,y,r),v=f.B$.getEnvelope(h,b,m);if(!v)return null;const C=1.3333333333333333*(window.devicePixelRatio||1);let M=1,R=0,_=0;switch(l.type){case"CIMPointSymbol":case"CIMTextSymbol":{let e=1;v.width>p&&(e=p/v.width);let t=1;v.height>y&&(t=y/v.height),"preview"===r&&(v.width<p&&(e=p/v.width),v.height<y&&(t=y/v.height)),M=Math.min(e,t),R=v.x+v.width/2,_=v.y+v.height/2}break;case"CIMLineSymbol":{let e=1;v.height>y&&(e=y/v.height),M=e,_=v.y+v.height/2;const t=v.x*M+p/2,a=(v.x+v.width)*M+p/2;if(t<0){const{paths:e}=b;e[0][0][0]-=t}if(a>p){const{paths:e}=b;e[0][2][0]-=a-p}}break;case"CIMPolygonSymbol":{R=v.x+v.width/2,_=v.y+v.height/2;const e=v.x*M+p/2,t=(v.x+v.width)*M+p/2,a=v.y*M+y/2,r=(v.y+v.height)*M+y/2,{rings:i}=b;e<0&&(i[0][0][0]-=e,i[0][3][0]-=e,i[0][4][0]-=e),a<0&&(i[0][0][1]+=a,i[0][1][1]+=a,i[0][4][1]+=a),t>p&&(i[0][1][0]-=t-p,i[0][2][0]-=t-p),r>y&&(i[0][2][1]+=r-y,i[0][3][1]+=r-y)}}u.width=p*C,u.height=y*C;u.width+=2,u.height+=2;const P=u.getContext("2d"),S=g.zA.createIdentity();return S.translate(-R,-_),S.scale(M*C,-M*C),S.translate(p*C/2+1,y*C/2+1),P.clearRect(0,0,u.width,u.height),new g.cD(P,m,S,!0).drawSymbol(h,b),P.getImageData(0,0,u.width,u.height)}async analyzeCIMSymbol(e,t,a,r,i){const n=[],s=t?{geometryType:r,spatialReference:this._spatialReference,fields:t}:null;let o;await(0,h.c)(e.data,s,this._cimResourceManager,n,this._avoidSDF),(0,c.k_)(i);for(const e of n)"CIMPictureMarker"!==e.cim.type&&"CIMPictureFill"!==e.cim.type&&"CIMPictureStroke"!==e.cim.type||(o||(o=[]),o.push(this._fetchPictureMarkerResource(e,i))),a&&"text"===e.type&&"string"==typeof e.text&&e.text.includes("[")&&(e.text=(0,w.Qs)(a,e.text,e.cim.textCase));return o&&await Promise.all(o),n}rasterizeCIMSymbol3D(e,t,a,r,i,n){const s=[];for(const o of e){r&&"function"==typeof r.scaleFactor&&(r.scaleFactor=r.scaleFactor(t,i,n));const e=this._getRasterizedResource(o,t,a,r,i,n);if(!e)continue;let c=0,l=e.anchorX||0,h=e.anchorY||0,u=!1,g=0,f=0;if("esriGeometryPoint"===a){const e=b(r);if(g=(0,w.hf)(o.offsetX,t,i,n)*e||0,f=(0,w.hf)(o.offsetY,t,i,n)*e||0,"marker"===o.type)c=(0,w.hf)(o.rotation,t,i,n)||0,u=!!o.rotateClockwise&&o.rotateClockwise;else if("text"===o.type){if(c=(0,w.hf)(o.angle,t,i,n)||0,void 0!==o.horizontalAlignment)switch(o.horizontalAlignment){case"left":l=-.5;break;case"right":l=.5;break;default:l=0}if(void 0!==o.verticalAlignment)switch(o.verticalAlignment){case"top":h=.5;break;case"bottom":h=-.5;break;case"baseline":h=-.25;break;default:h=0}}}null!=e&&s.push({angle:c,rotateClockWise:u,anchorX:l,anchorY:h,offsetX:g,offsetY:f,rasterizedResource:e})}return this.getSymbolImage(s)}getSymbolImage(e){const t=document.createElement("canvas"),a=(0,o.s3)(t.getContext("2d"));let r=0,i=0,n=0,s=0;const c=[];for(let t=0;t<e.length;t++){const o=e[t],h=o.rasterizedResource;if(!h)continue;const u=h.size,g=o.offsetX,f=o.offsetY,m=o.anchorX,d=o.anchorY,w=o.rotateClockWise||!1;let p=o.angle,y=(0,l.F2)(g)-u[0]*(.5+m),b=(0,l.F2)(f)-u[1]*(.5+d),v=y+u[0],C=b+u[1];if(p){w&&(p=-p);const e=Math.sin(p*Math.PI/180),t=Math.cos(p*Math.PI/180),a=y*t-b*e,r=y*e+b*t,i=y*t-C*e,n=y*e+C*t,s=v*t-C*e,o=v*e+C*t,c=v*t-b*e,l=v*e+b*t;y=Math.min(a,i,s,c),b=Math.min(r,n,o,l),v=Math.max(a,i,s,c),C=Math.max(r,n,o,l)}r=y<r?y:r,i=b<i?b:i,n=v>n?v:n,s=C>s?C:s;const M=a.createImageData(h.size[0],h.size[1]);M.data.set(new Uint8ClampedArray(h.image.buffer));const R={offsetX:g,offsetY:f,rotateClockwise:w,angle:p,rasterizedImage:M,anchorX:m,anchorY:d};c.push(R)}t.width=n-r,t.height=s-i;const h=-r,u=s;for(let e=0;e<c.length;e++){const t=c[e],r=this._imageDataToCanvas(t.rasterizedImage),i=t.rasterizedImage.width,n=t.rasterizedImage.height,s=h-i*(.5+t.anchorX),o=u-n*(.5-t.anchorY);if(t.angle){const e=(360-t.angle)*Math.PI/180;a.save(),a.translate((0,l.F2)(t.offsetX),-(0,l.F2)(t.offsetY)),a.translate(h,u),a.rotate(e),a.translate(-h,-u),a.drawImage(r,s,o),a.restore()}else a.drawImage(r,s+(0,l.F2)(t.offsetX),o-(0,l.F2)(t.offsetY))}const g=new y.e({x:h/t.width-.5,y:u/t.height-.5});return{imageData:0!==t.width&&0!==t.height?a.getImageData(0,0,t.width,t.height):a.createImageData(1,1),anchorPosition:g}}async _fetchPictureMarkerResource(e,t){const a=e.materialHash;if(!this._pictureMarkerCache.get(a)){const r=(await(0,s.default)(e.cim.url,{responseType:"image",signal:t&&t.signal})).data;this._pictureMarkerCache.set(a,r)}}_imageDataToCanvas(e){this._imageDataCanvas||(this._imageDataCanvas=document.createElement("canvas"));const t=this._imageDataCanvas,a=(0,o.s3)(t.getContext("2d"));return t.width=e.width,t.height=e.height,a.putImageData(e,0,0),t}_imageTo32Array(e,t,a,r){this._imageDataCanvas||(this._imageDataCanvas=document.createElement("canvas"));const i=this._imageDataCanvas,s=(0,o.s3)(i.getContext("2d"));if(i.width=t,i.height=a,s.drawImage(e,0,0,t,a),r){s.save();const i=new n.Z(r);s.fillStyle=i.toHex(),s.globalCompositeOperation="multiply",s.fillRect(0,0,t,a),s.globalCompositeOperation="destination-atop",s.drawImage(e,0,0,t,a),s.restore()}return new Uint32Array(s.getImageData(0,0,t,a).data.buffer)}_getRasterizedResource(e,t,a,r,i,n){let s,c,l;if("text"===e.type)return this._rasterizeTextResource(e,t,r,i,n);({analyzedCIM:s,hash:c}=function(e,t,a,r){let i,n;"function"==typeof e.materialHash?(i=(0,e.materialHash)(t,a,r),n=(0,h.S)(e.cim,e.materialOverrides)):(i=e.materialHash,n=e.cim);return{analyzedCIM:n,hash:i}}(e,t,i,n));const u=b(r);if("CIMPictureMarker"===e.cim.type){const a=(0,w.hf)(e.size,t,i,n)*u,{image:r,width:s,height:c}=(0,o.s3)(this._getPictureResource(e,a,(0,w.hf)(e.color,t,i,n)));return l={image:r,size:[s,c],sdf:!1,simplePattern:!1,anchorX:e.anchorPoint?e.anchorPoint.x:0,anchorY:e.anchorPoint?e.anchorPoint.y:0},l}(0,p.FW)(s,u,{preserveOutlineWidth:!1});const g=s;c+=a,r&&(c+=JSON.stringify(r));const f=this._resourceCache;return f.has(c)?f.get(c):(l=this._rasterizer.rasterizeJSONResource({cim:g,type:e.type,url:e.url,mosaicHash:c,size:null,path:null},window.devicePixelRatio||1,this._avoidSDF),f.set(c,l),l)}_rasterizeTextResource(e,t,a,r,i){const n=b(a),s=(0,w.hf)(e.text,t,r,i);if(!s||0===s.length)return null;const o=(0,w.hf)(e.fontName,t,r,i),c=(0,w.hf)(e.style,t,r,i),l=(0,w.hf)(e.weight,t,r,i),h=(0,w.hf)(e.decoration,t,r,i),u=(0,w.hf)(e.size,t,r,i)*n,g=(0,w.hf)(e.horizontalAlignment,t,r,i),f=(0,w.hf)(e.verticalAlignment,t,r,i),m=(0,w.nn)((0,w.hf)(e.color,t,r,i)),d=(0,w.nn)((0,w.hf)(e.outlineColor,t,r,i)),p={color:m,size:u,horizontalAlignment:g,verticalAlignment:f,font:{family:o,style:c,weight:l,decoration:h},halo:{size:(0,w.hf)(e.outlineSize,t,r,i)||0,color:d,style:c},pixelRatio:1,premultiplyColors:!this._avoidSDF};return this._textRasterizer.rasterizeText(s,p)}_getPictureResource(e,t,a){const r=this._pictureMarkerCache.get(e.materialHash);if(!r)return null;const i=r.height/r.width,n=t?i>1?(0,l.F2)(t):(0,l.F2)(t)/i:r.width,s=t?i>1?(0,l.F2)(t)*i:(0,l.F2)(t):r.height;return{image:this._imageTo32Array(r,n,s,a),width:n,height:s}}}},90810:(e,t,a)=>{a.r(t),a.d(t,{previewCIMSymbol:()=>f});var r=a(95550),i=a(95215),n=a(2059),s=a(60789),o=a(83773),c=a(5840);const l=new n.CIMSymbolRasterizer(null,!0),h=(0,r.Wz)(o.b_.size),u=(0,r.Wz)(o.b_.maxSize),g=(0,r.Wz)(o.b_.lineWidth);async function f(e,t={}){const{node:a,opacity:o,symbolConfig:f}=t,m="object"==typeof f&&"isSquareFill"in f&&f.isSquareFill,d=t.cimOptions||t,w=d.geometryType||(0,s.JW)(e?.data?.symbol),p=function(e){const t=e?.size;return"number"==typeof t?{width:t,height:t}:{width:null!=t&&"object"==typeof t&&"width"in t?t.width:null,height:null!=t&&"object"==typeof t&&"height"in t?t.height:null}}(t),{feature:y,fieldMap:b}=d;if(null==p.width||null==p.height){const t=await i.E0.resolveSymbolOverrides(e.data,y,null,b,w);if(!t)return null;(e=e.clone()).data={type:"CIMSymbolReference",symbol:t},e.data.primitiveOverrides=void 0;const a=[];i.B$.fetchResources(t,l.resourceManager,a),a.length>0&&await Promise.all(a);const r=i.B$.getEnvelope(t,null,l.resourceManager),n=r?.width,s=r?.height;p.width="esriGeometryPolygon"===w?h:"esriGeometryPolyline"===w?g:null!=n&&isFinite(n)?Math.min(n,u):h,p.height="esriGeometryPolygon"===w?h:null!=s&&isFinite(s)?Math.max(Math.min(s,u),1):h}const v=await l.rasterizeCIMSymbolAsync(e,y,p,m||"esriGeometryPolygon"!==w?n.GeometryStyle.Preview:n.GeometryStyle.Legend,b,w);if(!v)return null;const{width:C,height:M}=v,R=document.createElement("canvas");R.width=C,R.height=M,R.getContext("2d").putImageData(v,0,0);const _=(0,r.F2)(p.width),P=(0,r.F2)(p.height),S=new Image(_,P);S.src=R.toDataURL(),null!=o&&(S.style.opacity=`${o}`);let I=S;if(null!=t.effectView){const e={shape:{type:"image",x:0,y:0,width:_,height:P,src:S.src},fill:null,stroke:null,offset:[0,0]};I=(0,c.wh)([[e]],[_,P],{effectView:t.effectView})}return a&&I&&a.appendChild(I),I}},31090:(e,t,a)=>{var r,i;function n(e){switch(e){case"left":return r.Left;case"right":return r.Right;case"center":return r.Center}}function s(e){switch(e){case"top":return i.Top;case"middle":return i.Center;case"baseline":return i.Baseline;case"bottom":return i.Bottom}}function o(e){switch(e){case"above-left":case"esriServerPointLabelPlacementAboveLeft":return[r.Right,i.Bottom];case"above-center":case"above-along":case"esriServerPointLabelPlacementAboveCenter":case"esriServerLinePlacementAboveAlong":return[r.Center,i.Bottom];case"above-right":case"esriServerPointLabelPlacementAboveRight":return[r.Left,i.Bottom];case"center-left":case"esriServerPointLabelPlacementCenterLeft":return[r.Right,i.Center];case"center-center":case"center-along":case"esriServerPointLabelPlacementCenterCenter":case"esriServerLinePlacementCenterAlong":case"always-horizontal":case"esriServerPolygonPlacementAlwaysHorizontal":return[r.Center,i.Center];case"center-right":case"esriServerPointLabelPlacementCenterRight":return[r.Left,i.Center];case"below-left":case"esriServerPointLabelPlacementBelowLeft":return[r.Right,i.Top];case"below-center":case"below-along":case"esriServerPointLabelPlacementBelowCenter":case"esriServerLinePlacementBelowAlong":return[r.Center,i.Top];case"below-right":case"esriServerPointLabelPlacementBelowRight":return[r.Left,i.Top];default:return console.debug(`Found invalid placement type ${e}`),[r.Center,i.Center]}}function c(e){switch(e){case r.Right:return-1;case r.Center:return 0;case r.Left:return 1;default:return console.debug(`Found invalid horizontal alignment ${e}`),0}}function l(e){switch(e){case i.Top:return 1;case i.Center:return 0;case i.Bottom:case i.Baseline:return-1;default:return console.debug(`Found invalid vertical alignment ${e}`),0}}function h(e){switch(e){case"left":return r.Left;case"right":return r.Right;case"center":return r.Center}}function u(e){switch(e){case"above-along":case"below-along":case"center-along":case"esriServerLinePlacementAboveAlong":case"esriServerLinePlacementBelowAlong":case"esriServerLinePlacementCenterAlong":return!0;default:return!1}}a.d(t,{Hd:()=>h,M7:()=>r,NS:()=>u,TR:()=>i,b7:()=>s,g:()=>c,kH:()=>n,qv:()=>o,tf:()=>l}),function(e){e[e.Left=-1]="Left",e[e.Center=0]="Center",e[e.Right=1]="Right"}(r||(r={})),function(e){e[e.Top=1]="Top",e[e.Center=0]="Center",e[e.Bottom=-1]="Bottom",e[e.Baseline=2]="Baseline"}(i||(i={}))},8530:(e,t,a)=>{a.d(t,{Au:()=>i,Jz:()=>s,UJ:()=>n});const r=new Float32Array(1);new Uint32Array(r.buffer);function i(e){return[255&e,(65280&e)>>>8,(16711680&e)>>>16,(4278190080&e)>>>24]}function n(e,t){return 65535&e|t<<16}function s(e,t,a,r){return 255&e|(255&t)<<8|(255&a)<<16|r<<24}}}]);