"use strict";(self.webpackChunkarcgis_webpack01=self.webpackChunkarcgis_webpack01||[]).push([[9691],{6415:(e,t,i)=>{i.d(t,{I:()=>b,b:()=>y});var r=i(61681),n=i(69666),s=i(35031),a=i(5885),o=i(4731),c=i(73393),l=i(44391),h=i(32394),u=i(84614),d=i(93072),p=i(24603),_=i(23410),f=i(3961),m=i(15176),g=i(42842),v=i(21414);function y(e){const t=new f.kG,{vertex:i,fragment:y}=t;return(0,u.Sv)(i,e),t.include(o.w,e),t.attributes.add(v.T.POSITION,"vec3"),t.attributes.add(v.T.UV0,"vec2"),t.varyings.add("vpos","vec3"),e.hasMultipassTerrain&&t.varyings.add("depth","float"),i.uniforms.add(new d.A("textureCoordinateScaleFactor",(e=>(0,r.pC)(e.texture)&&(0,r.pC)(e.texture.descriptor.textureCoordinateScaleFactor)?e.texture.descriptor.textureCoordinateScaleFactor:n.O))),i.code.add(_.H`
    void main(void) {
      vpos = position;
      ${e.hasMultipassTerrain?"depth = (view * vec4(vpos, 1.0)).z;":""}
      vTexCoord = uv0 * textureCoordinateScaleFactor;
      gl_Position = transformPosition(proj, view, vpos);
    }
  `),t.include(a.f5,e),t.include(c.l,e),y.uniforms.add([new m.A("tex",(e=>e.texture)),new p.p("opacity",(e=>e.opacity))]),t.varyings.add("vTexCoord","vec2"),e.output===s.H.Alpha?y.code.add(_.H`
    void main() {
      discardBySlice(vpos);
      ${e.hasMultipassTerrain?"terrainDepthTest(gl_FragCoord, depth);":""}

      float alpha = texture2D(tex, vTexCoord).a * opacity;
      if (alpha  < ${_.H.float(l.F)}) {
        discard;
      }

      gl_FragColor = vec4(alpha);
    }
    `):(y.include(h.Y),y.code.add(_.H`
    void main() {
      discardBySlice(vpos);
      ${e.hasMultipassTerrain?"terrainDepthTest(gl_FragCoord, depth);":""}
      gl_FragColor = texture2D(tex, vTexCoord) * opacity;

      if (gl_FragColor.a < ${_.H.float(l.F)}) {
        discard;
      }

      gl_FragColor = highlightSlice(gl_FragColor, vpos);
      ${e.transparencyPassType===g.A.Color?"gl_FragColor = premultiplyAlpha(gl_FragColor);":""}
    }
    `)),t}const b=Object.freeze(Object.defineProperty({__proto__:null,build:y},Symbol.toStringTag,{value:"Module"}))},28347:(e,t,i)=>{i.d(t,{S:()=>S,b:()=>v});var r=i(1983),n=i(32428),s=i(35031),a=i(5885),o=i(4731),c=i(73393),l=i(44391),h=i(32394),u=i(84614),d=i(43036),p=i(63371),_=i(23410),f=i(3961),m=i(42842),g=i(21414);function v(e){const t=new f.kG,i=e.hasMultipassTerrain&&(e.output===s.H.Color||e.output===s.H.Alpha);t.include(o.w,e),t.include(n.A,e),t.include(a.f5,e);const{vertex:r,fragment:v}=t;return v.include(h.Y),(0,u.Sv)(r,e),v.uniforms.add(new p.N("uColor",(e=>e.color))),t.attributes.add(g.T.POSITION,"vec3"),t.varyings.add("vWorldPosition","vec3"),i&&t.varyings.add("depth","float"),e.screenSizeEnabled&&t.attributes.add(g.T.OFFSET,"vec3"),e.shadingEnabled&&((0,u._8)(r),t.attributes.add(g.T.NORMAL,"vec3"),t.varyings.add("vViewNormal","vec3")),r.code.add(_.H`
    void main(void) {
      vWorldPosition = ${e.screenSizeEnabled?"screenSizeScaling(offset, position)":"position"};
  `),e.shadingEnabled&&r.code.add(_.H`vec3 worldNormal = normal;
vViewNormal = (viewNormal * vec4(worldNormal, 1)).xyz;`),r.code.add(_.H`
    ${i?"depth = (view * vec4(vWorldPosition, 1.0)).z;":""}
    gl_Position = transformPosition(proj, view, vWorldPosition);
  }
  `),i&&t.include(c.l,e),v.code.add(_.H`
    void main() {
      discardBySlice(vWorldPosition);
      ${i?"terrainDepthTest(gl_FragCoord, depth);":""}
    `),e.shadingEnabled?(v.uniforms.add(new d.J("shadingDirection",(e=>e.shadingDirection))),v.uniforms.add(new p.N("shadedColor",(e=>y(e.shadingTint,e.color)))),v.code.add(_.H`vec3 viewNormalNorm = normalize(vViewNormal);
float shadingFactor = 1.0 - clamp(-dot(viewNormalNorm, shadingDirection), 0.0, 1.0);
vec4 finalColor = mix(uColor, shadedColor, shadingFactor);`)):v.code.add(_.H`vec4 finalColor = uColor;`),v.code.add(_.H`
      ${e.output===s.H.ObjectAndLayerIdColor?_.H`finalColor.a = 1.0;`:""}
      if (finalColor.a < ${_.H.float(l.b)}) {
        discard;
      }
      ${e.output===s.H.Alpha?_.H`gl_FragColor = vec4(finalColor.a);`:""}

      ${e.output===s.H.Color?_.H`gl_FragColor = highlightSlice(finalColor, vWorldPosition); ${e.transparencyPassType===m.A.Color?"gl_FragColor = premultiplyAlpha(gl_FragColor);":""}`:""}
    }
    `),t}function y(e,t){const i=1-e[3],r=e[3]+t[3]*i;return 0===r?(b[3]=r,b):(b[0]=(e[0]*e[3]+t[0]*t[3]*i)/r,b[1]=(e[1]*e[3]+t[1]*t[3]*i)/r,b[2]=(e[2]*e[3]+t[2]*t[3]*i)/r,b[3]=t[3],b)}const b=(0,r.c)(),S=Object.freeze(Object.defineProperty({__proto__:null,build:v},Symbol.toStringTag,{value:"Module"}))},28376:(e,t,i)=>{i.d(t,{G:()=>a,e:()=>o});var r=i(61681),n=i(90472),s=i(66143);function a(e,t,i,a=!1){const o=(0,n.fM)(e,t);return(0,r.Wi)(o)?null:(o.hasZ&&!a||!(0,r.pC)(i)||(o.z=(0,r.Pt)((0,s.KO)(i,o),0)),o)}function o(e,t,i){i.warnOnce(`Failed to project analysis geometry (id: '${e.id}'), projection from spatial reference (wkid: '${t.wkid}') to view spatial reference is not supported. Projection may be possible after calling projection.load().`)}},46707:(e,t,i)=>{i.d(t,{Z:()=>F});i(91957);var r=i(27755),n=i(31355),s=i(19431),a=i(61681),o=i(95550),c=i(95620),l=i(1662),h=i(34344),u=i(24455),d=i(39100),p=i(55709),_=i(6766),f=i(8909),m=i(69442),g=i(90472),v=i(24568),y=i(56215),b=i(69430),S=i(97537),w=i(68817),E=i(45043),T=i(66143),C=i(40460),A=i(54454),x=i(49394),O=i(53448),R=i(26982),P=i(91258),M=i(67666);class F{constructor(e){this.metadata=void 0,this._camera=new A.V,this._elevation={offset:0,override:null},this.collisionType={type:"point"},this.collisionPriority=0,this._renderObjects=new Array,this.autoScaleRenderObjects=!0,this._available=!0,this._noDisplayCount=0,this._radius=10,this._worldSized=!1,this.focusMultiplier=2,this.touchMultiplier=2.5,this.worldOriented=!1,this._modelTransform=(0,d.c)(),this._worldFrame=null,this._renderLocation=(0,f.c)(),this._renderLocationDirty=!0,this._location=new M.Z({x:0,y:0,z:0}),this._elevationAlignedLocation=new M.Z,this._elevationAlignedLocationDirty=!0,this.interactive=!0,this.selectable=!1,this.grabbable=!0,this.cursor=null,this.grabCursor=null,this._grabbing=!1,this.dragging=!1,this._hovering=!1,this._selected=!1,this._state=P.jg.None,this._focused=!1,this.events=new n.Z.EventEmitter,this._screenLocation={screenPointArray:(0,o.s1)(),renderScreenPointArray:(0,o.J$)(),pixelSize:0},this._screenLocationDirty=!0,this._engineResourcesAddedToStage=!1,this._attached=!1,this._location.spatialReference=e.view.spatialReference;for(const t in e)this[t]=e[t];const t=this.view.state?.camera;t&&this._camera.copyFrom(t)}destroy(){this._removeResourcesFromStage(),this._engineResources=null,this.view=null,this._camera=null}get _stage(){return this.view?._stage}get elevationInfo(){return this._elevationInfo}set elevationInfo(e){this._elevationInfo=e,this._elevationAlignedLocationDirty=!0,this._renderLocationDirty=!0,this._updateEngineObject()}get renderObjects(){return this._renderObjects}set renderObjects(e){this._removeResourcesFromStage(),this._engineResources=null,this._renderObjects=e.slice(),this._updateEngineObject()}set available(e){e!==this._available&&(this._available=e,this._updateEngineObject())}get available(){return this._available}disableDisplay(){return this._noDisplayCount++,1===this._noDisplayCount&&this._updateEngineObject(),{remove:(0,c.IH)((()=>{this._noDisplayCount--,0===this._noDisplayCount&&this._updateEngineObject()}))}}set radius(e){e!==this._radius&&(this._radius=e,this._updateEngineObject())}get radius(){return this._radius}set worldSized(e){e!==this._worldSized&&(this._worldSized=e,this._updateEngineObject())}get worldSized(){return this._worldSized}get modelTransform(){return this._modelTransform}set modelTransform(e){L(e)&&(this._screenLocationDirty=!0),(0,u.c)(this._modelTransform,e),this._updateEngineObject()}get renderLocation(){return this._renderLocationDirty&&(this._renderLocationDirty=!1,this.view.renderCoordsHelper.toRenderCoords(this.elevationAlignedLocation,this._renderLocation),this.worldOriented?(this._worldFrame||(this._worldFrame=(0,d.c)()),function(e,t,i){switch(e.viewingMode){case"local":return(0,u.i)(i),!0;case"global":{const r=(0,m.Iu)(e.renderCoordsHelper.spatialReference);(0,g.PR)(t,0,G,0,r.radius),(0,g.yH)((0,s.Vl)(G[0]),(0,s.Vl)(G[1]),i)}}}(this.view,this._renderLocation,this._worldFrame)):this._worldFrame&&(this._worldFrame=null)),this._renderLocation}set renderLocation(e){this.view.renderCoordsHelper.fromRenderCoords(e,this._location),this.elevationAlignedLocation=this._location}get location(){return this._location}set location(e){(0,E.WG)(e,this._location),this._notifyLocationChanged()}_notifyLocationChanged(){this._renderLocationDirty=!0,this._screenLocationDirty=!0,this._elevationAlignedLocationDirty=!0,this._updateEngineObject(),this.events.emit("location-update",{location:this._location})}get elevationAlignedLocation(){return this._elevationAlignedLocationDirty?(this._evaluateElevationAlignment(),this._updateElevationAlignedLocation(),this._elevationAlignedLocation):this._elevationAlignedLocation}set elevationAlignedLocation(e){(0,E.WG)(e,this._location),this._evaluateElevationAlignment(),this._location.z-=this._elevation.offset,this._updateElevationAlignedLocation(),this._updateEngineObject(),this.events.emit("location-update",{location:this._location})}_updateElevationAlignedLocation(){const e=(0,a.pC)(this._elevation.override)?this._elevation.override:this.location.z||0;this._elevationAlignedLocation.x=this.location.x,this._elevationAlignedLocation.y=this.location.y,this._elevationAlignedLocation.z=e+this._elevation.offset,this._elevationAlignedLocation.spatialReference=(0,E.D)(this.location.spatialReference),this._renderLocationDirty=!0,this._screenLocationDirty=!0,this._elevationAlignedLocationDirty=!1}grabbableForEvent(){return!0}get grabbing(){return this._grabbing}set grabbing(e){e!==this._grabbing&&(this._grabbing=e,this._setFocused(this._hovering||this._grabbing),this._updateEngineObject())}get hovering(){return this._hovering}set hovering(e){e!==this._hovering&&(this._hovering=e,this._setFocused(this._hovering||this._grabbing),this._updateEngineObject())}get selected(){return this._selected}set selected(e){e!==this._selected&&(this._selected=e,this._updateEngineObject(),this.events.emit("select-changed",{action:e?"select":"deselect"}))}get state(){return this._state}set state(e){e!==this._state&&(this._state=e,this._updateEngineObject())}updateStateEnabled(e,t){t?this.state|=e:this.state&=~e}_setFocused(e){e!==this._focused&&(this._focused=e,this.events.emit("focus-changed",{action:!0===e?"focus":"unfocus"}))}get focused(){return this._focused}get screenLocation(){return this._ensureScreenLocation(),this._screenLocation}_ensureScreenLocation(){if(!this._screenLocationDirty)return;let e;if(this._screenLocation.pixelSize=this._camera.computeScreenPixelSizeAt(this.renderLocation),this._screenLocationDirty=!1,L(this._modelTransform)){const t=this._calculateModelTransformOffset(Z);e=(0,_.a)(t,t,this.renderLocation)}else e=this.renderLocation;this._camera.projectToRenderScreen(e,this._screenLocation.renderScreenPointArray),this._camera.renderToScreen(this._screenLocation.renderScreenPointArray,this._screenLocation.screenPointArray)}get applyObjectTransform(){return this._applyObjectTransform}set applyObjectTransform(e){this._applyObjectTransform=e,this._screenLocationDirty=!0,this._updateEngineObject()}get attached(){return this._attached}intersectionDistance(e,t){if(!this.available)return null;const i=(0,o.md)(e,j),n=this._getCollisionRadius(t),s=-1*this.collisionPriority;switch(this.collisionType.type){case"point":if((0,p.k)(this.screenLocation.screenPointArray,i)<n*n)return this.screenLocation.renderScreenPointArray[2]+s;break;case"line":{const e=this.collisionType.paths,t=this._getWorldToScreenObjectScale(),r=this._calculateObjectTransform(t,I),c=n*this.screenLocation.pixelSize,l=(0,C.u4)(this._camera,i,D);if((0,a.Wi)(l))return null;for(const t of e){if(0===t.length)continue;const e=(0,_.m)(G,t[0],r);for(let i=1;i<t.length;i++){const n=(0,_.m)(k,t[i],r),a=(0,y.Gr)((0,y.zk)(e,n,z),l);if(null!=a&&a<c*c){const t=(0,_.a)(w.WM.get(),e,n);(0,_.g)(t,t,.5);const i=(0,o.So)(w.WM.get());return this._camera.projectToRenderScreen(t,i),i[2]+s}(0,_.c)(e,n)}}break}case"disc":{const e=this.collisionType.direction,t=this.collisionType.offset??f.Z,r=this._getWorldToScreenObjectScale(),o=this._calculateObjectTransform(r,I),c=n*this.screenLocation.pixelSize,h=(0,C.u4)(this._camera,i,D);if((0,a.Wi)(h))return null;const u=(0,l.f)(W,o),d=(0,_.t)(V,e,u),p=(0,_.m)(U,t,o);(0,b.Yq)(p,d,N);const m=B;if((0,b.BR)(N,h,m)&&(0,_.d)(m,p)<c*c)return this.screenLocation.renderScreenPointArray[2]+s;break}case"ribbon":{const{paths:e,direction:t}=this.collisionType,r=this._getWorldToScreenObjectScale(),c=this._calculateObjectTransform(r,I),h=n*this._camera.computeScreenPixelSizeAt(this.renderLocation),u=(0,C.u4)(this._camera,i,D);if((0,a.Wi)(u))return null;const d=(0,l.f)(W,c),p=(0,_.t)(V,t,d),f=this._calculateModelTransformPosition(U);(0,b.Yq)(f,p,N);const m=B;if(!(0,b.BR)(N,u,m))break;for(const t of e){if(0===t.length)continue;const e=(0,_.m)(G,t[0],c);for(let i=1;i<t.length;i++){const r=(0,_.m)(k,t[i],c),n=(0,y.Jk)((0,y.zk)(e,r,z),m);if(null!=n&&n<h*h){const t=(0,_.a)(w.WM.get(),e,r);(0,_.g)(t,t,.5);const i=(0,o.So)(w.WM.get());return this._camera.projectToRenderScreen(t,i),i[2]+s}(0,_.c)(e,r)}}break}default:(0,r.Bg)(this.collisionType)}return null}attach(e={manipulator3D:{}}){const t=this._stage;if(!t)return;const i=e.manipulator3D;if((0,a.Wi)(i.engineLayerId)){const e=new R.F({pickable:!1,updatePolicy:O.j.SYNC});t.add(e),i.engineLayerId=e.id,this._engineLayer=e}else t?.getObject&&(this._engineLayer=t.getObject(i.engineLayerId));i.engineLayerReferences=(i.engineLayerReferences||0)+1,this._materialIdReferences=i.materialIdReferences,(0,a.Wi)(this._materialIdReferences)&&(this._materialIdReferences=new Map,i.materialIdReferences=this._materialIdReferences),this._camera.copyFrom(this.view.state.camera),this._attached=!0,this._updateEngineObject(),(0,g.Up)(this._location.spatialReference,this.view.spatialReference)||(this.location=new M.Z({x:0,y:0,z:0,spatialReference:this.view.spatialReference}))}detach(e={manipulator3D:{}}){const t=e.manipulator3D;t.engineLayerReferences--;const i=0===t.engineLayerReferences;i&&(t.engineLayerId=null),this._removeResourcesFromStage(i),this._engineResources=null,this._engineLayer=null,this._materialIdReferences=null,this._attached=!1}onViewChange(){this._camera.copyFrom(this.view.state.camera),this._screenLocationDirty=!0,this._updateEngineObject()}onElevationChange(e){(0,g.nF)(this.location,Q,e.spatialReference)&&(0,v.Qn)(e.extent,Q)&&this._notifyLocationChanged()}_evaluateElevationAlignment(){if((0,a.Wi)(this.elevationInfo))return;let e=null,t=0;const i=(0,a.Pt)(this.elevationInfo.offset,0);switch(this.elevationInfo.mode){case"on-the-ground":e=(0,a.Pt)((0,T.KO)(this.view.elevationProvider,this.location,"ground"),0);break;case"relative-to-ground":t=(0,a.Pt)((0,T.KO)(this.view.elevationProvider,this.location,"ground"),0)+i;break;case"relative-to-scene":t=(0,a.Pt)((0,T.KO)(this.view.elevationProvider,this.location,"scene"),0)+i;break;case"absolute-height":t=i}return t!==this._elevation.offset||e!==this._elevation.override?(this._elevation.offset=t,void(this._elevation.override=e)):void 0}_updateEngineObject(){if(!this._attached)return;if(!this.available)return void this._removeResourcesFromStage();const e=this._getWorldToScreenObjectScale(),t=I;if(!0===this.autoScaleRenderObjects){const i=this._getFocusedSize(this._radius,this.focused)*e;this._calculateObjectTransform(i,t)}else this._calculateObjectTransform(e,t);const{objectsByState:i}=this._ensureEngineResources(),r=(this.focused?P.Q9.Focused:P.Q9.Unfocused)|(this.selected?P.Q9.Selected:P.Q9.Unselected),n=this._noDisplayCount>0;for(const{stateMask:e,objects:s}of i){if(n){for(const e of s)e.visible=!1;continue}const i=(e&P.Q9.All)!==P.Q9.None,a=(e&P.jg.All)!==P.jg.None,o=!i||(r&e)==(e&P.Q9.All),c=!a||(this.state&e)==(e&P.jg.All);if(o&&c)for(const e of s)e.visible=!0,e.transformation=t;else for(const e of s)e.visible=!1}}_ensureEngineResources(){if((0,a.Wi)(this._engineResources)){const e=(0,a.Wg)(this._engineLayer),t=[],i=new Set;this.renderObjects.forEach((({geometry:{material:e}})=>{i.has(e)||(t.push(e),i.add(e))}));const r=new Map;this._renderObjects.forEach((e=>{const t=new x.T({castShadow:!1,geometries:[e.geometry]}),i=r.get(e.stateMask)||[];i.push(t),r.set(e.stateMask,i)}));const n=[];r.forEach(((e,t)=>n.push({stateMask:t,objects:e}))),this._engineResources={objectsByState:n,layer:e,materials:t}}return this._addResourcesToStage(),this._engineResources}_addResourcesToStage(){const e=this._stage;if(this._engineResourcesAddedToStage||(0,a.Wi)(this._engineResources)||!e)return;const{objectsByState:t,layer:i,materials:r}=this._engineResources;r.forEach((t=>{const i=(0,a.Wg)(this._materialIdReferences),r=i.get(t.id)||0;0===r&&e.add(t),i.set(t.id,r+1)})),t.forEach((({objects:t})=>{i.addMany(t),e.addMany(t)})),this._engineResourcesAddedToStage=!0}_removeResourcesFromStage(e=!1){const t=this._stage;if(!this._engineResourcesAddedToStage||(0,a.Wi)(this._engineResources)||!t)return;const{objectsByState:i,layer:r,materials:n}=this._engineResources;i.forEach((({objects:e})=>{r.removeMany(e),t.removeMany(e)})),n.forEach((e=>{const i=(0,a.Wg)(this._materialIdReferences),r=i.get(e.id);1===r?(t.remove(e),i.delete(e.id)):i.set(e.id,r-1)})),e&&t.remove(r),this._engineResourcesAddedToStage=!1}_getCollisionRadius(e){return this._getFocusedSize(this.radius,!0)*("touch"===e?this.touchMultiplier:1)}_getFocusedSize(e,t){return e*(t?this.focusMultiplier:1)}_getWorldToScreenObjectScale(){return this._worldSized?1:this.screenLocation.pixelSize}_calculateModelTransformPosition(e){const t=this._getWorldToScreenObjectScale(),i=this._calculateObjectTransform(t,H);return(0,_.s)(e,i[12],i[13],i[14])}_calculateModelTransformOffset(e){const t=this._calculateModelTransformPosition(e);return(0,_.b)(e,t,this.renderLocation)}_calculateObjectTransform(e,t){return(0,u.s)(t,e,0,0,0,0,e,0,0,0,0,e,0,0,0,0,1),this._worldFrame&&(0,u.m)(t,t,this._worldFrame),(0,u.m)(t,t,this._modelTransform),t[12]+=this.renderLocation[0],t[13]+=this.renderLocation[1],t[14]+=this.renderLocation[2],t[15]=1,(0,a.pC)(this._applyObjectTransform)&&this._applyObjectTransform(t),t}get test(){let e=!1;if((0,a.pC)(this._engineResources))for(const t in this._engineResources.objectsByState){const i=this._engineResources.objectsByState[t];for(const t of i.objects)if(t.visible){e=!0;break}if(e)break}return{areAnyResourcesVisible:e}}}function L(e){return 0!==e[12]||0!==e[13]||0!==e[14]}const j=(0,o.s1)(),z=(0,y.Ue)(),D=(0,S.Ue)(),W=(0,h.c)(),H=(0,d.c)(),I=(0,d.c)(),N=(0,b.Ue)(),G=(0,f.c)(),k=(0,f.c)(),B=(0,f.c)(),V=(0,f.c)(),U=(0,f.c)(),Z=(0,f.c)(),Q=new M.Z({x:0,y:0,z:0,spatialReference:null})},88698:(e,t,i)=>{i.d(t,{r:()=>n});var r=i(91258);class n{constructor(e,t=r.Q9.None){this.geometry=e,this.stateMask=t}}},74390:(e,t,i)=>{i.d(t,{Aq:()=>L,Bz:()=>R,EA:()=>C,Gd:()=>F,Ju:()=>O,X9:()=>M,aD:()=>P,du:()=>j,qJ:()=>A,u2:()=>z});var r=i(61681),n=i(24455),s=i(6766),a=i(8909),o=i(1983),c=i(68817),l=i(45043),h=i(46707),u=i(88698),d=i(14923),p=i(85799),_=i(70984),f=i(45467),m=i(6087),g=i(7358),v=i(21414),y=i(84891),b=i(79591),S=i(9434),w=i(65392),E=i(2070),T=i(91258);function C(e,t=g.yD.OccludeAndTransparent,i=!0){const r=(0,o.f)(e[0],e[1],e[2],e.length>3?e[3]:1),n=e[3]<1;return i?new E.Q({color:r,transparent:n,writeDepth:!0,cullFace:_.Vr.Back,renderOccluded:t}):new y.E({color:r,transparent:n,writeDepth:!0,cullFace:_.Vr.Back,renderOccluded:t})}function A(e,t=g.yD.OccludeAndTransparent){const i=(0,o.f)(e[0],e[1],e[2],4===e.length?e[3]:1);return new y.E({color:i,transparent:!0,writeDepth:!0,cullFace:_.Vr.Front,renderOccluded:t})}const x=Object.freeze({calloutLength:40,calloutWidth:1,discRadius:27,focusMultiplier:1.1,calloutColor:(0,a.f)(1,.5,0)});function O(e,t){const i=new h.Z({view:e,autoScaleRenderObjects:!1,collisionPriority:1,metadata:t.metadata});return R(i,t),i}function R(e,t){const i=t.material??new b.j({transparent:!0,writeDepth:!1,textureId:t.texture?.id,renderOccluded:g.yD.Opaque}),r=t.focusMultiplier??x.focusMultiplier,n=t.calloutLength??x.calloutLength,s=x.discRadius*(t.discScale??1),a=s*r,c=(e,t)=>{const i=[0,1,2,2,3,0];return new f.Z(t,[[v.T.POSITION,new p.a([n-e,-e,0,n+e,-e,0,n+e,e,0,n-e,e,0],3,!0)],[v.T.UV0,new p.a([0,0,1,0,1,1,0,1],2,!0)]],[[v.T.POSITION,i],[v.T.UV0,i]])},l=x.calloutColor,h=t.calloutWidth??x.calloutWidth,d=new(h>1?w.U:S.Y)({width:h,color:(0,o.f)(l[0],l[1],l[2],t.calloutOpacity??1),renderOccluded:g.yD.OccludeAndTransparent}),_=(0,m.rh)(d,[[0,0,0],[n-s,0,0]]),y=(0,m.rh)(d,[[0,0,0],[n-a,0,0]]),E=t.customStateMask??T.jg.None;e.collisionType={type:"disc",direction:[0,0,1],offset:[n,0,0]},e.focusMultiplier=r,e.metadata=t.metadata,e.radius=s,e.renderObjects=[new u.r(c(s,i),T.Q9.Unfocused|E),new u.r(_,T.Q9.Unfocused|E),new u.r(c(a,i),T.Q9.Focused|E),new u.r(y,T.Q9.Focused|E)]}function P(e,t,i=1,r=T.jg.None){const n=C((0,o.f)(t[0],t[1],t[2],null!=i?i:1)),s=[new u.r((0,m.PI)(n,1,32,32),r)];return new h.Z({view:e,renderObjects:s})}const M=Object.freeze({autoScaleRenderObjects:!1,worldSized:!0});function F(e,t,i,r){const a=(0,s.b)(c.WM.get(),e,i),o=L(a,(0,s.f)(c.WM.get(),r,a),i,c.MP.get());(0,n.a)(o,o);const l=(0,s.m)(c.WM.get(),t,o);return Math.atan2(l[1],l[0])}function L(e,t,i,r){const n=(0,s.n)(c.WM.get(),e),a=(0,s.n)(c.WM.get(),t),o=(0,s.f)(c.WM.get(),n,a);return r[0]=n[0],r[1]=n[1],r[2]=n[2],r[3]=0,r[4]=a[0],r[5]=a[1],r[6]=a[2],r[7]=0,r[8]=o[0],r[9]=o[1],r[10]=o[2],r[11]=0,r[12]=i[0],r[13]=i[1],r[14]=i[2],r[15]=1,r}function j(e,t){const i=e.getViewForGraphic(t);return(0,r.pC)(i)&&"computeAttachmentOrigin"in i?i.computeAttachmentOrigin(t,e.spatialReference):null}function z(e,t,i){const n=j(e,i);(0,r.pC)(n)?t.elevationAlignedLocation=n:function(e,t){if((0,r.Wi)(t))return;const i="mesh"===t.type?t.anchor:(0,d.zE)(t);(0,r.Wi)(i)||(e.location=(0,l.kB)(i))}(t,i.geometry)}},37926:(e,t,i)=>{i.d(t,{r:()=>p});var r=i(61681),n=i(24455),s=i(39100),a=i(6766),o=i(8909),c=i(1983),l=i(10449),h=i(24370),u=i(7358),d=i(65392);class p extends l._{constructor(e,t){super(e),this._hasExternalMaterial=!1,this._hasExternalMaterial=(0,r.pC)(t),this._material=(0,r.pC)(t)?t:new d.U({width:1,color:(0,c.f)(1,0,1,1),stippleOffColor:null,stipplePattern:null,stipplePreferContinuous:!0,isClosed:!1,falloff:0,innerColor:null,innerWidth:1,hasPolygonOffset:!1,renderOccluded:u.yD.OccludeAndTransparent,writeDepth:!0}),this.applyProps(e)}setGeometryFromRenderSpacePoint(e,t=1e3){this.geometry=[[[e[0]-t,e[1]+0,e[2]+0],[e[0]+t,e[1]+0,e[2]+0]],[[e[0]-0,e[1]-t,e[2]+0],[e[0]+0,e[1]+t,e[2]+0]],[[e[0]-0,e[1]+0,e[2]-t],[e[0]+0,e[1]+0,e[2]+t]]]}setGeometryFromExtent(e){const t=this.view.spatialReference,i=(0,o.c)(),r=(0,o.c)(),n=100,s=[];(0,a.s)(i,e[0],e[1],n),this.view.renderCoordsHelper.toRenderCoords(i,t,r),s.push([r[0],r[1],r[2]]),(0,a.s)(i,e[2],e[1],n),this.view.renderCoordsHelper.toRenderCoords(i,t,r),s.push([r[0],r[1],r[2]]),(0,a.s)(i,e[2],e[3],n),this.view.renderCoordsHelper.toRenderCoords(i,t,r),s.push([r[0],r[1],r[2]]),(0,a.s)(i,e[0],e[3],n),this.view.renderCoordsHelper.toRenderCoords(i,t,r),s.push([r[0],r[1],r[2]]),(0,a.s)(i,e[0],e[1],n),this.view.renderCoordsHelper.toRenderCoords(i,t,r),s.push([r[0],r[1],r[2]]),(0,a.s)(i,e[0],e[1],n),this.view.renderCoordsHelper.toRenderCoords(i,t,r),s.push([r[0],r[1],r[2]]),this.geometry=[s]}setGeometryFromFrustum(e){const t=[];e.lines.forEach((e=>{t.push([e.origin[0],e.origin[1],e.origin[2]]),t.push([e.endpoint[0],e.endpoint[1],e.endpoint[2]])})),this.geometry=[t]}setGeometryFromBoundedPlane(e){const t=[],i=e.origin,r=e.basis1,n=e.basis2,s=.5,a=(0,o.c)(),c=(0,o.c)(),l=(0,o.c)(),h=(0,o.c)();a[0]=i[0]-r[0]*s-n[0]*s,a[1]=i[1]-r[1]*s-n[1]*s,a[2]=i[2]-r[2]*s-n[2]*s,c[0]=i[0]-r[0]*s+n[0]*s,c[1]=i[1]-r[1]*s+n[1]*s,c[2]=i[2]-r[2]*s+n[2]*s,l[0]=i[0]+r[0]*s+n[0]*s,l[1]=i[1]+r[1]*s+n[1]*s,l[2]=i[2]+r[2]*s+n[2]*s,h[0]=i[0]+r[0]*s-n[0]*s,h[1]=i[1]+r[1]*s-n[1]*s,h[2]=i[2]+r[2]*s-n[2]*s,t.push([a[0],a[1],a[2]]),t.push([c[0],c[1],c[2]]),t.push([l[0],l[1],l[2]]),t.push([h[0],h[1],h[2]]),t.push([a[0],a[1],a[2]]),this.geometry=[t]}setGeometryFromSegment(e){const t=e.endRenderSpace;this.transform=(0,n.f)(_,t);const{points:i}=e.createRenderGeometry(t,this.view.renderCoordsHelper);this.geometry=[i]}setGeometryFromSegments(e,t=o.Z){this.transform=(0,n.f)(_,t),this.geometry=e.map((e=>e.createRenderGeometry(t,this.view.renderCoordsHelper).points))}getTransformedGeometry(){return(0,r.Wi)(this._geometry)?null:this._geometry.map((e=>e.map((e=>(0,a.m)((0,o.c)(),e,this.transform)))))}get renderOccluded(){return this._material.parameters.renderOccluded}set renderOccluded(e){this._material.setParameters({renderOccluded:e})}get geometry(){return this._geometry}set geometry(e){this._geometry=e,this.recreateGeometry()}get width(){return this._material.parameters.width}set width(e){this._material.setParameters({width:e})}get color(){return this._material.parameters.color}set color(e){this._material.setParameters({color:(0,c.d)(e)})}get innerWidth(){return this._material.parameters.innerWidth}set innerWidth(e){this._material.setParameters({innerWidth:e})}get innerColor(){return this._material.parameters.innerColor}set innerColor(e){this._material.setParameters({innerColor:(0,r.pC)(e)?(0,c.d)(e):null})}get stipplePattern(){return this._material.parameters.stipplePattern}set stipplePattern(e){(0,r.pC)(this._material)&&this._material.setParameters({stipplePattern:e})}get stippleOffColor(){return this._material.parameters.stippleOffColor}set stippleOffColor(e){this._material.setParameters({stippleOffColor:(0,r.pC)(e)?(0,c.d)(e):null})}get stipplePreferContinuous(){return this._material.parameters.stipplePreferContinuous}set stipplePreferContinuous(e){this._material.setParameters({stipplePreferContinuous:e})}get writeDepthEnabled(){return this._material.parameters.writeDepth}set writeDepthEnabled(e){this._material.setParameters({writeDepth:e})}get falloff(){return this._material.parameters.falloff}set falloff(e){this._material.setParameters({falloff:e})}get polygonOffset(){return this._material.parameters.hasPolygonOffset}set polygonOffset(e){this._material.setParameters({hasPolygonOffset:e})}createExternalResources(){}destroyExternalResources(){}createGeometries(e){for(const t of(0,h.c)(this.geometry)){const i=(0,h.Y)((0,r.Wg)(this._material),t);e.addGeometry(i)}}forEachExternalMaterial(e){this._hasExternalMaterial||e((0,r.Wg)(this._material))}}const _=(0,s.c)()},10449:(e,t,i)=>{i.d(t,{_:()=>h});var r=i(61681),n=i(24455),s=i(39100),a=i(76169),o=i(49394),c=i(53448),l=i(26982);class h extends a.l{constructor(e){super(e.view),this._resources=null,this._transform=(0,s.c)()}get object(){return(0,r.pC)(this._resources)?this._resources.object:null}get transform(){return this._transform}set transform(e){(0,n.c)(this._transform,e),(0,r.pC)(this._resources)&&(this._resources.object.transformation=this._transform)}recreate(){this.attached&&this.createResources()}recreateGeometry(){if((0,r.Wi)(this._resources))return;const e=this._resources.object,t=this.view._stage;t.removeMany(e.geometries),e.removeAllGeometries(),this.createGeometries(e),e.visible=this.visible,t.addMany(e.geometries)}createResources(){this.destroyResources();const e=this.view._stage;if(!e)return;const t=new l.F({pickable:!1,updatePolicy:c.j.SYNC});e.add(t);const i=new o.T({castShadow:!1});i.transformation=this._transform,this.createExternalResources(),this.createGeometries(i),e.addMany(i.geometries),this.forEachExternalMaterial((t=>e.add(t))),e.add(i),t.add(i),i.visible=this.visible,this._resources={layer:t,object:i}}destroyResources(){const e=this.view._stage;!(0,r.Wi)(this._resources)&&e&&(e.remove(this._resources.object),e.remove(this._resources.layer),this.forEachExternalMaterial((t=>{e.remove(t),t.dispose()})),e.removeMany(this._resources.object.geometries),this._resources.object.dispose(),this.destroyExternalResources(),this._resources=null)}updateVisibility(e){(0,r.Wi)(this._resources)||(this._resources.object.visible=e)}}},76169:(e,t,i)=>{i.d(t,{l:()=>n});var r=i(76868);class n{constructor(e){this._attached=!1,this._resourcesCreated=!1,this._visible=!0,this.view=e,this._handle=(0,r.YP)((()=>this.view.ready),(e=>{this._resourcesCreated&&(e?this._createResources():this._destroyResources())}))}applyProps(e){let t=!1;for(const i in e)i in this?"attached"===i?t=e[i]:this[i]=e[i]:console.error("Cannot set unknown property",i);this.attached=t}destroy(){this.attached=!1,this._handle.remove()}get attached(){return this._attached}set attached(e){e!==this._attached&&this.view._stage&&(this._attached=e,this._attached&&!this._resourcesCreated?this._createResources():!this._attached&&this._resourcesCreated&&this._destroyResources(),this.onAttachedChange(e))}onAttachedChange(e){}get visible(){return this._visible}set visible(e){e!==this._visible&&(this._visible=e,this.attached&&this.updateVisibility(e))}_createResources(){this.createResources(),this._resourcesCreated=!0,this.updateVisibility(this.visible)}_destroyResources(){this.destroyResources(),this._resourcesCreated=!1}}},32428:(e,t,i)=>{i.d(t,{A:()=>a});var r=i(84614),n=i(24603),s=i(23410);function a(e,t){if(!t.screenSizeEnabled)return;const i=e.vertex;(0,r.hY)(i,t),i.uniforms.add(new n.p("perScreenPixelRatio",((e,t)=>t.camera.perScreenPixelRatio))),i.uniforms.add(new n.p("screenSizeScale",(e=>e.screenSizeScale))),i.code.add(s.H`float computeRenderPixelSizeAt( vec3 pWorld ){
vec3 viewForward = - vec3(view[0][2], view[1][2], view[2][2]);
float viewDirectionDistance = abs(dot(viewForward, pWorld - cameraPosition));
return viewDirectionDistance * perScreenPixelRatio;
}
vec3 screenSizeScaling(vec3 position, vec3 anchor){
return position * screenSizeScale * computeRenderPixelSizeAt(anchor) + anchor;
}`)}},79591:(e,t,i)=>{i.d(t,{j:()=>x});var r=i(35031),n=i(70984),s=i(80776),a=i(7358),o=i(12045),c=i(46378),l=i(79601),h=i(85266),u=i(10056),d=i(36663),p=(i(23410),i(9969)),_=i(52756),f=i(67197),m=i(5474),g=i(95194),v=i(79040),y=i(42842),b=i(86942),S=i(6415),w=i(91907),E=i(17346);class T extends _.A{initializeProgram(e){return new g.$(e.rctx,T.shader.get().build(this.configuration),m.i)}_setPipelineState(e,t){const i=this.configuration,n=e===y.A.NONE,s=e===y.A.FrontFace;return(0,E.sm)({blending:i.output!==r.H.Color&&i.output!==r.H.Alpha||!i.transparent?null:n?C:(0,o.j7)(e),culling:(0,E.zp)(i.cullFace),depthTest:{func:(0,o.Bh)(e)},depthWrite:n?i.writeDepth?E.LZ:null:(0,o.K5)(e),colorWrite:E.BK,stencilWrite:i.hasOccludees?v.s3:null,stencilTest:i.hasOccludees?t?v.eD:v.RY:null,polygonOffset:n||s?null:(0,o.je)(i.enableOffset)})}initializePipeline(){return this._occludeePipelineState=this._setPipelineState(this.configuration.transparencyPassType,!0),this._setPipelineState(this.configuration.transparencyPassType,!1)}getPipelineState(e,t){return t?this._occludeePipelineState:super.getPipelineState(e,t)}}T.shader=new p.J(S.I,(()=>i.e(7204).then(i.bind(i,47204))));const C=(0,E.if)(w.zi.ONE,w.zi.ONE_MINUS_SRC_ALPHA);class A extends b.W{constructor(){super(...arguments),this.output=r.H.Color,this.cullFace=n.Vr.None,this.hasSlicePlane=!1,this.transparent=!1,this.enableOffset=!0,this.writeDepth=!0,this.hasOccludees=!1,this.transparencyPassType=y.A.NONE,this.hasMultipassTerrain=!1,this.cullAboveGround=!1}}(0,d._)([(0,f.o)({count:r.H.COUNT})],A.prototype,"output",void 0),(0,d._)([(0,f.o)({count:n.Vr.COUNT})],A.prototype,"cullFace",void 0),(0,d._)([(0,f.o)()],A.prototype,"hasSlicePlane",void 0),(0,d._)([(0,f.o)()],A.prototype,"transparent",void 0),(0,d._)([(0,f.o)()],A.prototype,"enableOffset",void 0),(0,d._)([(0,f.o)()],A.prototype,"writeDepth",void 0),(0,d._)([(0,f.o)()],A.prototype,"hasOccludees",void 0),(0,d._)([(0,f.o)({count:y.A.COUNT})],A.prototype,"transparencyPassType",void 0),(0,d._)([(0,f.o)()],A.prototype,"hasMultipassTerrain",void 0),(0,d._)([(0,f.o)()],A.prototype,"cullAboveGround",void 0);class x extends u.c{constructor(e){super(e,new R),this.supportsEdges=!0,this._configuration=new A}getConfiguration(e,t){return this._configuration.output=e,this._configuration.cullFace=this.parameters.cullFace,this._configuration.hasSlicePlane=this.parameters.hasSlicePlane,this._configuration.transparent=this.parameters.transparent,this._configuration.writeDepth=this.parameters.writeDepth,this._configuration.hasOccludees=this.parameters.hasOccludees,this._configuration.transparencyPassType=t.transparencyPassType,this._configuration.enableOffset=t.camera.relativeElevation<o.ve,this._configuration.hasMultipassTerrain=t.multipassTerrain.enabled,this._configuration.cullAboveGround=t.multipassTerrain.cullAboveGround,this._configuration}requiresSlot(e,t){return(t===r.H.Color||t===r.H.Alpha||t===r.H.Highlight)&&(e===c.r.DRAPED_MATERIAL||(t===r.H.Highlight?e===c.r.OPAQUE_MATERIAL:e===(this.parameters.transparent?this.parameters.writeDepth?c.r.TRANSPARENT_MATERIAL:c.r.TRANSPARENT_DEPTH_WRITE_DISABLED_MATERIAL:c.r.OPAQUE_MATERIAL)))}createGLMaterial(e){return new O(e)}createBufferWriter(){return new l.G(h.W1)}}class O extends s.F{constructor(e){super({...e,...e.material.parameters})}_updateParameters(e){return this.updateTexture(this._material.parameters.textureId),this._material.setParameters(this.textureBindParameters),this.ensureTechnique(T,e)}_updateOccludeeState(e){e.hasOccludees!==this._material.parameters.hasOccludees&&(this._material.setParameters({hasOccludees:e.hasOccludees}),this._updateParameters(e))}beginSlot(e){return this._output!==r.H.Color&&this._output!==r.H.Alpha||this._updateOccludeeState(e),this._updateParameters(e)}}class R extends a.Mt{constructor(){super(...arguments),this.transparent=!1,this.writeDepth=!0,this.hasSlicePlane=!1,this.cullFace=n.Vr.None,this.hasOccludees=!1,this.opacity=1,this.textureId=null,this.initTextureTransparent=!0}}},2070:(e,t,i)=>{i.d(t,{Q:()=>F});var r=i(6766),n=i(8909),s=i(1983),a=i(37116),o=i(81936),c=i(44685),l=i(35031),h=i(70984),u=i(5079),d=i(7358),p=i(46378),_=i(15095),f=i(21414),m=i(21123),g=i(25584),v=i(36663),y=i(9969),b=i(52756),S=i(67197),w=i(12045),E=i(95194),T=i(42842),C=i(86942),A=i(28347),x=i(91907),O=i(17346);class R extends b.A{initializeProgram(e){return new E.$(e.rctx,R.shader.get().build(this.configuration),M)}_setPipelineState(e){const t=this.configuration,i=e===T.A.NONE,r=e===T.A.FrontFace;return(0,O.sm)({blending:t.output!==l.H.Color&&t.output!==l.H.Alpha||!t.transparent?null:i?w.wu:(0,w.j7)(e),culling:(0,O.zp)(t.cullFace),depthTest:{func:r?x.wb.LESS:t.shadingEnabled?x.wb.LEQUAL:x.wb.LESS},depthWrite:i?t.writeDepth?O.LZ:null:(0,w.K5)(e),colorWrite:O.BK,polygonOffset:i||r?null:w.E0})}initializePipeline(){return this._setPipelineState(this.configuration.transparencyPassType)}}R.shader=new y.J(A.S,(()=>i.e(1146).then(i.bind(i,31146))));class P extends C.W{constructor(){super(...arguments),this.output=l.H.Color,this.cullFace=h.Vr.None,this.transparencyPassType=T.A.NONE,this.hasSlicePlane=!1,this.transparent=!1,this.writeDepth=!0,this.screenSizeEnabled=!0,this.shadingEnabled=!0,this.hasMultipassTerrain=!1,this.cullAboveGround=!1}}(0,v._)([(0,S.o)({count:l.H.COUNT})],P.prototype,"output",void 0),(0,v._)([(0,S.o)({count:h.Vr.COUNT})],P.prototype,"cullFace",void 0),(0,v._)([(0,S.o)({count:T.A.COUNT})],P.prototype,"transparencyPassType",void 0),(0,v._)([(0,S.o)()],P.prototype,"hasSlicePlane",void 0),(0,v._)([(0,S.o)()],P.prototype,"transparent",void 0),(0,v._)([(0,S.o)()],P.prototype,"writeDepth",void 0),(0,v._)([(0,S.o)()],P.prototype,"screenSizeEnabled",void 0),(0,v._)([(0,S.o)()],P.prototype,"shadingEnabled",void 0),(0,v._)([(0,S.o)()],P.prototype,"hasMultipassTerrain",void 0),(0,v._)([(0,S.o)()],P.prototype,"cullAboveGround",void 0);const M=new Map([[f.T.POSITION,0],[f.T.NORMAL,1],[f.T.OFFSET,2]]);class F extends d.F5{constructor(e){super(e,new j),this.supportsEdges=!0,this._configuration=new P,this._vertexAttributeLocations=M}getConfiguration(e,t){return this._configuration.output=e,this._configuration.cullFace=this.parameters.cullFace,this._configuration.hasSlicePlane=this.parameters.hasSlicePlane,this._configuration.transparent=this.parameters.transparent,this._configuration.writeDepth=this.parameters.writeDepth,this._configuration.screenSizeEnabled=this.parameters.screenSizeEnabled,this._configuration.shadingEnabled=this.parameters.shadingEnabled,this._configuration.transparencyPassType=t.transparencyPassType,this._configuration.hasMultipassTerrain=t.multipassTerrain.enabled,this._configuration.cullAboveGround=t.multipassTerrain.cullAboveGround,this._configuration}intersect(e,t,i,n,s,o){if(this.parameters.screenSizeEnabled){const t=e.vertexAttributes.get(f.T.OFFSET),c={applyToVertex:(e,n,s,a)=>{const o=(0,r.s)(D,t.data[3*a+0],t.data[3*a+1],t.data[3*a+2]),c=(0,r.s)(W,e,n,s);return(0,r.g)(o,o,this.parameters.screenSizeScale*i.camera.computeRenderPixelSizeAt(o)),(0,r.a)(c,c,o),[c[0],c[1],c[2]]},applyToAabb:e=>{const t=(0,a.be)(e,D);return(0,a.bA)(e,this.parameters.screenSizeScale*i.camera.computeRenderPixelSizeAt(t))}};(0,g.Bw)(e,i,n,s,c,o)}else(0,g.Bw)(e,i,n,s,void 0,o)}requiresSlot(e,t){if(t===l.H.Highlight)return e===p.r.OPAQUE_MATERIAL;if(t===l.H.Color||t===l.H.Alpha||t===l.H.ObjectAndLayerIdColor){let t=p.r.OPAQUE_MATERIAL;return this.parameters.transparent&&(t=this.parameters.writeDepth?p.r.TRANSPARENT_MATERIAL:p.r.TRANSPARENT_DEPTH_WRITE_DISABLED_MATERIAL),e===t||e===p.r.DRAPED_MATERIAL}return!1}createGLMaterial(e){return new L(e)}createBufferWriter(){return new z(this.parameters.screenSizeEnabled)}}class L extends u.Z{beginSlot(e){return this.ensureTechnique(R,e)}}class j extends d.Mt{constructor(){super(...arguments),this.color=(0,s.f)(1,1,1,1),this.shadingTint=(0,s.f)(0,0,0,.25),this.shadingDirection=(0,r.n)((0,n.c)(),[.5,-.5,-.5]),this.screenSizeScale=14,this.transparent=!1,this.writeDepth=!0,this.hasSlicePlane=!1,this.cullFace=h.Vr.None,this.screenSizeEnabled=!1,this.shadingEnabled=!0}}class z{constructor(e){this.screenSizeEnabled=e;const t=(0,c.U$)().vec3f(f.T.POSITION).vec3f(f.T.NORMAL);this.screenSizeEnabled&&t.vec3f(f.T.OFFSET),this.vertexBufferLayout=t}allocate(e){return this.vertexBufferLayout.createBuffer(e)}elementCount(e){return e.indices.get(f.T.POSITION).length}write(e,t,i,r,n){if((0,m.NK)(i,this.vertexBufferLayout,e,t,r,n),this.screenSizeEnabled){if(!i.vertexAttributes.has(f.T.OFFSET))throw new Error(`${f.T.OFFSET} vertex attribute required for screenSizeEnabled ShadedColorMaterial`);{const e=i.vertexAttributes.get(f.T.OFFSET),s=i.indices.get(f.T.OFFSET);(0,_.hu)(3===e.size);const a=r.getField(f.T.OFFSET,o.ct);if(!a)throw new Error("unable to acquire view for "+f.T.OFFSET);(0,m.ho)(s,e.data,t,a,n)}}}}const D=(0,n.c)(),W=(0,n.c)()},50749:(e,t,i)=>{i.d(t,{Ru:()=>h,bA:()=>l,cM:()=>u,e7:()=>c,pB:()=>o});var r=i(19431),n=i(24568),s=i(79880),a=i(38028);function o(e,t,i,r){if(null==r||e.hasZ||(r=void 0),"point"===e.type)return e.x+=t,e.y+=i,e.hasZ&&null!=r&&(e.z+=r),e;if("multipoint"===e.type){const n=e.points;for(let e=0;e<n.length;e++)n[e]=d(n[e],t,i,r);return e}if("extent"===e.type)return e.xmin+=t,e.xmax+=t,e.ymin+=i,e.ymax+=i,null!=r&&(e.zmin??(e.zmin=0),e.zmin+=r,e.zmax??(e.zmax=0),e.zmax+=r),e;const n=(0,a.nA)(e),s="polyline"===e.type?e.paths:e.rings;for(let e=0;e<n.length;e++){const s=n[e];for(let e=0;e<s.length;e++)s[e]=d(s[e],t,i,r)}return"paths"in e?e.paths=s:e.rings=s,e}function c(e,t,i,r,n){const s=e.clone(),c=r.resolution;if("point"===s.type){if(n)o(s,t*c,-i*c);else{const e=r.state.transform,n=r.state.inverseTransform,a=e[0]*s.x+e[2]*s.y+e[4],o=e[1]*s.x+e[3]*s.y+e[5];s.x=n[0]*(a+t)+n[2]*(o+i)+n[4],s.y=n[1]*(a+t)+n[3]*(o+i)+n[5]}return s}if("multipoint"===s.type){if(n)o(s,t*c,-i*c);else{const e=s.points,n=r.state.transform,a=r.state.inverseTransform;for(let r=0;r<e.length;r++){const s=e[r],o=n[0]*s[0]+n[2]*s[1]+n[4],c=n[1]*s[0]+n[3]*s[1]+n[5],l=a[0]*(o+t)+a[2]*(c+i)+a[4],h=a[1]*(o+t)+a[3]*(c+i)+a[5];e[r]=p(s,l,h,void 0)}}return s}if("extent"===s.type){if(n)o(s,t*c,-i*c);else{const e=r.state.transform,n=r.state.inverseTransform,a=e[0]*s.xmin+e[2]*s.ymin+e[4],o=e[1]*s.xmin+e[3]*s.ymin+e[5],c=e[0]*s.xmax+e[2]*s.ymax+e[4],l=e[1]*s.xmax+e[3]*s.ymax+e[5];s.xmin=n[0]*(a+t)+n[2]*(o+i)+n[4],s.ymin=n[1]*(a+t)+n[3]*(o+i)+n[5],s.xmax=n[0]*(c+t)+n[2]*(l+i)+n[4],s.ymax=n[1]*(c+t)+n[3]*(l+i)+n[5]}return s}if(n)o(s,t*c,-i*c);else{const e=(0,a.nA)(s),n="polyline"===s.type?s.paths:s.rings,o=r.state.transform,c=r.state.inverseTransform;for(let r=0;r<e.length;r++){const n=e[r];for(let e=0;e<n.length;e++){const r=n[e],s=o[0]*r[0]+o[2]*r[1]+o[4],a=o[1]*r[0]+o[3]*r[1]+o[5],l=c[0]*(s+t)+c[2]*(a+i)+c[4],h=c[1]*(s+t)+c[3]*(a+i)+c[5];n[e]=p(r,l,h,void 0)}}"paths"in s?s.paths=n:s.rings=n}return s}function l(e,t,i,r){if("point"===e.type){const{x:n,y:s}=e,a=r?r[0]:n,o=r?r[1]:s,c=e.clone(),l=(n-a)*t+a,h=(s-o)*i+o;return c.x=l,c.y=h,c}if("multipoint"===e.type){const o=(0,a.nA)(e),c=(0,n.Ue)(),[l,h,u,d]=(0,s.C6)(c,[o]),_=r?r[0]:(l+u)/2,f=r?r[1]:(d+h)/2,m=e.clone(),g=m.points;for(let e=0;e<g.length;e++){const r=g[e],[n,s]=r,a=(n-_)*t+_,o=(s-f)*i+f;g[e]=p(r,a,o,void 0)}return m}if("extent"===e.type){const{xmin:n,xmax:s,ymin:a,ymax:o}=e,c=r?r[0]:(n+s)/2,l=r?r[1]:(o+a)/2,h=e.clone();if(h.xmin=(n-c)*t+c,h.ymax=(o-l)*i+l,h.xmax=(s-c)*t+c,h.ymin=(a-l)*i+l,h.xmin>h.xmax){const e=h.xmin,t=h.xmax;h.xmin=t,h.xmax=e}if(h.ymin>h.ymax){const e=h.ymin,t=h.ymax;h.ymin=t,h.ymax=e}return h}const o=(0,a.nA)(e),c=(0,n.Ue)(),[l,h,u,d]=(0,s.C6)(c,o),_=r?r[0]:(l+u)/2,f=r?r[1]:(d+h)/2,m=e.clone(),g="polyline"===m.type?m.paths:m.rings;for(let e=0;e<o.length;e++){const r=o[e];for(let n=0;n<r.length;n++){const s=r[n],[a,o]=s,c=(a-_)*t+_,l=(o-f)*i+f;g[e][n]=p(s,c,l,void 0)}}return"paths"in m?m.paths=g:m.rings=g,m}function h(e,t,i,r,n,s){const a=Math.sqrt((i-e)*(i-e)+(r-t)*(r-t));return Math.sqrt((n-e)*(n-e)+(s-t)*(s-t))/a}function u(e,t,i,n=!1){const s=Math.atan2(t.y-i.y,t.x-i.x)-Math.atan2(e.y-i.y,e.x-i.x),a=Math.atan2(Math.sin(s),Math.cos(s));return n?a:(0,r.BV)(a)}function d(e,t,i,r){return p(e,e[0]+t,e[1]+i,null!=e[2]&&null!=r?e[2]+r:void 0)}function p(e,t,i,r){const n=[t,i];return e.length>2&&n.push(null!=r?r:e[2]),e.length>3&&n.push(e[3]),n}},68610:(e,t,i)=>{i.d(t,{m:()=>f});var r,n,s=i(36663),a=i(53443),o=i(13802),c=i(61681),l=i(78668),h=i(81977),u=(i(7283),i(7753),i(40266)),d=i(91258),p=i(41831);(n=r||(r={}))[n.WhenToolEditable=0]="WhenToolEditable",n[n.WhenToolNotEditable=1]="WhenToolNotEditable",n[n.Always=2]="Always";class _{constructor(){this._isToolEditable=!0,this._manipulators=new p.Z,this._resourceContexts={manipulator3D:{}},this._attached=!1}set isToolEditable(e){this._isToolEditable=e}get length(){return this._manipulators.length}add(e,t=r.WhenToolEditable){this.addMany([e],t)}addMany(e,t=r.WhenToolEditable){for(const i of e){const e={manipulator:i,visibilityPredicate:t,attached:!1};this._manipulators.add(e),this._attached&&this._updateManipulatorAttachment(e)}}remove(e){for(let t=0;t<this._manipulators.length;t++)if(this._manipulators.getItemAt(t).manipulator===e){const e=this._manipulators.splice(t,1)[0];this._detachManipulator(e);break}}removeAll(){this._manipulators.forEach((e=>{this._detachManipulator(e)})),this._manipulators.removeAll()}attach(){this._manipulators.forEach((e=>{this._updateManipulatorAttachment(e)})),this._attached=!0}detach(){this._manipulators.forEach((e=>{this._detachManipulator(e)})),this._attached=!1}destroy(){this.detach(),this._manipulators.forEach((({manipulator:e})=>{e.destroy&&e.destroy()})),this._manipulators.destroy(),this._resourceContexts=null}on(e,t){return this._manipulators.on(e,(e=>{t(e)}))}forEach(e){for(const t of this._manipulators.items)e(t)}some(e){return this._manipulators.items.some(e)}toArray(){const e=[];return this.forEach((t=>e.push(t.manipulator))),e}intersect(e,t){let i=null,r=Number.MAX_VALUE;return this._manipulators.forEach((({manipulator:n,attached:s})=>{if(!s||!n.interactive)return;const a=n.intersectionDistance(e,t);(0,c.pC)(a)&&a<r&&(r=a,i=n)})),i}_updateManipulatorAttachment(e){this._isManipulatorItemVisible(e)?this._attachManipulator(e):this._detachManipulator(e)}_attachManipulator(e){e.attached||(e.manipulator.attach&&e.manipulator.attach(this._resourceContexts),e.attached=!0)}_detachManipulator(e){if(!e.attached)return;const t=e.manipulator;t.grabbing=!1,t.dragging=!1,t.hovering=!1,t.selected=!1,t.detach&&t.detach(this._resourceContexts),e.attached=!1}_isManipulatorItemVisible(e){return e.visibilityPredicate===r.Always||(this._isToolEditable?e.visibilityPredicate===r.WhenToolEditable:e.visibilityPredicate===r.WhenToolNotEditable)}}let f=class extends a.Z{constructor(e){super(e),this.manipulators=new _,this.automaticManipulatorSelection=!0,this.hasGrabbedManipulators=!1,this.hasHoveredManipulators=!1,this.firstGrabbedManipulator=null,this.created=!1,this.removeIncompleteOnCancel=!0,this._editableFlags=new Map([[d.bH.MANAGER,!0],[d.bH.USER,!0]]),this._creationFinishedResolver=(0,l.hh)()}get active(){return null!=this.view&&this.view.activeTool===this}set visible(e){this._get("visible")!==e&&(this._set("visible",e),this._syncVisible())}get editable(){return this.getEditableFlag(d.bH.USER)}set editable(e){this.setEditableFlag(d.bH.USER,e)}get updating(){return!1}get cursor(){return null}get hasFocusedManipulators(){return this.hasGrabbedManipulators||this.hasHoveredManipulators}destroy(){this.manipulators.destroy(),this._set("view",null)}onAdd(){this._syncVisible()}activate(){(0,c.Wi)(this.view)?o.Z.getLogger(this.declaredClass).error("Can't activate tool if view is not defined."):(this.view.focus(),this.onActivate())}deactivate(){this.onDeactivate()}handleInputEvent(e){this.onInputEvent(e)}handleInputEventAfter(e){this.onInputEventAfter(e)}setEditableFlag(e,t){this._editableFlags.set(e,t),this.manipulators.isToolEditable=this.internallyEditable,this._updateManipulatorAttachment(),e===d.bH.USER&&this.notifyChange("editable"),this.onEditableChange(),this.onManipulatorSelectionChanged()}getEditableFlag(e){return this._editableFlags.get(e)??!1}whenCreated(){return this._creationFinishedResolver.promise}onManipulatorSelectionChanged(){}onActivate(){}onDeactivate(){}onShow(){}onHide(){}onEditableChange(){}onInputEvent(e){}onInputEventAfter(e){}get internallyEditable(){return this.getEditableFlag(d.bH.USER)&&this.getEditableFlag(d.bH.MANAGER)}finishToolCreation(){this.created||this._creationFinishedResolver.resolve(this),this._set("created",!0)}_syncVisible(){if(this.initialized)if(this.visible)this._show();else if(this._hide(),this.active)return void(this.view.activeTool=null)}_show(){this._updateManipulatorAttachment(),this.onShow()}_hide(){this._updateManipulatorAttachment(),this.onHide()}_updateManipulatorAttachment(){this.visible?this.manipulators.attach():this.manipulators.detach()}};(0,s._)([(0,h.Cb)({constructOnly:!0})],f.prototype,"view",void 0),(0,s._)([(0,h.Cb)({readOnly:!0})],f.prototype,"active",null),(0,s._)([(0,h.Cb)({value:!0})],f.prototype,"visible",null),(0,s._)([(0,h.Cb)({value:!0})],f.prototype,"editable",null),(0,s._)([(0,h.Cb)({readOnly:!0})],f.prototype,"manipulators",void 0),(0,s._)([(0,h.Cb)({readOnly:!0})],f.prototype,"updating",null),(0,s._)([(0,h.Cb)()],f.prototype,"cursor",null),(0,s._)([(0,h.Cb)({readOnly:!0})],f.prototype,"automaticManipulatorSelection",void 0),(0,s._)([(0,h.Cb)()],f.prototype,"hasFocusedManipulators",null),(0,s._)([(0,h.Cb)()],f.prototype,"hasGrabbedManipulators",void 0),(0,s._)([(0,h.Cb)()],f.prototype,"hasHoveredManipulators",void 0),(0,s._)([(0,h.Cb)()],f.prototype,"firstGrabbedManipulator",void 0),(0,s._)([(0,h.Cb)({readOnly:!0})],f.prototype,"created",void 0),(0,s._)([(0,h.Cb)({readOnly:!0})],f.prototype,"removeIncompleteOnCancel",void 0),f=(0,s._)([(0,u.j)("esri.views.interactive.InteractiveToolBase")],f)},76478:(e,t,i)=>{i.d(t,{AN:()=>E,BS:()=>O,Cf:()=>v,M2:()=>f,Mz:()=>P,QY:()=>w,Xd:()=>_,a9:()=>m,bD:()=>S,di:()=>b,hM:()=>x,kY:()=>C,oq:()=>y,zh:()=>T});i(91957),i(39994);var r=i(67134),n=i(19431),s=i(61681),a=i(95550),o=i(8909),c=i(90472),l=i(45043),h=i(83772),u=i(65684),d=i(50749),p=i(67666);function _(e,t){return e.events.on("drag",function(e,t){let i=null,r=null;return n=>{if("cancel"===n.action)return void((0,s.pC)(r)&&(r.execute({action:"cancel"}),i=null,r=null));const a={action:n.action,screenStart:n.start,screenEnd:n.screenPoint};"start"===n.action&&(0,s.Wi)(i)&&(i=new x,r=new x,t(e,i,r,n.pointerType,a)),(0,s.pC)(i)&&i.execute(a),"end"===n.action&&(0,s.pC)(i)&&(i=null,r=null)}}(e,t))}function f(e,t){const i=[e.x,e.y,e.z??0],r=t,n=[Math.cos(r),Math.sin(r)],s=Math.sqrt(n[0]*n[0]+n[1]*n[1]);if(0===s)return null;n[0]/=s,n[1]/=s;const a=e=>{const t=(e.x-i[0])*n[0]+(e.y-i[1])*n[1];e.x=i[0]+t*n[0],e.y=i[1]+t*n[1]};return e=>(a(e.mapStart),a(e.mapEnd),{...e,axis:n})}function m(e,t){let i=null;return r=>{if("start"===r.action&&(i=function(e,t,i){const r=e.geometry,n=(0,l.D)(t);if((0,s.Wi)(r))return null;if("mesh"===r.type)return function(e,t,i,r){if((0,s.pC)(t.transform))return function(e,t,i,r){const n=g(i.getOriginPoint(t.spatialReference),r),a=t.spatialReference;return(0,s.Wi)(n)?null:{move:(t,r,l)=>{const h=(0,d.pB)(n.clone(),t,r,l);if(h.spatialReference.equals(a))i.origin=(0,o.f)(h.x,h.y,h.z);else{const e=(0,c.iV)(h,a);(0,s.pC)(e)&&(i.origin=(0,o.f)(e.x,e.y,e.z))}e.notifyMeshTransformChanged(),e.notifyGeometryChanged()}}}(e,t,t.transform,i);if(!t.spatialReference.equals(i))return null;let n=0,a=0,l=0;return{move:(i,s,o)=>{const c=i-n,h=s-a,d=o-l;if(c||h||d){const _=new p.Z(t.origin.x+c,t.origin.y+h,t.origin.z+d,t.origin.spatialReference);t.centerAt(_,{geographic:r===u.JY.Global}),e.notifyGeometryChanged(),n=i,a=s,l=o}}}}(e,r,n,i);const a=g(r,n),h=r.spatialReference;return(0,s.Wi)(a)?null:{move:(t,i,r)=>{const n=(0,d.pB)(a.clone(),t,i,r);n.spatialReference.equals(h)?e.geometry=n:e.geometry=(0,c.iV)(n,h)}}}(e,r.mapStart.spatialReference,t)),(0,s.Wi)(i))return null;const n=r.mapEnd.x-r.mapStart.x,a=r.mapEnd.y-r.mapStart.y,h=r.mapEnd.z-r.mapStart.z;return i.move(n,a,h),{...r,translationX:n,translationY:a,translationZ:h}}}function g(e,t){return(0,s.Wi)(e)?null:e.spatialReference.equals(t)?e.clone():(0,c.iV)(e,t)}function v(e,t=null,i){let r=null;const n=(0,s.pC)(t)&&!e.spatialReference?.equals(t)?e=>(0,s.pC)(e)?(0,c.iV)(e,t):e:e=>e,a={exclude:[],...i};return t=>{if("start"===t.action&&(r=n(e.toMap(t.screenStart,a))),(0,s.Wi)(r))return null;const i=n(e.toMap(t.screenEnd,a));return(0,s.pC)(i)?{...t,mapStart:r,mapEnd:i}:null}}function y(e,t){const i=e.map((e=>(0,s.Wg)(m(e,t)))).filter((e=>(0,s.pC)(e)));return e=>{const t=e.mapEnd.x-e.mapStart.x,r=e.mapEnd.y-e.mapStart.y,n=e.mapEnd.z-e.mapStart.z;return i.forEach((t=>t(e))),{...e,translationX:t,translationY:r,translationZ:n}}}function b(e,t){const i=new Map;for(const n of t)i.set(n,(0,r.d9)(e[n]));return t=>(i.forEach(((t,i)=>{e[i]=t})),t)}function S(e){return(0,s.pC)(e.geometry)&&"mesh"===e.geometry.type?function(e,t){const i=(0,s.pC)(t.transform)?t.transform.clone():null,r=t.vertexAttributes.clonePositional();return n=>(t.transform=i,t.vertexAttributes=r,e.notifyGeometryChanged(),n)}(e,e.geometry):b(e,["geometry"])}function w(e){const t=e.map((e=>(0,s.Wg)(S(e)))).filter((e=>(0,s.pC)(e)));return e=>(t.forEach((t=>t(e))),e)}function E(){let e=0,t=0,i=0;return r=>{"start"===r.action&&(e=r.mapStart.x,t=r.mapStart.y,i=r.mapStart.z);const n=r.mapEnd.x-e,s=r.mapEnd.y-t,a=r.mapEnd.z-i;return e=r.mapEnd.x,t=r.mapEnd.y,i=r.mapEnd.z,{...r,mapDeltaX:n,mapDeltaY:s,mapDeltaZ:a,mapDeltaSpatialReference:r.mapStart.spatialReference}}}function T(){let e=0,t=0;return i=>{"start"===i.action&&(e=i.screenStart.x,t=i.screenStart.y);const r=i.screenEnd.x-e,n=i.screenEnd.y-t;return e=i.screenEnd.x,t=i.screenEnd.y,{...i,screenDeltaX:r,screenDeltaY:n}}}function C(e,t){let i=null,r=0,s=0;return o=>{if("start"===o.action&&(i=e.toScreen?.(t),null!=i&&(i.x<0||i.x>e.width||i.y<0||i.y>e.height?i=null:(r=o.screenStart.x-i.x,s=o.screenStart.y-i.y))),null==i)return null;const c=(0,n.uZ)(o.screenEnd.x-r,0,e.width),l=(0,n.uZ)(o.screenEnd.y-s,0,e.height),h=(0,a.vW)(c,l);return o.screenStart=i,o.screenEnd=h,o}}const A=()=>{};class x{constructor(){this.execute=A}next(e,t=new x){return(0,s.pC)(e)&&(this.execute=i=>{const r=e(i);(0,s.pC)(r)&&t.execute(r)}),t}}function O(e,t,i=[]){if("2d"===e.type)return e=>e;let r=null;return n=>{"start"===n.action&&(r=e.toMap(n.screenStart,{exclude:i}),(0,s.pC)(r)&&(r.z=(0,h.Ou)(r,e,t)));const a=e.toMap(n.screenEnd,{exclude:i});(0,s.pC)(a)&&(a.z=(0,h.Ou)(a,e,t));const o=(0,s.pC)(r)&&(0,s.pC)(a)?{sceneStart:r,sceneEnd:a}:null;return{...n,scenePoints:o}}}function R(e,t,i){const r=(0,s.WG)(t.elevationProvider.getElevation(e.x,e.y,e.z??0,e.spatialReference,"scene"))??0,n=(0,l.WG)(e);return n.z=r,n.hasZ=!0,n.z=(0,h.Ou)(n,t,i),n}function P(e,t){if("2d"===e.type)return e=>e;let i=null;return r=>{"start"===r.action&&(i=R(r.mapStart,e,t));const n=R(r.mapEnd,e,t),a=(0,s.pC)(i)&&(0,s.pC)(n)?{sceneStart:i,sceneEnd:n}:null;return{...r,scenePoints:a}}}}}]);