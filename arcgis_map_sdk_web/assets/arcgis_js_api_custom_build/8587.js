"use strict";(self.webpackChunkarcgis_webpack01=self.webpackChunkarcgis_webpack01||[]).push([[8587],{23569:(e,t,r)=>{r.d(t,{h:()=>n});let i=e=>({vnodeSelector:"",properties:void 0,children:void 0,text:e.toString(),domNode:null}),s=(e,t,r)=>{for(let n=0,o=t.length;n<o;n++){let o=t[n];Array.isArray(o)?s(e,o,r):null!=o&&!1!==o&&("string"==typeof o&&(o=i(o)),r.push(o))}};function n(e,t,r){if(Array.isArray(t))r=t,t=void 0;else if(t&&("string"==typeof t||t.hasOwnProperty("vnodeSelector"))||r&&("string"==typeof r||r.hasOwnProperty("vnodeSelector")))throw new Error("h called with invalid arguments");let i,n;return r&&1===r.length&&"string"==typeof r[0]?i=r[0]:r&&(n=[],s(e,r,n),0===n.length&&(n=void 0)),{vnodeSelector:e,properties:t,children:n,text:""===i?void 0:i,domNode:null}}},28401:(e,t,r)=>{r.d(t,{O:()=>a,s:()=>l});const i="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAEAAAABACAMAAACdt4HsAAAAnFBMVEUAAAD/gAD/gAD/cAD/gAD/eAD/gAD/eQD/gAD/egD/gAD/ewD/gAD/fAD/gAD/fAD/gAD/fAD/fQD/fQD/fQD/fQD/fQD/fgD/jR7/mjn/mjf/p1H/plH/smf/sWb/vHr/u3n/xYz/xIv/zZz/zJv/zJr/1Kv/1Kr/06r/06n/27n/27f/4cX/4cT/59D/7dr/8uX/9u7/+/f////u2EN0AAAAM3RSTlMACBAQICAoKDAwODhAQEhIUFBYYGhweICIkJCXmJ+gp6ivsLe4uL+/wMDHx8/P19/n7/cWvjXwAAACeUlEQVR42tWX3XqiMBCGY2pbtbrUnzhhdak/lHWliJD7v7fdJ+KG5AMhh30P8zCTmS+TycDaeBoHi5Wgf4jVYvbKmRfPgSAHMX9mPRnM1tSIGHM/c2QddLp4c8wxCvYIvqROBPfbHlm/sRYC6smMNTKn3sxZAyvyYNW1v38MM/IkcPQnZHPMLtciz9P9hhqwzoLD+cnfpTIUaYinyZlBkE2YKZcMXCyN/YhsPkuFlMfWJLiwo89VMxfpJDForMCwuG+Zx7ttGO2S/w4LJ42ZURDty5M0a4dqsZAQAihQfXqWdlhnpcmdEPAI0tv2EbnsbsKmdgi6/1GN7T1XJLx5sF0P9SWABMC+co5JBE4Ge/1NTM3EGIJgjFONXCdAbeQYwhN7pRrRV20LJNIhWOczdu+xPFzIBiQ62iIsyIOTvlZUY+HXySLQaMUEeSC1CPYxENIlwk+q8e0clFAIfiKG+qpaIvod4wfU8sqvkDLda+xCCqgDaAk7uyeNqD+feFlfGCcg3Hzsk+xS7Nz1Aq4CcauhhMc0uxaqIgcFsF0J+1WQyoCN7Y9ezeCVH5LhSxmyRvsihKbK1m7LafpSpkpj6yJgtsiVBh6AX5UyCVmMbrNpcwj5/h6DPN79JjAiQAhXVeN6SZI0q5bQnn4wBiHEqpUybp1ZJzWxStVCHhKhAhVLp/Emh6trHpGLaB6yZHk7wu3Z+ChOxhwUNEmYYjpUvqJDksSHraQmJm2DdqQK6sGUObybYtpSN+8Phm3pN2xjDH33R6b0CKxAZNLvl8foD3BBnSw5e8RI+G2P8GD9wHw6YN3wkfA0R4Zz8CGCIfOCv8zM738walXuLw6nXBvPr8wvAAAAAElFTkSuQmCC",s="data:image/png;base64,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";var n=r(44101);const o={mipmap:!0,preMultiplyAlpha:!0,width:64,height:64};function a(e){return e.fromData(i,(()=>new n.x(i,o)))}function l(e){return e.fromData(s,(()=>new n.x(s,o)))}},56264:(e,t,r)=>{r.d(t,{_:()=>L});var i=r(30936),s=(r(39994),r(23148)),n=r(61681),o=r(6766),a=r(8909),l=r(90472),c=r(83772),h=r(56885),d=r(76868),u=r(95550),p=r(55709),_=r(69666),f=r(88589),g=r(18916),m=r(48358),y=r(17444),D=r(99608),v=r(6087),x=r(7358),w=r(13304),b=r(21414),A=r(65392);class R extends y.i{constructor(e){super(e),this._location=(0,a.c)(),this._direction=(0,a.f)(1,0,0),this._width=1,this._offset=1,this._length=18,this._color=(0,g.f)(1,0,1,1),this._renderOccluded=x.yD.OccludeAndTransparent,this.applyProps(e)}createObject3DResourceFactory(e){return{view:e,createResources:e=>this._createObject3DResources(e),destroyResources:e=>this._destroyObject3DResources(e),recreateGeometry:(e,t)=>this._recreateObject3DGeometry(e,t),cameraChanged:()=>this._updateGeometry()}}createDrapedResourceFactory(e){return{view:e,createResources:()=>this._createDrapedResources(),destroyResources:e=>this._destroyDrapedResources(e),recreateGeometry:e=>this._recreateDrapedGeometry(e)}}get location(){return this._location}set location(e){(0,o.k)(this._location,e)||((0,o.c)(this._location,e),this._updateGeometry())}get direction(){return this._direction}set direction(e){(0,o.k)(this._direction,e)||((0,o.c)(this._direction,e),this._updateGeometry())}setDirectionFromPoints(e,t){(0,o.n)(this._direction,(0,o.b)(this._direction,t,e)),this._updateGeometry()}get width(){return this._width}set width(e){e!==this._width&&(this._width=e,this._updateMaterial())}get offset(){return this._offset}set offset(e){e!==this._offset&&(this._offset=e,this._updateGeometry())}get length(){return this._length}set length(e){e!==this._length&&(this._length=e,this._updateGeometry())}get color(){return this._color}set color(e){(0,f.g)(e,this._color)||((0,f.c)(this._color,e),this._updateMaterial())}get renderOccluded(){return this._renderOccluded}set renderOccluded(e){e!==this._renderOccluded&&(this._renderOccluded=e,this._updateMaterial())}_createObject3DResources(e){const t=new A.U(this.materialParameters),r=new Array;return this._createObject3DGeometry(t,e,r),{material:t,geometries:r,forEach:e=>{e(t),r.forEach(e)}}}_destroyObject3DResources(e){e.geometries.length=0,e.material.dispose()}_recreateObject3DGeometry(e,t){e.geometries.length=0,this._createObject3DGeometry(e.material,t,e.geometries)}_createObject3DGeometry(e,t,r){const[i,s]=this._createGeometries(e);t.addGeometry(i),t.addGeometry(s),r.push(i),r.push(s),this._updateVerticesObject3D(t)}_createDrapedResources(){const e=new A.U(this.materialParameters),t=(0,d.YP)((()=>this.view.state.contentPixelRatio),(()=>{this.drapedResources.recreateGeometry()}));return{material:e,geometries:this._createDrapedGeometry(e),pixelRatioHandle:t}}_destroyDrapedResources(e){e.pixelRatioHandle.remove(),e.geometries=[],e.material.dispose()}_recreateDrapedGeometry(e){e.geometries=this._createDrapedGeometry(e.material)}_createDrapedGeometry(e){const t=this._createGeometries(e);this._updateVerticesDraped(t);const r=t.map((e=>new w.z(e,{boundingInfo:e.boundingInfo})));for(const e of r)e.computeBoundingSphere(e.transformation,e.boundingSphere);return r}_createGeometries(e){return[(0,v.rh)(e,[(0,a.c)(),(0,a.c)()]),(0,v.rh)(e,[(0,a.c)(),(0,a.c)()])]}_updateMaterial(){const{materialParameters:e}=this;(0,n.WG)(this.object3dResources.resources)?.material.setParameters(e),(0,n.WG)(this.drapedResources.resources)?.material.setParameters(e)}get materialParameters(){return{width:this._width,color:this._color,renderOccluded:this._renderOccluded}}_updateGeometry(){if(this.isDraped)this.drapedResources.recreateGeometry();else{const e=(0,n.WG)(this.object3dResources.object);e&&this._updateVerticesObject3D(e)}}_updateVerticesObject3D(e){const t=this.view.state.camera;t.projectToScreen(this.location,P),(0,o.a)(C,this.location,this.direction),t.projectToScreen(C,z),(0,p.f)(z,(0,p.a)(z,z,P)),this._updateVertexAttributesObject3D(t,e,0,P,z,1),this._updateVertexAttributesObject3D(t,e,1,P,z,-1)}_updateVertexAttributesObject3D(e,t,r,i,s,n){const o=t.geometries[r],a=o.getMutableAttribute(b.T.POSITION)?.data;if(!a)return;const{start:l,end:c}=this._computeStartEnd(s,i,n,this.offset,this.width,this.length);e.unprojectFromScreen((0,u.c$)(l),C),a[0]=C[0],a[1]=C[1],a[2]=C[2],e.unprojectFromScreen((0,u.c$)(c),C),a[3]=C[0],a[4]=C[1],a[5]=C[2],t.geometryVertexAttrsUpdated(o)}_updateVerticesDraped(e){const{view:{basemapTerrain:{overlayManager:t},state:{contentPixelRatio:r}}}=this,{location:i,width:s,length:o,offset:a}=this,l=M;l.spatialReference=(0,n.Wg)(t.renderer.spatialReference),l.x=i[0],l.y=i[1];const c=t.overlayPixelSizeInMapUnits(l)*r,h=s*c,d=o*c,u=a*c;this._updateVertexAttributesDraped(e[0],h,d,u,-1),this._updateVertexAttributesDraped(e[1],h,d,u,1)}_updateVertexAttributesDraped(e,t,r,i,s){const n=e.getMutableAttribute(b.T.POSITION)?.data;if(!n)return;const{location:o,direction:a}=this,{start:l,end:c}=this._computeStartEnd(a,o,s,i,t,r);n[0]=l[0],n[1]=l[1],n[2]=D.Rn,n[3]=c[0],n[4]=c[1],n[5]=D.Rn,e.invalidateBoundingInfo()}_computeStartEnd(e,t,r,i,s,n){const o=(0,p.b)(S,(0,p.s)(S,e[1]*r,e[0]*-r),i+s/2),a=(0,p.j)(O,(0,p.j)(O,(0,p.j)(O,t,(0,p.b)(O,e,n/2)),o),o);return{start:a,end:(0,p.j)(G,a,(0,p.b)(G,e,-n))}}}const C=(0,a.c)(),S=(0,_.a)(),O=(0,_.a)(),G=(0,_.a)(),P=(0,u.s1)(),z=(0,u.s1)(),M=(0,m.Tx)(0,0,void 0,null);var E=r(26653),T=r(83061),W=r(43977),I=r(50639),j=r(20999),H=r(92026),k=r(22519),U=r(4371),F=r(65453),V=r(86);class L extends U.a{sortUniqueHints(e){return e.sort(((e,t)=>(t instanceof F.w?t.length:0)-(e instanceof F.w?e.length:0)))}visualizeIntersectionPoint(e,t){const{spatialReference:r,view:n}=t;return(0,s.ed)(new E.L({view:n,primitive:"circle",geometry:(0,H.SH)(e.intersectionPoint,r),elevationInfo:e.isDraped?c.tR:c.jG,size:20,outlineSize:2,color:[0,0,0,0],outlineColor:i.Z.toUnitRGBA(I.c.orange),pixelSnappingEnabled:!1}))}visualizePoint(e,t){const{view:r,spatialReference:n}=t,o=this._alignPoint(e.point,e.domain,t);return(0,s.ed)(new E.L({view:r,primitive:"circle",geometry:(0,H.SH)(o,n),elevationInfo:this._hintElevationInfo(e,t),size:20,outlineSize:2,color:[0,0,0,0],outlineColor:i.Z.toUnitRGBA(I.c.orange),pixelSnappingEnabled:!1}))}visualizeLine(e,t){const{view:r,spatialReference:i}=t,n=this._alignPoint(e.lineStart,e.domain,t),o=this._alignPoint(e.lineEnd,e.domain,t);return(0,s.ed)(this._createLineSegmentHint(e.type,n,o,i,this._hintElevationInfo(e,t),r,e.isDraped,e.fadeLeft,e.fadeRight))}visualizeParallelSign(e,t){const{view:r,spatialReference:n}=t,{isDraped:a}=e,l=this._hintElevationInfo(e,t),c=this._alignPoint(e.lineStart,e.domain,t),h=this._alignPoint(e.lineEnd,e.domain,t),d=Q(c,n,l,r,a),u=Q(h,n,l,r,a),p=(0,o.h)(u,d,u,.5),_=new R({view:r,attached:!1,offset:I.c.parallelLineHintOffset,length:I.c.parallelLineHintLength,width:I.c.parallelLineHintWidth,color:i.Z.toUnitRGBA(I.c.orange),location:p,renderOccluded:a?x.yD.OccludeAndTransparent:x.yD.Opaque,isDraped:a,renderGroup:W.eZ.SnappingHint});return _.setDirectionFromPoints(d,p),_.attached=!0,(0,s.ed)(_)}visualizeRightAngleQuad(e,t){const{view:r,spatialReference:n}=t,o=this._hintElevationInfo(e,t),{isDraped:a}=e,l=this._alignPoint(e.previousVertex,e.domain,t),c=this._alignPoint(e.centerVertex,e.domain,t),h=this._alignPoint(e.nextVertex,e.domain,t),d=Q(l,n,o,r,a),u=Q(c,n,o,r,a),p=Q(h,n,o,r,a);return(0,s.ed)(new T.R({view:r,attached:!0,color:a?i.Z.toUnitRGBA(I.c.orangeTransparent):i.Z.toUnitRGBA(I.c.orange),renderOccluded:a?x.yD.OccludeAndTransparent:x.yD.Transparent,outlineRenderOccluded:a?x.yD.OccludeAndTransparent:x.yD.Opaque,outlineColor:i.Z.toUnitRGBA(I.c.orange),outlineSize:I.c.rightAngleHintOutlineSize,size:I.c.rightAngleHintSize,isDraped:a,geometry:{previous:d,center:u,next:p},renderGroup:W.eZ.SnappingHint}))}_createLineSegmentHint(e,t,r,s,n,o,a=!1,l=!0,c=!0){const d=Q(t,s,n,o,a),u=Q(r,s,n,o,a),p=new h.V({view:o,extensionType:h.n.FADED,start:d,end:u,isDraped:a,color:i.Z.toUnitRGBA(I.c.orange),renderOccluded:a?x.yD.OccludeAndTransparent:x.yD.Opaque,renderGroup:W.eZ.SnappingHint});switch(e){case k.ze.TARGET:p.width=I.c.lineHintWidthTarget,p.fadedExtensions={start:0,end:I.c.lineHintFadedExtensions};break;case k.ze.REFERENCE_EXTENSION:p.width=I.c.lineHintWidthReference,p.fadedExtensions={start:0,end:0};break;case k.ze.REFERENCE:p.width=I.c.lineHintWidthReference,p.fadedExtensions={start:l?I.c.lineHintFadedExtensions:0,end:c?I.c.lineHintFadedExtensions:0}}return p.attached=!0,p}_alignPoint(e,t,r){const i=this._getSelfSnappingZ(t,r);return(0,n.Wi)(i)?e:(0,H.$G)(e[0],e[1],i)}_hintElevationInfo(e,t){return(0,n.pC)(this._getSelfSnappingZ(e.domain,t))?(0,n.Wg)(t.selfSnappingZ).elevationInfo:e.isDraped?c.tR:c.jG}_getSelfSnappingZ(e,{selfSnappingZ:t}){return e===j.B.SELF&&(0,n.pC)(t)?t.value:null}}function Q(e,t,r,i,s,n=(0,a.c)()){if(s){const r=i.basemapTerrain.overlayManager.renderer.spatialReference;(0,l.SH)(e,t,n,r)}else(0,V.RS)(e,t,r,i,n);return n}},81536:(e,t,r)=>{r.d(t,{G:()=>b,J4:()=>O,Sp:()=>C,VG:()=>A,_N:()=>v,_y:()=>R,bB:()=>x,gv:()=>G,zP:()=>S});var i,s,n=r(61681),o=r(95550),a=r(6766),l=r(8909),c=r(90472),h=r(69430),d=r(97537),u=r(5700),p=r(68817),_=r(83772),f=r(40460),g=r(8927),m=r(20757),y=r(5073),D=r(76478);function v(e,t){return w(e,(()=>t))}function x(e){return w(e,(e=>e.plane))}function w(e,t){const r=(0,l.c)(),i=(0,l.c)();let s=!1;return a=>{const l=t(a);if("start"===a.action){const t=(0,o.md)(a.screenStart,(0,o.c$)(p.qW.get())),i=(0,f.u4)(e.state.camera,t,M);(0,n.pC)(i)&&(s=(0,h.BR)(l,i,r))}if(!s)return null;const c=(0,o.md)(a.screenEnd,(0,o.c$)(p.qW.get())),d=(0,f.u4)(e.state.camera,c,M);return(0,n.Wi)(d)?null:(0,h.BR)(l,d,i)?{...a,renderStart:r,renderEnd:i,plane:l,ray:d}:null}}function b(e,t,r,i=null,s=null){return function(e,t,r=0,i=null,s=null){let a=null;return l=>{if("start"===l.action&&(a=e.sceneIntersectionHelper.intersectElevationFromScreen((0,o.s1)(l.screenStart.x,l.screenStart.y),t,r,s),(0,n.pC)(a)&&(0,n.pC)(i)&&!(0,c.nF)(a,a,i)))return null;if((0,n.Wi)(a))return null;const h=e.sceneIntersectionHelper.intersectElevationFromScreen((0,o.s1)(l.screenEnd.x,l.screenEnd.y),t,r,s);return(0,n.pC)(h)?(0,n.pC)(i)&&!(0,c.nF)(h,h,i)?null:{...l,mapStart:a,mapEnd:h}:null}}(e,r,(0,_.Ou)(t,e,r),i,s)}function A(e,t,r,i=null,s=null){return b(e,r,(0,_.RL)(t),i,s)}function R(e,t,r,i){const s=t.toMap(e.screenStart,{include:[r]});return(0,n.pC)(s)?A(t,r,s,i):null}function C(e,t,r){let i=null;const s=new D.hM;return s.next(v(e,function(e,t){const r=P,i=z,s=(0,h.Ue)();e.renderCoordsHelper.worldUpAtPosition(t,r);const n=(0,a.f)(s,r,(0,a.b)(i,t,e.state.camera.eye));return(0,a.f)(n,n,r),(0,h.Yq)(t,n,s)}(e,t))).next(function(e,t){const r=(0,l.c)(),i=(0,a.l)(t);e.renderCoordsHelper.worldUpAtPosition(t,r);const s=(0,l.c)(),n=(0,l.c)(),o=s=>((0,a.b)(s,s,t),(0,u.nF)(r,s,s),"global"===e.viewingMode&&(0,a.l)(s)*Math.sign((0,a.e)(r,s))<.001-i&&(0,a.b)(s,(0,a.g)(s,r,.001),t),(0,a.a)(s,s,t),s);return e=>(e.renderStart=o((0,a.c)(s,e.renderStart)),e.renderEnd=o((0,a.c)(n,e.renderEnd)),e)}(e,t)).next(S(e,r)).next((e=>{e.mapEnd.x=e.mapStart.x,e.mapEnd.y=e.mapStart.y,i=e})),e=>(i=null,s.execute(e),i)}function S(e,t){const r=e.renderCoordsHelper;return e=>{const i=r.fromRenderCoords(e.renderStart,t),s=r.fromRenderCoords(e.renderEnd,t);return(0,n.pC)(i)&&(0,n.pC)(s)?{...e,mapStart:i,mapEnd:s}:null}}function O(e){let t=null;return r=>{switch(r.action){case"start":t=e.disableDisplay();break;case"end":case"cancel":(0,n.pC)(t)&&(t.remove(),t=null)}return r}}function G(e,t=null){const r=(0,g.Z8)(e.state.viewingMode);r.options.selectionMode=!0,r.options.store=m.eC.MIN,r.options.hud=!1;const s=(0,o.s1)(),a={requiresGroundFeedback:!0,enableDraped:!0,exclude:new Set},c=(0,l.c)(),h=(0,n.Pt)(t,e.spatialReference),d=t=>{e.map.ground&&e.map.ground.opacity<1?a.exclude.add(y.cy):a.exclude.delete(y.cy),e.sceneIntersectionHelper.intersectIntersectorScreen((0,o.md)(t,s),r,a);const n=r.results.min;let l;if(n.getIntersectionPoint(c))l=n.intersector===m.q7.TERRAIN?i.GROUND:i.OTHER;else{if(!r.results.ground.getIntersectionPoint(c))return null;l=i.GROUND}return{location:e.renderCoordsHelper.fromRenderCoords(c,h),surfaceType:l}};let u;return e=>{if("start"===e.action){const t=d(e.screenStart);u=(0,n.pC)(t)?t.location:null}if((0,n.Wi)(u))return null;const t=d(e.screenEnd);return(0,n.pC)(t)&&(0,n.pC)(t.location)?{...e,mapStart:u,mapEnd:t.location,surfaceType:t.surfaceType}:null}}(s=i||(i={}))[s.GROUND=0]="GROUND",s[s.OTHER=1]="OTHER";const P=(0,l.c)(),z=(0,l.c)(),M=(0,d.Ue)()},13540:(e,t,r)=>{r.d(t,{O9:()=>c,Xd:()=>C});var i=r(30936),s=r(39043),n=r(1983),o=r(56885),a=r(7358),l=r(66962);const c={main:new i.Z([255,127,0]),selected:new i.Z([255,255,255]),staged:new i.Z([12,207,255]),outline:new i.Z([0,0,0,.5]),selectedOutline:new i.Z([255,255,255])},h=.3;function d(e,t){const r=e.clone();return r.a*=t,r}function u(e,t){const r=e.clone(),i=(0,s._Y)(r);i.s*=t;const n=(0,s.xr)(i);return r.r=n.r,r.g=n.g,r.b=n.b,r}function p(e,t){if(t)for(const r in t)e[r]=t[r]}class _{constructor(e){this.color=c.main,this.height=90,this.coneHeight=40,this.coneWidth=23,this.width=3,this.renderOccluded=a.yD.Opaque,p(this,e)}}class f{constructor(e){this.size=11,this.outlineSize=1,this.collisionPadding=9,this.color=c.main,this.outlineColor=c.outline,this.renderOccluded=a.yD.Opaque,this.hoverOutlineColor=c.selectedOutline,p(this,e)}apply(e,t){const r=this[e];t.setParameters({color:R(r),transparent:"color"!==e||r.a<1,renderOccluded:this.renderOccluded})}}class g{constructor(e){this.size=40,this.height=.2,this.offset=.25,this.collisionPadding=2,this.color=d(c.main,.5),this.hoverColor=c.main,this.renderOccluded=a.yD.Transparent,this.minSquaredEdgeLength=900,p(this,e)}apply(e,t){const r=this[e];t.setParameters({color:R(r),transparent:r.a<1,renderOccluded:this.renderOccluded})}}class m{constructor(e){this.vertex=new f({color:c.main,outlineColor:c.outline}),this.edge=new f({color:u(d(c.main,2/3),.5),outlineColor:d(c.outline,.5),size:8,collisionPadding:8}),this.selected=new f({color:c.selected,outlineColor:c.outline}),this.edgeOffset=new g,p(this,e)}}class y{constructor(e){this.color=c.selected,this.width=1.5,this.stipplePattern=(0,l.z5)(5),this.stippleOffColor=c.outline,this.falloff=0,this.innerWidth=1.5,this.innerColor=c.selected,this.renderOccluded=a.yD.OccludeAndTransparent,p(this,e)}apply(e){e.color=R(this.color),e.width=this.width,e.stipplePattern=this.stipplePattern,e.stippleOffColor=R(this.stippleOffColor),e.falloff=this.falloff,e.innerWidth=this.innerWidth,e.innerColor=R(this.innerColor),e.renderOccluded=this.renderOccluded}}class D{constructor(e){this.color=c.selected,this.size=4,this.outlineSize=1,this.outlineColor=c.outline,this.shape="square",p(this,e)}apply(e){e.color=R(this.color),e.size=this.size,e.outlineSize=this.outlineSize,e.outlineColor=R(this.outlineColor),e.primitive=this.shape}}class v{constructor(e){this.innerColor=c.selected,this.innerWidth=1,this.glowColor=c.main,this.glowWidth=8,this.glowFalloff=8,this.globalAlpha=h,this.globalAlphaContrastBoost=1.5,this.radius=3,this.heightFillColor=c.main,p(this,e)}apply(e,t=1){const r={glowColor:i.Z.toUnitRGB(this.glowColor),glowFalloff:this.glowFalloff,glowWidth:this.glowWidth,innerColor:i.Z.toUnitRGB(this.innerColor),innerWidth:this.innerWidth,globalAlpha:this.globalAlpha*t,globalAlphaContrastBoost:this.globalAlphaContrastBoost,intersectsLineRadius:this.radius};"style"in e?e.style=r:e.laserlineStyle=r}}class x{constructor(e){this.outline=new y({color:c.outline,renderOccluded:a.yD.OccludeAndTransparentStencil,stippleOffColor:c.selected,stipplePattern:(0,l.z5)(5),width:1.5,innerWidth:0}),this.staged=new y({color:c.selected,renderOccluded:a.yD.OccludeAndTransparentStencil,innerColor:c.staged,stippleOffColor:c.outline,stipplePattern:(0,l.z5)(5),width:1.5}),this.shadowStyle=new v({globalAlpha:h,glowColor:c.main,glowFalloff:8,glowWidth:8,innerColor:c.selected,innerWidth:1}),p(this,e)}}class w{constructor(e){this.outline=new D({color:c.selected,outlineColor:c.outline,outlineSize:1,shape:"circle",size:4}),this.shadowStyle=new v({globalAlpha:h,glowColor:c.main,glowFalloff:1.5,glowWidth:6,innerColor:c.selected,innerWidth:1,radius:2}),p(this,e)}}class b extends y{constructor(e){super(),this.extensionType=o.n.GROUND_RAY,p(this,e)}}class A{constructor(e){this.lineGraphics=new x,this.pointGraphics=new w,this.heightPlane=new v({globalAlpha:h,glowColor:c.main,glowFalloff:8,glowWidth:8,innerColor:c.selected,innerWidth:1}),this.heightBox=new v({globalAlpha:h,glowColor:c.main,glowFalloff:8,glowWidth:8,innerColor:c.selected,innerWidth:0,heightFillColor:c.main}),this.zVerticalLine=new b({color:d(c.main,.5),falloff:2,innerColor:d(c.selected,0),renderOccluded:a.yD.OccludeAndTransparent,stipplePattern:null,width:5,extensionType:o.n.GROUND_RAY}),this.laserlineAlphaMultiplier=1.5,this.heightPlaneAngleCutoff=20,p(this,e)}}function R(e){return(0,n.b)(i.Z.toUnitRGBA(e))}const C=new class{constructor(e){this.visualElements=new A,this.reshapeManipulators=new m,this.zManipulator=new _,p(this,e)}colorToVec4(e){return R(e)}}},17444:(e,t,r)=>{r.d(t,{i:()=>g});var i=r(36663),s=r(53443),n=r(86618),o=r(61681),a=r(81977),l=(r(7283),r(7753),r(40266)),c=r(43977),h=r(79341),d=r(53448);class u{constructor(e){this._resourceFactory=e,this._resources=null,this._visible=!0,this._attached=!1,this._renderGroup=c.eZ.Outline}destroy(){this._destroyResources()}get resources(){return(0,o.pC)(this._resources)?this._resources.external:null}get visible(){return this._visible}set visible(e){e!==this._visible&&(this._visible=e,this._syncGeometriesToRenderer())}get attached(){return this._attached}set attached(e){e!==this._attached&&(this._attached=e,this._createOrDestroyResources())}get renderGroup(){return this._renderGroup}set renderGroup(e){this._renderGroup=e;const t=(0,o.WG)(this._resources)?.layerView;t&&(t.renderGroup=e)}recreate(){this.attached&&this._createResources()}recreateGeometry(){this._resourceFactory.recreateGeometry?(0,o.Wi)(this._resources)||(this._ensureRenderGeometriesRemoved(),this._resourceFactory.recreateGeometry(this._resources.external),this._syncGeometriesToRenderer()):this.recreate()}_createOrDestroyResources(){this._attached?(0,o.Wi)(this._resources)&&this._createResources():this._destroyResources()}_createResources(){this._destroyResources();const e=this._resourceFactory.createResources(),t=new p({view:this._resourceFactory.view,renderGroup:this._renderGroup}),r=this._resourceFactory.view.basemapTerrain?.overlayManager;this._resources={layerView:new p({view:this._resourceFactory.view,renderGroup:this._renderGroup}),external:e,geometriesAdded:!1},r&&(this._resources.drapeSourceRenderer=r.registerGeometryDrapeSource(t)),this._syncGeometriesToRenderer()}_destroyResources(){if((0,o.Wi)(this._resources))return;this._ensureRenderGeometriesRemoved();const e=this._resourceFactory.view.basemapTerrain?.overlayManager;e&&e.unregisterDrapeSource(this._resources.layerView),this._resourceFactory.destroyResources(this._resources.external),this._resources=null}_syncGeometriesToRenderer(){this._visible?this._ensureRenderGeometriesAdded():this._ensureRenderGeometriesRemoved()}_ensureRenderGeometriesRemoved(){(0,o.Wi)(this._resources)||(0,o.Wi)(this._resources.drapeSourceRenderer)||this._resources.geometriesAdded&&(this._resources.drapeSourceRenderer.removeGeometries(this._resources.external.geometries,h.T.UPDATE),this._resources.geometriesAdded=!1)}_ensureRenderGeometriesAdded(){(0,o.Wi)(this._resources)||(0,o.Wi)(this._resources.drapeSourceRenderer)||this._resources.geometriesAdded||(this._resources.drapeSourceRenderer.addGeometries(this._resources.external.geometries,h.T.UPDATE),this._resources.geometriesAdded=!0)}}let p=class extends((0,n.IG)(s.Z)){constructor(e){super(e),this.drapeSourceType=c.Lw.Features,this.updatePolicy=d.j.SYNC,this.renderGroup=c.eZ.Outline}};(0,i._)([(0,a.Cb)({constructOnly:!0})],p.prototype,"view",void 0),(0,i._)([(0,a.Cb)({readOnly:!0})],p.prototype,"drapeSourceType",void 0),(0,i._)([(0,a.Cb)()],p.prototype,"renderGroup",void 0),p=(0,i._)([(0,l.j)("DrapedVisualElementLayerView")],p);var _=r(76169),f=r(7426);class g extends _.l{constructor({view:e,isDraped:t}){super(e),this._isDraped=!1,this.object3dResources=new f.O(this.createObject3DResourceFactory(e)),this.drapedResources=new u(this.createDrapedResourceFactory(e)),this.isDraped=t??!1}get isDraped(){return this._isDraped}set isDraped(e){e!==this._isDraped&&(this._isDraped=e,this.object3dResources.attached=this.attached&&!e,this.drapedResources.attached=this.attached&&e)}get renderGroup(){return this.drapedResources.renderGroup}set renderGroup(e){this.drapedResources.renderGroup=e}createResources(){this.object3dResources.attached=!this._isDraped,this.drapedResources.attached=this._isDraped}destroyResources(){this.object3dResources.attached=!1,this.drapedResources.attached=!1}recreate(){this.object3dResources.recreate(),this.drapedResources.recreate()}recreateGeometry(){this.object3dResources.recreateGeometry(),this.drapedResources.recreateGeometry()}destroy(){this.object3dResources.destroy(),this.drapedResources.destroy(),super.destroy()}updateVisibility(e){this.object3dResources.visible=e,this.drapedResources.visible=e}}},56885:(e,t,r)=>{r.d(t,{V:()=>v,n:()=>R});r(39994);var i=r(61681),s=r(6766),n=r(8909),o=r(88589),a=r(18916),l=r(70740),c=r(59934),h=r(56215),d=r(97537),u=r(17444),p=r(40199),_=r(99608),f=r(6087),g=r(7358),m=r(13304),y=r(21414),D=r(65392);class v extends u.i{constructor(e){super(e),this._ray=(0,d.Ue)(),this._isWorldDown=!1,this._start=(0,n.c)(),this._end=(0,n.f)(1,0,0),this._width=1,this._color=(0,a.f)(1,0,1,1),this._polygonOffset=!1,this._writeDepthEnabled=!0,this._innerWidth=0,this._innerColor=(0,a.f)(1,1,1,1),this._stipplePattern=null,this._stippleOffColor=null,this._stipplePreferContinuous=!0,this._falloff=0,this._extensionType=R.LINE,this._laserlineStyle=null,this._laserlineEnabled=!1,this._renderOccluded=g.yD.OccludeAndTransparent,this._fadedExtensions=O,this._laserline=new p.W({view:this.view}),this.applyProps(e)}destroy(){this._laserline.destroy(),super.destroy()}createObject3DResourceFactory(e){return{view:e,createResources:e=>this._createObject3DResources(e),destroyResources:e=>this._destroyExternalResources(e),recreateGeometry:(e,t)=>this._recreateObject3DGeometry(e,t),cameraChanged:()=>this._updateGeometry()}}createDrapedResourceFactory(e){return{view:e,createResources:()=>this._createDrapedResources(),destroyResources:e=>this._destroyExternalResources(e),recreateGeometry:e=>this._recreateDrapedGeometry(e)}}updateVisibility(e){super.updateVisibility(e),this._laserline.visible=e}onAttachedChange(){this._laserline.attached=this._laserlineAttached}setStartEndFromWorldDownAtLocation(e){this._isWorldDown=!0,(0,s.c)(this._start,e),this.view.renderCoordsHelper.worldUpAtPosition(e,this._end),(0,s.b)(this._end,e,this._end),(0,d.zk)(this._start,this._end,this._ray),this._updateGeometry()}get start(){return this._start}set start(e){this._isWorldDown=!1,(0,s.k)(this._start,e)||((0,s.c)(this._start,e),(0,d.zk)(this._start,this._end,this._ray),this._updateGeometry())}get end(){return this._end}set end(e){this._isWorldDown=!1,(0,s.k)(this._end,e)||((0,s.c)(this._end,e),(0,d.zk)(this._start,this._end,this._ray),this._updateGeometry())}get width(){return this._width}set width(e){e!==this._width&&(this._width=e,this._updateMaterial())}get color(){return this._color}set color(e){(0,o.g)(e,this._color)||((0,o.c)(this._color,e),this._updateMaterial())}get polygonOffset(){return this._polygonOffset}set polygonOffset(e){e!==this._polygonOffset&&(this._polygonOffset=e,this._updateMaterial())}get writeDepthEnabled(){return this._writeDepthEnabled}set writeDepthEnabled(e){this._writeDepthEnabled!==e&&(this._writeDepthEnabled=e,this._updateMaterial())}get innerWidth(){return this._innerWidth}set innerWidth(e){e!==this._innerWidth&&(this._innerWidth=e,this._updateMaterial())}get innerColor(){return this._innerColor}set innerColor(e){(0,o.g)(e,this._innerColor)||((0,o.c)(this._innerColor,e),this._updateMaterial())}get stipplePattern(){return this._stipplePattern}set stipplePattern(e){const t=(0,i.pC)(e)!==(0,i.pC)(this._stipplePattern);this._stipplePattern=e,t?this.recreate():this._updateMaterial()}get stippleOffColor(){return this._stippleOffColor}set stippleOffColor(e){((0,i.Wi)(e)||(0,i.Wi)(this._stippleOffColor)||!(0,o.g)(e,this._stippleOffColor))&&(this._stippleOffColor=(0,i.pC)(e)?(0,a.c)(e):null,this._updateMaterial())}get stipplePreferContinuous(){return this._stipplePreferContinuous}set stipplePreferContinuous(e){e!==this._stipplePreferContinuous&&(this._stipplePreferContinuous=e,this._updateMaterial())}get falloff(){return this._falloff}set falloff(e){e!==this._falloff&&(this._falloff=e,this._updateMaterial())}get extensionType(){return this._extensionType}set extensionType(e){e!==this._extensionType&&(this._extensionType=e,this.recreateGeometry())}get _laserlineAttached(){return this._laserlineEnabled&&(0,i.pC)(this._laserlineStyle)&&this.attached&&!this.isDraped}get laserlineStyle(){return this._laserlineStyle}set laserlineStyle(e){this._laserlineStyle=e,this._laserline.attached=this._laserlineAttached,(0,i.pC)(e)&&(this._laserline.style=e)}get laserlineEnabled(){return this._laserlineEnabled}set laserlineEnabled(e){this._laserlineEnabled!==e&&(this._laserlineEnabled=e,this._laserline.attached=this._laserlineAttached)}get renderOccluded(){return this._renderOccluded}set renderOccluded(e){e!==this._renderOccluded&&(this._renderOccluded=e,this._updateMaterial())}get _normalizedRenderOccluded(){return this.isDraped&&this._renderOccluded===g.yD.OccludeAndTransparentStencil?g.yD.OccludeAndTransparent:this._renderOccluded}get fadedExtensions(){return this._fadedExtensions}set fadedExtensions(e){this._fadedExtensions=(0,i.Pt)(e,O),this.recreateGeometry()}_updateMaterial(){const{materialParameters:e}=this;(0,i.WG)(this.object3dResources.resources)?.material.setParameters(e),(0,i.WG)(this.drapedResources.resources)?.material.setParameters(e)}get materialParameters(){return{width:this._width,color:this._color,stippleOffColor:this._stippleOffColor,stipplePattern:this._stipplePattern,stipplePreferContinuous:this._stipplePreferContinuous,innerWidth:this._innerWidth,innerColor:this._innerColor,falloff:this._falloff,hasPolygonOffset:this._polygonOffset,renderOccluded:this._normalizedRenderOccluded,writeDepth:this._writeDepthEnabled}}_createObject3DResources(e){const t=new D.U(this.materialParameters),r=new Array;return this._createObject3DGeometry(t,e,r),{material:t,geometries:r,forEach:e=>{e(t),r.forEach(e)}}}_destroyExternalResources(e){e.geometries=[],e.material.dispose()}_recreateObject3DGeometry(e,t){e.geometries.length=0,this._createObject3DGeometry(e.material,t,e.geometries)}_createObject3DGeometry(e,t,r){const i=this._createGeometry(e);r.push(i),t.addGeometry(i),this._updateVerticesObject3D(t)}_createDrapedResources(){const e=new D.U(this.materialParameters);return{material:e,geometries:[this._createDrapedGeometry(e)]}}_recreateDrapedGeometry(e){e.geometries=[this._createDrapedGeometry(e.material)]}_createDrapedGeometry(e){const t=this._createGeometry(e);this._updateVerticesDraped(t);const r=new m.z(t,{boundingInfo:t.boundingInfo});return r.computeBoundingSphere(r.transformation,r.boundingSphere),r}_createGeometry(e){const t=this.extensionType===R.FADED,r=t?[(0,n.c)(),(0,n.c)(),(0,n.c)(),(0,n.c)()]:[(0,n.c)(),(0,n.c)()];return(0,f.rh)(e,r,null,t?[1,1,1,0,1,1,1,1,1,1,1,1,1,1,1,0]:null)}_updateGeometry(){if(this.isDraped)this.drapedResources.recreateGeometry();else{const e=(0,i.WG)(this.object3dResources.object);e&&this._updateVerticesObject3D(e)}}_updateVerticesObject3D(e){const t=this._lineSegment;this._updateVertexAttributesObject3D(e,t),this._laserline.intersectsLine=t}_updateVerticesDraped(e){this._updateVertexAttributesDraped(e,this._lineSegment)}get _lineSegment(){return this._extensionType===R.FADED?this._updateLineSegmentFinite(A):this._updateLineSegmentInfinite(this._extensionType,A)}_updateLineSegmentFinite(e){return(0,h.zk)(this._start,this._end,e)}_updateLineSegmentInfinite(e,t){const r=this.view.state.camera;switch((0,l.iL)(this._ray,x),e){case R.LINE:x.c0=-Number.MAX_VALUE;break;case R.RAY:case R.GROUND_RAY:{const e=this._ray.origin,t=(0,i.Pt)(this.view.elevationProvider.getElevation(e[0],e[1],e[2],this.view.renderCoordsHelper.spatialReference,"ground"),0),r=this.view.renderCoordsHelper.getAltitude(e);this._isWorldDown&&r<t&&(0,s.o)(x.ray.direction,x.ray.direction),this._extensionType===R.GROUND_RAY&&null!=t&&(x.c1=Math.abs(r-t));break}}if(!(0,c.zq)(r.frustum,x))return this._updateLineSegmentFinite(t);const n=(0,l.Ws)(x,w),o=(0,l.S$)(x,b);return(0,h.zk)(n,o,t)}_updateVertexAttributesObject3D(e,t){const r=e.geometries[0].getMutableAttribute(y.T.POSITION)?.data;if(!r)return;let i=0;for(const e of this._lineVertices(t))r[i++]=e[0],r[i++]=e[1],r[i++]=e[2];e.geometryVertexAttrsUpdated(e.geometries[0])}_updateVertexAttributesDraped(e,t){const r=e.getMutableAttribute(y.T.POSITION)?.data;if(!r)return;let i=0;for(const e of this._lineVertices(t))r[i++]=e[0],r[i++]=e[1],r[i++]=_.Rn;e.invalidateBoundingInfo()}*_lineVertices(e){this.extensionType===R.FADED?(yield(0,h.KU)(e,-this.fadedExtensions.start,w),yield(0,h.KU)(e,0,w),yield(0,h.KU)(e,1,w),yield(0,h.KU)(e,1+this.fadedExtensions.end,w)):(yield(0,h.KU)(e,0,w),yield(0,h.KU)(e,1,w))}}const x=(0,l.Ue)(),w=(0,n.c)(),b=(0,n.c)(),A=(0,h.Ue)();var R,C;(C=R||(R={}))[C.LINE=0]="LINE",C[C.RAY=1]="RAY",C[C.GROUND_RAY=2]="GROUND_RAY",C[C.FADED=3]="FADED";const S=1/3,O={start:S,end:S}},26653:(e,t,r)=>{r.d(t,{L:()=>D});var i=r(19431),s=r(61681),n=r(6766),o=r(8909),a=r(88589),l=r(1983),c=r(90472),h=r(37116),d=r(68817),u=r(7426),p=r(63669),_=r(29642),f=r(48807),g=r(6087),m=r(21414),y=r(98166);class D{constructor(e){this.view=null,this._geometry=null,this._size=3,this._color=(0,l.f)(1,0,1,1),this._pixelSnappingEnabled=!0,this._primitive="square",this._outlineSize=1,this._outlineColor=(0,l.f)(1,1,1,1),this._elevationInfo=null,this._resources=new u.O({view:e.view,createResources:e=>this._createResources(e),destroyResources:e=>this._destroyResources(e),recreateGeometry:(e,t)=>{e.geometry=this._recreateGeometry(t,e.material)}});let t=!0;for(const r in e)r in this?"attached"===r?t=e[r]??!1:this[r]=e[r]:console.error("Cannot set unknown property",r);this.attached=t}destroy(){this._resources.destroy()}get visible(){return this._resources.visible}set visible(e){this._resources.visible=e}get attached(){return this._resources.attached}set attached(e){this._resources.attached=e}get geometry(){return this._geometry}set geometry(e){this._geometry=e,this._resources.recreateGeometry()}get size(){return this._size}set size(e){if(e!==this._size){const t=this._preferredTextureSize;this._size=e,t<this._preferredTextureSize?(0,s.pC)(this._resources)&&this._resources.recreate():this._updateSizeAttribute()}}get color(){return this._color}set color(e){(0,a.g)(e,this._color)||((0,a.c)(this._color,e),this._updateMaterial())}get pixelSnappingEnabled(){return this._pixelSnappingEnabled}set pixelSnappingEnabled(e){this._pixelSnappingEnabled!==e&&(this._pixelSnappingEnabled=e,this._updateMaterial())}get primitive(){return this._primitive}set primitive(e){this._primitive!==e&&(this._primitive=e,(0,s.pC)(this._resources)&&this._resources.recreate())}get outlineSize(){return this._outlineSize}set outlineSize(e){e!==this._outlineSize&&(this._outlineSize=e,this._updateMaterial())}get outlineColor(){return this._outlineColor}set outlineColor(e){(0,a.g)(e,this._outlineColor)||((0,a.c)(this._outlineColor,e),this._updateMaterial())}get elevationInfo(){return this._elevationInfo}set elevationInfo(e){this._elevationInfo=e,this._resources&&this._resources.recreateGeometry()}_updateMaterial(){const e=this._resources.resources;(0,s.Wi)(e)||e.material.setParameters(this._materialParameters(e.texture.id))}_updateSizeAttribute(){const e=this._resources.resources,t=this._resources.object;if((0,s.Wi)(e)||(0,s.Wi)(t))return;const r=e.geometry;if((0,s.Wi)(r))return;const i=r.getMutableAttribute(m.T.SIZE).data,n=this._geometrySize;i[0]=n,i[1]=n,t.geometryVertexAttrsUpdated(t.geometries[0])}_materialParameters(e){return{color:this._color,textureIsSignedDistanceField:!0,distanceFieldBoundingBox:x,occlusionTest:!1,outlineColor:this._outlineColor,outlineSize:this._outlineSize,textureId:e,polygonOffset:!1,shaderPolygonOffset:0,drawInSecondSlot:!0,depthEnabled:!1,pixelSnappingEnabled:this.pixelSnappingEnabled}}get _geometrySize(){return this._size/v}_recreateGeometry(e,t){const r=this._createRenderGeometry(t);return(0,s.pC)(r)&&e.addGeometry(r),r}_createResources(e){const t=(0,f.cU)(this._primitive,this._preferredTextureSize),r=new y.A(this._materialParameters(t.id)),i=this._recreateGeometry(e,r);return{material:r,texture:t,geometry:i,forEach(e){e(t),e(r),(0,s.pC)(this.geometry)&&e(this.geometry)}}}_destroyResources(e){e.geometry=null,e.material.dispose(),e.texture.dispose()}get _preferredTextureSize(){return(0,i.uZ)((0,i.Sf)(2*this._geometrySize),16,128)}calculateMapBounds(e){if((0,s.Wi)(this._resources.resources)||(0,s.Wi)(this._resources.resources.geometry))return!1;const t=this._resources.resources.geometry.vertexAttributes.get(m.T.POSITION);return(0,c.SH)(t.data,this.view.renderCoordsHelper.spatialReference,w,this.view.spatialReference),(0,h.G1)(e,w),!0}_createRenderGeometry(e){const t=this.geometry;if((0,s.Wi)(t))return null;const{renderCoordsHelper:r,elevationProvider:i}=this.view,o=(0,p.w7)(t,i,_.o.fromElevationInfo(this.elevationInfo),r),a=(0,n.s)(d.WM.get(),t.x,t.y,o),l=d.WM.get();(0,c.SH)(a,t.spatialReference,l,r.spatialReference);const h=this._geometrySize;return(0,g.dV)(e,null,l,null,[h,h],[0,0,0,1])}}const v=f.Ns,x=[v/2,v/2,1-v/2,1-v/2],w=(0,o.c)()},83061:(e,t,r)=>{r.d(t,{R:()=>b});var i=r(61681),s=r(76868),n=r(24455),o=r(39100),a=r(6766),l=r(8909),c=r(88589),h=r(1983),d=r(68817),u=r(48358),p=r(17444),_=r(99608),f=r(85799),g=r(45467),m=r(6087),y=r(7358),D=r(13304),v=r(21414),x=r(84891),w=r(65392);class b extends p.i{constructor(e){super(e),this._maxSize=0,this._position=(0,l.c)(),this._up=(0,l.c)(),this._right=(0,l.c)(),this._renderOccluded=y.yD.OccludeAndTransparent,this._color=(0,h.f)(1,0,0,1),this._outlineColor=(0,h.f)(0,0,0,1),this._outlineSize=0,this._size=32,this._outlineRenderOccluded=y.yD.Opaque,this.applyProps(e)}createObject3DResourceFactory(e){return{view:e,createResources:e=>this._createObject3DResources(e),destroyResources:e=>this._destroyObject3DResources(e),cameraChanged:()=>this._updateTransformObject3D()}}createDrapedResourceFactory(e){return{view:e,createResources:()=>this._createDrapedResources(),destroyResources:e=>this._destroyDrapedResources(e)}}get renderOccluded(){return this._renderOccluded}set renderOccluded(e){e!==this._renderOccluded&&(this._renderOccluded=e,this._updateQuadMaterial())}get color(){return this._color}set color(e){(0,c.c)(this._color,e),this._updateQuadMaterial()}get outlineColor(){return this._outlineColor}set outlineColor(e){(0,c.c)(this._outlineColor,e),this._updateOutlineMaterial()}get outlineSize(){return this._outlineSize}set outlineSize(e){const t=0===this._outlineSize!=(0===e);this._outlineSize=e,t?this.recreateGeometry():this._updateOutlineMaterial()}get size(){return this._size}set size(e){e!==this._size&&(this._size=e,this._updateTransform())}get outlineRenderOccluded(){return this._outlineRenderOccluded}set outlineRenderOccluded(e){this._outlineRenderOccluded=e,this._updateOutlineMaterial()}set geometry({previous:e,center:t,next:r}){this._maxSize=Math.min((0,a.i)(t,e),(0,a.i)(t,r))/3,(0,a.n)(this._up,(0,a.b)(this._up,e,t)),(0,a.n)(this._right,(0,a.b)(this._right,r,t)),(0,a.c)(this._position,t),this.recreateGeometry()}_createObject3DResources(e){const t=new x.E(this._quadMaterialParameters),r=0===this._outlineSize?void 0:new w.U(this._outlineMaterialParameters);return this._createObject3DGeometries(e,t,r),{quadMaterial:t,outlineMaterial:r,forEach:e=>{e(t),r&&e(r)}}}_destroyObject3DResources(e){e.quadMaterial.dispose(),e.outlineMaterial?.dispose()}_createObject3DGeometries(e,t,r){if((0,a.k)(this._up,l.Z)&&(0,a.k)(this._right,l.Z))return;const i=this._createGeometries(t,r);for(const t of i)e.addGeometry(t);this._updateTransformObject3D(e)}_createDrapedResources(){const e=new x.E(this._quadMaterialParameters),t=0===this._outlineSize?void 0:new w.U(this._outlineMaterialParameters),r=this._createGeometries(e,t).map((e=>new D.z(e,{boundingInfo:e.boundingInfo})));return this._setTransformDraped(r),{quadMaterial:e,outlineMaterial:t,geometries:r,pixelRatioHandle:(0,s.YP)((()=>this.view.state.contentPixelRatio),(()=>{this.drapedResources.recreateGeometry()}))}}_destroyDrapedResources(e){e.pixelRatioHandle.remove(),e.geometries=[],e.outlineMaterial?.dispose(),e.quadMaterial.dispose()}_createGeometries(e,t){const{up:r,right:i,corner:s}=this._getVertices(),n=this._quadGeometryData(r,i,s,e);return t?[n,(0,m.rh)(t,[r,s,i])]:[n]}_getVertices(){let e=this._up,t=this._right;const r=(0,a.a)(d.WM.get(),e,t);return this.isDraped&&(e=(0,a.c)(d.WM.get(),e),t=(0,a.c)(d.WM.get(),t),e[2]=0,t[2]=0,r[2]=0),{up:e,right:t,corner:r}}_updateTransform(){this.isDraped?this.drapedResources.recreateGeometry():this._updateTransformObject3D()}_updateTransformObject3D(e=(0,i.WG)(this.object3dResources.object)){if(!e)return;const t=this.view.state.camera,r=this._size*t.computeScreenPixelSizeAt(this._position),s=Math.min(this._maxSize,r);(0,n.f)(A,this._position),(0,n.k)(A,A,[s,s,s]),e.transformation=A}_setTransformDraped(e){if(0===e.length)return;const{view:{basemapTerrain:{overlayManager:t},state:{contentPixelRatio:r}}}=this,{_position:s,_size:o}=this,l=(0,a.c)(d.WM.get(),s);l[2]=_.Rn;const c=R;c.spatialReference=(0,i.Wg)(t.renderer.spatialReference),c.x=l[0],c.y=l[1];const h=o*(t.overlayPixelSizeInMapUnits(c)*r),u=Math.min(this._maxSize,h);(0,n.f)(A,l),(0,n.k)(A,A,[u,u,1]);for(const t of e)t.updateTransformation((e=>{(0,n.c)(e,A)}))}_quadGeometryData(e,t,r,i){return new g.Z(i,[[v.T.POSITION,new f.a([0,0,0,...t,...e,...r],3,!0)]],[[v.T.POSITION,[0,1,2,1,2,3]]])}get _quadMaterialParameters(){return{color:this._color,transparent:!0,writeDepth:!1,polygonOffset:!0,renderOccluded:this._renderOccluded}}_updateQuadMaterial(){(0,i.WG)(this.object3dResources.resources)?.quadMaterial.setParameters(this._quadMaterialParameters),(0,i.WG)(this.drapedResources.resources)?.quadMaterial.setParameters(this._quadMaterialParameters)}get _outlineMaterialParameters(){return{color:this._outlineColor,width:this._outlineSize,renderOccluded:this._outlineRenderOccluded}}_updateOutlineMaterial(){(0,i.WG)(this.object3dResources.resources)?.outlineMaterial?.setParameters(this._outlineMaterialParameters),(0,i.WG)(this.drapedResources.resources)?.outlineMaterial?.setParameters(this._outlineMaterialParameters)}}const A=(0,o.c)(),R=(0,u.Tx)(0,0,void 0,null)},92144:(e,t,r)=>{r.d(t,{j:()=>g});var i=r(61681),s=r(6766),n=r(8909),o=r(88589),a=r(13540),l=r(10449),c=r(29642),h=r(63669),d=r(47481);var u=r(70984),p=r(6087),_=r(7358),f=r(2070);class g extends l._{constructor(e){super(e),this.view=null,this._renderOccluded=_.yD.OccludeAndTransparent,this._vertices=null,this._spatialReference=null,this._color=a.Xd.colorToVec4(a.Xd.reshapeManipulators.vertex.color),this._size=a.Xd.reshapeManipulators.vertex.size,this._outlineColor=a.Xd.colorToVec4(a.Xd.reshapeManipulators.vertex.outlineColor),this._outlineSize=a.Xd.reshapeManipulators.vertex.outlineSize,this._elevationInfo=null,this.applyProps(e)}get renderOccluded(){return this._renderOccluded}set renderOccluded(e){e!==this._renderOccluded&&(this._renderOccluded=e,this._updateMaterial(),this._updateOutlineMaterial())}get vertices(){return this._vertices}set vertices(e){this._vertices=e,this.recreateGeometry()}get spatialReference(){return this._spatialReference}set spatialReference(e){this._spatialReference=e,this.recreateGeometry()}get color(){return this._color}set color(e){(0,o.g)(e,this._color)||((0,o.c)(this._color,e),this._updateMaterial())}get size(){return this._size}set size(e){e!==this._size&&(this._size=e,this._updateMaterial())}get outlineColor(){return this._outlineColor}set outlineColor(e){(0,o.g)(e,this._outlineColor)||((0,o.c)(this._outlineColor,e),this._updateOutlineMaterial())}get outlineSize(){return this._outlineSize}set outlineSize(e){e!==this._outlineSize&&(this._outlineSize=e,this._updateOutlineMaterial())}get elevationInfo(){return this._elevationInfo}set elevationInfo(e){this._elevationInfo=e,this.recreateGeometry()}get _vertexMaterialParameters(){return{color:this._color,transparent:this._color[3]<1,screenSizeScale:this.size,renderOccluded:this._renderOccluded}}get _vertexOutlineMaterialParameters(){return{color:this._outlineColor,transparent:this._outlineColor[3]<1,screenSizeScale:this.size+2*this.outlineSize,renderOccluded:this._renderOccluded}}_updateMaterial(){this.attached&&this._vertexMaterial.setParameters(this._vertexMaterialParameters)}_updateOutlineMaterial(){this.attached&&this._vertexOutlineMaterial.setParameters(this._vertexOutlineMaterialParameters)}_createRenderGeometries(){const e=this.vertices;if((0,i.Wi)(e)||0===e.length)return[];const t=function(e,t,r,i,s){const n=(0,d.bg)(3*e.length),o=(0,d.bg)(n.length);e.forEach(((e,t)=>{n[3*t+0]=e[0],n[3*t+1]=e[1],n[3*t+2]=e.length>2?e[2]:0}));const a=(0,h.rR)(n,t,0,o,0,n,0,n.length/3,r,i,s),l=null!=a;return{numVertices:e.length,position:n,mapPositions:o,projectionSuccess:l,sampledElevation:a}}(e,this.spatialReference,this.view.elevationProvider,this.view.renderCoordsHelper,c.o.fromElevationInfo(this.elevationInfo)),r=[],n=t.numVertices,o=t.position;for(let e=0;e<n;++e){const t=(0,s.s)(m,o[3*e+0],o[3*e+1],o[3*e+2]),i=y(this._vertexMaterial,.5,t),n=y(this._vertexOutlineMaterial,.5,t);r.push({vertexGeometry:i,vertexOutlineGeometry:n})}return r}createGeometries(e){const t=this._createRenderGeometries();for(const{vertexGeometry:r,vertexOutlineGeometry:i}of t)e.addGeometry(r),e.addGeometry(i)}createExternalResources(){this._vertexMaterial=new f.Q({...this._vertexMaterialParameters,writeDepth:!0,cullFace:u.Vr.Back,screenSizeEnabled:!0}),this._vertexOutlineMaterial=new f.Q({...this._vertexOutlineMaterialParameters,transparent:!0,writeDepth:!0,cullFace:u.Vr.Front,screenSizeEnabled:!0,shadingEnabled:!1})}destroyExternalResources(){this._vertexMaterial=null,this._vertexOutlineMaterial=null}forEachExternalMaterial(e){e(this._vertexMaterial),e(this._vertexOutlineMaterial)}}const m=(0,n.c)();function y(e,t,r){return(0,p.PI)(e,t,16,16,{offset:r})}},73080:(e,t,r)=>{r.d(t,{N:()=>i});class i{constructor(e){this.vertexHandle=null,this.excludeFeature=null,this.visualizer=null,this.selfSnappingZ=null,this.editGeometryOperations=e.editGeometryOperations,this.elevationInfo=e.elevationInfo,this.pointer=e.pointer,this.vertexHandle=e.vertexHandle,this.excludeFeature=e.excludeFeature,this.visualizer=e.visualizer,this.selfSnappingZ=e.selfSnappingZ}get coordinateHelper(){return this.editGeometryOperations.data.coordinateHelper}get spatialReference(){return this.coordinateHelper.spatialReference}}},73464:(e,t,r)=>{r.d(t,{W:()=>d});var i=r(61681),s=r(78668),n=r(76868),o=r(41109),a=r(45043),l=r(76478),c=r(73080),h=r(22167);function d({predicate:e=(()=>!0),snappingManager:t,snappingContext:r,updatingHandles:a,useZ:d=!0}){const g=new l.hM;if((0,i.Wi)(t))return{snappingStep:[f,g],cancelSnapping:f};let m,y=null,D=null,v=null;const x=()=>{y=(0,i.IM)(y),t.doneSnapping(),(0,i.pC)(D)&&D.frameTask.remove(),D=null,m=(0,i.hw)(m),v=null},w=(b=t,A=d,R=g,(0,s.Ds)((async({frameTask:e,point:t,scenePoint:r,context:s,event:n,delta:a,getLastState:l},c)=>{const h=await e.schedule((()=>b.snap({point:t,scenePoint:r,context:s,signal:c})),c);if(h.valid){let r=await e.schedule((()=>h.apply()),c);const d=l();(0,i.pC)(d.point)&&t!==d.point&&(r=b.update({point:d.point,scenePoint:d.scenePoint,context:s})),!(0,i.Wi)(d.updatePoint)&&(0,o.k)(r,d.updatePoint)||(_(n.mapEnd,r,a,A),R.execute(n))}})));var b,A,R;let C=null,S=null,O=null;return{snappingStep:[o=>{if(!e(o))return o;const{action:l}=o;if("start"===l){const{info:e}=o,s=function(e){return"3d"===e.type?e.resourceController.scheduler.registerTask(h.T8.SNAPPING):h.sq}(t.view);if(D=function(e,t,r){return{context:new c.N({editGeometryOperations:e.editGeometryOperations,elevationInfo:e.elevationInfo,pointer:e.pointer,vertexHandle:(0,i.pC)(t.info)?t.info.handle:null,excludeFeature:e.excludeFeature,visualizer:e.visualizer}),originalPos:(0,i.pC)(t.snapOrigin)?e.coordinateHelper.vectorToDehydratedPoint(t.snapOrigin):t.mapStart,originalScenePos:(0,i.pC)(t.scenePoints)?t.scenePoints.sceneStart:null,frameTask:r}}(r,o,s),D.context.selfSnappingZ=null,!d&&(0,i.pC)(e)){const t=function(e,t){if(!e.hasZ())return null;const r=t.vertices;let s=null;for(const t of r){const r=e.getZ(t.pos);if((0,i.pC)(s)&&(0,i.pC)(r)&&Math.abs(r-s)>1e-6)return null;(0,i.Wi)(s)&&(s=r)}return s}(r.coordinateHelper,e.handle.component);(0,i.pC)(t)&&(D.context.selfSnappingZ={value:t,elevationInfo:r.elevationInfo})}}if((0,i.pC)(D)){const{context:e,originalScenePos:r,originalPos:c}=D,{mapEnd:h,mapStart:f,scenePoints:g}=o,x=u(c,p(h,f)),b=p(f,c),A={...o,action:"update"},R=D.context,G=function(e,t){return(0,i.Wi)(e)||(0,i.Wi)(t)?null:u(e,p(t.sceneEnd,t.sceneStart))}(r,g),P=t.update({point:x,scenePoint:G,context:e});if(O=P,_(h,P,b,d),C=x,S=G,"end"!==l){const{frameTask:e}=D;(0,i.Wi)(y)&&(y=new AbortController),v=t=>{a.addPromise((0,s.R8)(w({frameTask:e,event:A,context:R,point:x,scenePoint:G,delta:b,getLastState:()=>({point:C,scenePoint:S,updatePoint:t.forceUpdate?null:O})},(0,i.Wg)(y).signal)))},v({forceUpdate:!1}),(0,i.Wi)(m)&&(m=(0,n.YP)((()=>t.options.effectiveEnabled),(()=>v?.({forceUpdate:!0}))))}}return"end"===l&&x(),o},g],cancelSnapping:e=>(x(),e)}}function u(e,[t,r,i]){const s=(0,a.WG)(e);return s.x+=t,s.y+=r,s.hasZ&&(s.z+=i),s}function p(e,t){const r=e.hasZ&&t.hasZ?e.z-t.z:0;return[e.x-t.x,e.y-t.y,r]}function _(e,t,[r,i,s],n){e.x=t.x+r,e.y=t.y+i,n&&e.hasZ&&t.hasZ&&(e.z=t.z+s)}function f(e){return e}},98028:(e,t,r)=>{r.d(t,{y:()=>h});var i=r(36663),s=r(53443),n=r(61681),o=r(78668),a=r(81977),l=(r(7283),r(7753),r(40266)),c=r(22167);let h=class extends s.Z{constructor(e){super(e),this.constrainResult=e=>e,this._snapPoints=null,this._frameTask=null,this._abortController=null,this._stagedPoint=null,this._snap=(0,o.Ds)((async(e,t,r,i)=>{const s=this._frameTask;if((0,n.Wi)(s))return;const o=await s.schedule((()=>t.snap({...e,context:r,signal:i})),i);o.valid&&await s.schedule((()=>{this.stagedPoint=o.apply(),e!==this._snapPoints&&(0,n.pC)(this._snapPoints)&&(this.stagedPoint=t.update({...this._snapPoints,context:r}))}),i)}))}get stagedPoint(){return this._stagedPoint}set stagedPoint(e){this._stagedPoint=this.constrainResult(e)}initialize(){const e="3d"===this.view.type?this.view?.resourceController?.scheduler:null;this._frameTask=(0,n.pC)(e)?e.registerTask(c.T8.SNAPPING):c.sq}destroy(){this._abortController=(0,n.IM)(this._abortController),this._frameTask=(0,n.hw)(this._frameTask)}update(e,t,r){this._snapPoints=e;const{point:i,scenePoint:s}=e,n=t.update({point:i,scenePoint:s,context:r});return this.stagedPoint=n,n}async snap(e,t,r){const{point:i,scenePoint:s}=e;return this.stagedPoint=t.update({point:i,scenePoint:s,context:r}),this._snapPoints=e,(0,n.Wi)(this._abortController)&&(this._abortController=new AbortController),this._snap(e,t,r,this._abortController.signal)}async resnap(e,t){(0,n.Wi)(this._snapPoints)||await this.snap(this._snapPoints,e,t)}abort(){this._abortController=(0,n.IM)(this._abortController),this._snapPoints=null}};(0,i._)([(0,a.Cb)({constructOnly:!0})],h.prototype,"view",void 0),(0,i._)([(0,a.Cb)()],h.prototype,"stagedPoint",null),(0,i._)([(0,a.Cb)()],h.prototype,"constrainResult",void 0),(0,i._)([(0,a.Cb)()],h.prototype,"_stagedPoint",void 0),h=(0,i._)([(0,l.j)("esri.views.interactive.snapping.SnappingOperation")],h)},4371:(e,t,r)=>{r.d(t,{a:()=>c});var i=r(23148),s=r(59282),n=r(65453),o=r(23688),a=r(82366),l=r(31367);class c{draw(e,t){const r=this._getUniqueHints(e),c=this.sortUniqueHints(r),h=[];for(const e of c)e instanceof s.w&&h.push(this.visualizeIntersectionPoint(e,t)),e instanceof n.w&&h.push(this.visualizeLine(e,t)),e instanceof o.L&&h.push(this.visualizeParallelSign(e,t)),e instanceof l.y&&h.push(this.visualizeRightAngleQuad(e,t)),e instanceof a.n&&h.push(this.visualizePoint(e,t));return(0,i.AL)(h)}sortUniqueHints(e){return e}_getUniqueHints(e){const t=[];for(const r of e){let e=!0;for(const i of t)if(r.equals(i)){e=!1;break}e&&t.push(r)}return t}}},82366:(e,t,r)=>{r.d(t,{n:()=>n});var i=r(6766),s=r(9650);class n extends s.r{constructor(e,t,r){super(t,r),this.point=e}equals(e){return e instanceof n&&(0,i.k)(this.point,e.point)}}},65771:(e,t,r)=>{r.d(t,{Z:()=>p});var i=r(36663),s=r(30936),n=r(53443),o=r(81977),a=(r(7283),r(7753),r(40266)),l=(r(56803),r(23569));r(22591);const c={bottom:"esri-text-overlay-item-anchor-bottom","bottom-right":"esri-text-overlay-item-anchor-bottom-right","bottom-left":"esri-text-overlay-item-anchor-bottom-left",top:"esri-text-overlay-item-anchor-top","top-right":"esri-text-overlay-item-anchor-top-right","top-left":"esri-text-overlay-item-anchor-top-left",center:"esri-text-overlay-item-anchor-center",right:"esri-text-overlay-item-anchor-right",left:"esri-text-overlay-item-anchor-left"};let h=class extends n.Z{get position(){return[this.x,this.y]}set position(e){this._set("x",e[0]),this._set("y",e[1])}get _textShadowColor(){return this.backgroundColor}get _textShadow(){const e=this._textShadowColor.toCss(!1);return`0 0 ${this._textShadowSize}px ${e}`}get _padding(){return.5*this.fontSize}get _borderRadius(){return this._padding}constructor(e){super(e),this.x=0,this.y=0,this.text="-",this.fontSize=14,this.anchor="center",this.visible=!0,this.backgroundColor=new s.Z([0,0,0,.6]),this.textColor=new s.Z([255,255,255]),this._textShadowSize=1}render(){return(0,l.h)("div",{classes:this._cssClasses(),styles:{left:Math.floor(this.x)+"px",top:Math.floor(this.y)+"px",visibility:this.visible?"visible":"hidden",fontSize:this.fontSize+"px",lineHeight:this.fontSize+"px",backgroundColor:this.backgroundColor.toCss(!0),color:this.textColor.toCss(!0),padding:this._padding+"px",borderRadius:this._borderRadius+"px",textShadow:this._textShadow}},[this.text])}renderCanvas(e){if(!this.visible)return;const t=e.font.replace(/^(.*?)px/,"");e.font=`${this.fontSize}px ${t}`;const r=this._padding,i=this._borderRadius,s=e.measureText(this.text).width,n=this.fontSize,o=d[this.anchor];e.textAlign="center",e.textBaseline="middle";const a=s+2*r,l=n+2*r,c=this.x+o.x*a,h=this.y+o.y*l;this._roundedRect(e,c,h,a,l,i),e.fillStyle=this.backgroundColor.toCss(!0),e.fill();const u=this.x+(o.x+.5)*a,p=this.y+(o.y+.5)*l;this._renderTextShadow(e,this.text,u,p),e.fillStyle=this.textColor.toCss(!0),e.fillText(this.text,u,p)}_renderTextShadow(e,t,r,i){e.lineJoin="miter",e.fillStyle=`rgba(${this._textShadowColor.r}, ${this._textShadowColor.g}, ${this._textShadowColor.b}, ${1/u.length})`;const s=this._textShadowSize;for(const[n,o]of u)e.fillText(t,r+s*n,i+s*o)}_roundedRect(e,t,r,i,s,n){e.beginPath(),e.moveTo(t,r+n),e.arcTo(t,r,t+n,r,n),e.lineTo(t+i-n,r),e.arcTo(t+i,r,t+i,r+n,n),e.lineTo(t+i,r+s-n),e.arcTo(t+i,r+s,t+i-n,r+s,n),e.lineTo(t+n,r+s),e.arcTo(t,r+s,t,r+s-n,n),e.closePath()}_cssClasses(){const e={"esri-text-overlay-item":!0};for(const t in c)e[c[t]]=this.anchor===t;return e}};(0,i._)([(0,o.Cb)()],h.prototype,"x",void 0),(0,i._)([(0,o.Cb)()],h.prototype,"y",void 0),(0,i._)([(0,o.Cb)()],h.prototype,"position",null),(0,i._)([(0,o.Cb)()],h.prototype,"text",void 0),(0,i._)([(0,o.Cb)()],h.prototype,"fontSize",void 0),(0,i._)([(0,o.Cb)()],h.prototype,"anchor",void 0),(0,i._)([(0,o.Cb)()],h.prototype,"visible",void 0),(0,i._)([(0,o.Cb)()],h.prototype,"backgroundColor",void 0),(0,i._)([(0,o.Cb)()],h.prototype,"textColor",void 0),(0,i._)([(0,o.Cb)()],h.prototype,"_textShadowSize",void 0),(0,i._)([(0,o.Cb)()],h.prototype,"_textShadowColor",null),(0,i._)([(0,o.Cb)()],h.prototype,"_textShadow",null),(0,i._)([(0,o.Cb)()],h.prototype,"_padding",null),(0,i._)([(0,o.Cb)()],h.prototype,"_borderRadius",null),h=(0,i._)([(0,a.j)("esri.views.overlay.TextOverlayItem")],h);const d={bottom:{x:-.5,y:-1,textAlign:"center",textBaseline:"bottom"},"bottom-left":{x:0,y:-1,textAlign:"left",textBaseline:"bottom"},"bottom-right":{x:-1,y:-1,textAlign:"right",textBaseline:"bottom"},center:{x:-.5,y:-.5,textAlign:"center",textBaseline:"middle"},left:{x:0,y:-.5,textAlign:"left",textBaseline:"middle"},right:{x:-1,y:-.5,textAlign:"right",textBaseline:"middle"},top:{x:-.5,y:0,textAlign:"center",textBaseline:"top"},"top-left":{x:0,y:0,textAlign:"left",textBaseline:"top"},"top-right":{x:-1,y:0,textAlign:"right",textBaseline:"top"}},u=[];{const e=16;for(let t=0;t<360;t+=360/e)u.push([Math.cos(Math.PI*t/180),Math.sin(Math.PI*t/180)])}const p=h}}]);