"use strict";(self.webpackChunkarcgis_webpack01=self.webpackChunkarcgis_webpack01||[]).push([[3084],{13540:(e,t,s)=>{s.d(t,{O9:()=>h,Xd:()=>P});var r=s(30936),i=s(39043),o=s(1983),n=s(56885),a=s(7358),l=s(66962);const h={main:new r.Z([255,127,0]),selected:new r.Z([255,255,255]),staged:new r.Z([12,207,255]),outline:new r.Z([0,0,0,.5]),selectedOutline:new r.Z([255,255,255])},d=.3;function c(e,t){const s=e.clone();return s.a*=t,s}function u(e,t){const s=e.clone(),r=(0,i._Y)(s);r.s*=t;const o=(0,i.xr)(r);return s.r=o.r,s.g=o.g,s.b=o.b,s}function p(e,t){if(t)for(const s in t)e[s]=t[s]}class _{constructor(e){this.color=h.main,this.height=90,this.coneHeight=40,this.coneWidth=23,this.width=3,this.renderOccluded=a.yD.Opaque,p(this,e)}}class f{constructor(e){this.size=11,this.outlineSize=1,this.collisionPadding=9,this.color=h.main,this.outlineColor=h.outline,this.renderOccluded=a.yD.Opaque,this.hoverOutlineColor=h.selectedOutline,p(this,e)}apply(e,t){const s=this[e];t.setParameters({color:D(s),transparent:"color"!==e||s.a<1,renderOccluded:this.renderOccluded})}}class g{constructor(e){this.size=40,this.height=.2,this.offset=.25,this.collisionPadding=2,this.color=c(h.main,.5),this.hoverColor=h.main,this.renderOccluded=a.yD.Transparent,this.minSquaredEdgeLength=900,p(this,e)}apply(e,t){const s=this[e];t.setParameters({color:D(s),transparent:s.a<1,renderOccluded:this.renderOccluded})}}class y{constructor(e){this.vertex=new f({color:h.main,outlineColor:h.outline}),this.edge=new f({color:u(c(h.main,2/3),.5),outlineColor:c(h.outline,.5),size:8,collisionPadding:8}),this.selected=new f({color:h.selected,outlineColor:h.outline}),this.edgeOffset=new g,p(this,e)}}class m{constructor(e){this.color=h.selected,this.width=1.5,this.stipplePattern=(0,l.z5)(5),this.stippleOffColor=h.outline,this.falloff=0,this.innerWidth=1.5,this.innerColor=h.selected,this.renderOccluded=a.yD.OccludeAndTransparent,p(this,e)}apply(e){e.color=D(this.color),e.width=this.width,e.stipplePattern=this.stipplePattern,e.stippleOffColor=D(this.stippleOffColor),e.falloff=this.falloff,e.innerWidth=this.innerWidth,e.innerColor=D(this.innerColor),e.renderOccluded=this.renderOccluded}}class w{constructor(e){this.color=h.selected,this.size=4,this.outlineSize=1,this.outlineColor=h.outline,this.shape="square",p(this,e)}apply(e){e.color=D(this.color),e.size=this.size,e.outlineSize=this.outlineSize,e.outlineColor=D(this.outlineColor),e.primitive=this.shape}}class v{constructor(e){this.innerColor=h.selected,this.innerWidth=1,this.glowColor=h.main,this.glowWidth=8,this.glowFalloff=8,this.globalAlpha=d,this.globalAlphaContrastBoost=1.5,this.radius=3,this.heightFillColor=h.main,p(this,e)}apply(e,t=1){const s={glowColor:r.Z.toUnitRGB(this.glowColor),glowFalloff:this.glowFalloff,glowWidth:this.glowWidth,innerColor:r.Z.toUnitRGB(this.innerColor),innerWidth:this.innerWidth,globalAlpha:this.globalAlpha*t,globalAlphaContrastBoost:this.globalAlphaContrastBoost,intersectsLineRadius:this.radius};"style"in e?e.style=s:e.laserlineStyle=s}}class b{constructor(e){this.outline=new m({color:h.outline,renderOccluded:a.yD.OccludeAndTransparentStencil,stippleOffColor:h.selected,stipplePattern:(0,l.z5)(5),width:1.5,innerWidth:0}),this.staged=new m({color:h.selected,renderOccluded:a.yD.OccludeAndTransparentStencil,innerColor:h.staged,stippleOffColor:h.outline,stipplePattern:(0,l.z5)(5),width:1.5}),this.shadowStyle=new v({globalAlpha:d,glowColor:h.main,glowFalloff:8,glowWidth:8,innerColor:h.selected,innerWidth:1}),p(this,e)}}class C{constructor(e){this.outline=new w({color:h.selected,outlineColor:h.outline,outlineSize:1,shape:"circle",size:4}),this.shadowStyle=new v({globalAlpha:d,glowColor:h.main,glowFalloff:1.5,glowWidth:6,innerColor:h.selected,innerWidth:1,radius:2}),p(this,e)}}class R extends m{constructor(e){super(),this.extensionType=n.n.GROUND_RAY,p(this,e)}}class O{constructor(e){this.lineGraphics=new b,this.pointGraphics=new C,this.heightPlane=new v({globalAlpha:d,glowColor:h.main,glowFalloff:8,glowWidth:8,innerColor:h.selected,innerWidth:1}),this.heightBox=new v({globalAlpha:d,glowColor:h.main,glowFalloff:8,glowWidth:8,innerColor:h.selected,innerWidth:0,heightFillColor:h.main}),this.zVerticalLine=new R({color:c(h.main,.5),falloff:2,innerColor:c(h.selected,0),renderOccluded:a.yD.OccludeAndTransparent,stipplePattern:null,width:5,extensionType:n.n.GROUND_RAY}),this.laserlineAlphaMultiplier=1.5,this.heightPlaneAngleCutoff=20,p(this,e)}}function D(e){return(0,o.b)(r.Z.toUnitRGBA(e))}const P=new class{constructor(e){this.visualElements=new O,this.reshapeManipulators=new y,this.zManipulator=new _,p(this,e)}colorToVec4(e){return D(e)}}},17444:(e,t,s)=>{s.d(t,{i:()=>g});var r=s(36663),i=s(53443),o=s(86618),n=s(61681),a=s(81977),l=(s(7283),s(7753),s(40266)),h=s(43977),d=s(79341),c=s(53448);class u{constructor(e){this._resourceFactory=e,this._resources=null,this._visible=!0,this._attached=!1,this._renderGroup=h.eZ.Outline}destroy(){this._destroyResources()}get resources(){return(0,n.pC)(this._resources)?this._resources.external:null}get visible(){return this._visible}set visible(e){e!==this._visible&&(this._visible=e,this._syncGeometriesToRenderer())}get attached(){return this._attached}set attached(e){e!==this._attached&&(this._attached=e,this._createOrDestroyResources())}get renderGroup(){return this._renderGroup}set renderGroup(e){this._renderGroup=e;const t=(0,n.WG)(this._resources)?.layerView;t&&(t.renderGroup=e)}recreate(){this.attached&&this._createResources()}recreateGeometry(){this._resourceFactory.recreateGeometry?(0,n.Wi)(this._resources)||(this._ensureRenderGeometriesRemoved(),this._resourceFactory.recreateGeometry(this._resources.external),this._syncGeometriesToRenderer()):this.recreate()}_createOrDestroyResources(){this._attached?(0,n.Wi)(this._resources)&&this._createResources():this._destroyResources()}_createResources(){this._destroyResources();const e=this._resourceFactory.createResources(),t=new p({view:this._resourceFactory.view,renderGroup:this._renderGroup}),s=this._resourceFactory.view.basemapTerrain?.overlayManager;this._resources={layerView:new p({view:this._resourceFactory.view,renderGroup:this._renderGroup}),external:e,geometriesAdded:!1},s&&(this._resources.drapeSourceRenderer=s.registerGeometryDrapeSource(t)),this._syncGeometriesToRenderer()}_destroyResources(){if((0,n.Wi)(this._resources))return;this._ensureRenderGeometriesRemoved();const e=this._resourceFactory.view.basemapTerrain?.overlayManager;e&&e.unregisterDrapeSource(this._resources.layerView),this._resourceFactory.destroyResources(this._resources.external),this._resources=null}_syncGeometriesToRenderer(){this._visible?this._ensureRenderGeometriesAdded():this._ensureRenderGeometriesRemoved()}_ensureRenderGeometriesRemoved(){(0,n.Wi)(this._resources)||(0,n.Wi)(this._resources.drapeSourceRenderer)||this._resources.geometriesAdded&&(this._resources.drapeSourceRenderer.removeGeometries(this._resources.external.geometries,d.T.UPDATE),this._resources.geometriesAdded=!1)}_ensureRenderGeometriesAdded(){(0,n.Wi)(this._resources)||(0,n.Wi)(this._resources.drapeSourceRenderer)||this._resources.geometriesAdded||(this._resources.drapeSourceRenderer.addGeometries(this._resources.external.geometries,d.T.UPDATE),this._resources.geometriesAdded=!0)}}let p=class extends((0,o.IG)(i.Z)){constructor(e){super(e),this.drapeSourceType=h.Lw.Features,this.updatePolicy=c.j.SYNC,this.renderGroup=h.eZ.Outline}};(0,r._)([(0,a.Cb)({constructOnly:!0})],p.prototype,"view",void 0),(0,r._)([(0,a.Cb)({readOnly:!0})],p.prototype,"drapeSourceType",void 0),(0,r._)([(0,a.Cb)()],p.prototype,"renderGroup",void 0),p=(0,r._)([(0,l.j)("DrapedVisualElementLayerView")],p);var _=s(76169),f=s(7426);class g extends _.l{constructor({view:e,isDraped:t}){super(e),this._isDraped=!1,this.object3dResources=new f.O(this.createObject3DResourceFactory(e)),this.drapedResources=new u(this.createDrapedResourceFactory(e)),this.isDraped=t??!1}get isDraped(){return this._isDraped}set isDraped(e){e!==this._isDraped&&(this._isDraped=e,this.object3dResources.attached=this.attached&&!e,this.drapedResources.attached=this.attached&&e)}get renderGroup(){return this.drapedResources.renderGroup}set renderGroup(e){this.drapedResources.renderGroup=e}createResources(){this.object3dResources.attached=!this._isDraped,this.drapedResources.attached=this._isDraped}destroyResources(){this.object3dResources.attached=!1,this.drapedResources.attached=!1}recreate(){this.object3dResources.recreate(),this.drapedResources.recreate()}recreateGeometry(){this.object3dResources.recreateGeometry(),this.drapedResources.recreateGeometry()}destroy(){this.object3dResources.destroy(),this.drapedResources.destroy(),super.destroy()}updateVisibility(e){this.object3dResources.visible=e,this.drapedResources.visible=e}}},56885:(e,t,s)=>{s.d(t,{V:()=>v,n:()=>D});s(39994);var r=s(61681),i=s(6766),o=s(8909),n=s(88589),a=s(18916),l=s(70740),h=s(59934),d=s(56215),c=s(97537),u=s(17444),p=s(40199),_=s(99608),f=s(6087),g=s(7358),y=s(13304),m=s(21414),w=s(65392);class v extends u.i{constructor(e){super(e),this._ray=(0,c.Ue)(),this._isWorldDown=!1,this._start=(0,o.c)(),this._end=(0,o.f)(1,0,0),this._width=1,this._color=(0,a.f)(1,0,1,1),this._polygonOffset=!1,this._writeDepthEnabled=!0,this._innerWidth=0,this._innerColor=(0,a.f)(1,1,1,1),this._stipplePattern=null,this._stippleOffColor=null,this._stipplePreferContinuous=!0,this._falloff=0,this._extensionType=D.LINE,this._laserlineStyle=null,this._laserlineEnabled=!1,this._renderOccluded=g.yD.OccludeAndTransparent,this._fadedExtensions=E,this._laserline=new p.W({view:this.view}),this.applyProps(e)}destroy(){this._laserline.destroy(),super.destroy()}createObject3DResourceFactory(e){return{view:e,createResources:e=>this._createObject3DResources(e),destroyResources:e=>this._destroyExternalResources(e),recreateGeometry:(e,t)=>this._recreateObject3DGeometry(e,t),cameraChanged:()=>this._updateGeometry()}}createDrapedResourceFactory(e){return{view:e,createResources:()=>this._createDrapedResources(),destroyResources:e=>this._destroyExternalResources(e),recreateGeometry:e=>this._recreateDrapedGeometry(e)}}updateVisibility(e){super.updateVisibility(e),this._laserline.visible=e}onAttachedChange(){this._laserline.attached=this._laserlineAttached}setStartEndFromWorldDownAtLocation(e){this._isWorldDown=!0,(0,i.c)(this._start,e),this.view.renderCoordsHelper.worldUpAtPosition(e,this._end),(0,i.b)(this._end,e,this._end),(0,c.zk)(this._start,this._end,this._ray),this._updateGeometry()}get start(){return this._start}set start(e){this._isWorldDown=!1,(0,i.k)(this._start,e)||((0,i.c)(this._start,e),(0,c.zk)(this._start,this._end,this._ray),this._updateGeometry())}get end(){return this._end}set end(e){this._isWorldDown=!1,(0,i.k)(this._end,e)||((0,i.c)(this._end,e),(0,c.zk)(this._start,this._end,this._ray),this._updateGeometry())}get width(){return this._width}set width(e){e!==this._width&&(this._width=e,this._updateMaterial())}get color(){return this._color}set color(e){(0,n.g)(e,this._color)||((0,n.c)(this._color,e),this._updateMaterial())}get polygonOffset(){return this._polygonOffset}set polygonOffset(e){e!==this._polygonOffset&&(this._polygonOffset=e,this._updateMaterial())}get writeDepthEnabled(){return this._writeDepthEnabled}set writeDepthEnabled(e){this._writeDepthEnabled!==e&&(this._writeDepthEnabled=e,this._updateMaterial())}get innerWidth(){return this._innerWidth}set innerWidth(e){e!==this._innerWidth&&(this._innerWidth=e,this._updateMaterial())}get innerColor(){return this._innerColor}set innerColor(e){(0,n.g)(e,this._innerColor)||((0,n.c)(this._innerColor,e),this._updateMaterial())}get stipplePattern(){return this._stipplePattern}set stipplePattern(e){const t=(0,r.pC)(e)!==(0,r.pC)(this._stipplePattern);this._stipplePattern=e,t?this.recreate():this._updateMaterial()}get stippleOffColor(){return this._stippleOffColor}set stippleOffColor(e){((0,r.Wi)(e)||(0,r.Wi)(this._stippleOffColor)||!(0,n.g)(e,this._stippleOffColor))&&(this._stippleOffColor=(0,r.pC)(e)?(0,a.c)(e):null,this._updateMaterial())}get stipplePreferContinuous(){return this._stipplePreferContinuous}set stipplePreferContinuous(e){e!==this._stipplePreferContinuous&&(this._stipplePreferContinuous=e,this._updateMaterial())}get falloff(){return this._falloff}set falloff(e){e!==this._falloff&&(this._falloff=e,this._updateMaterial())}get extensionType(){return this._extensionType}set extensionType(e){e!==this._extensionType&&(this._extensionType=e,this.recreateGeometry())}get _laserlineAttached(){return this._laserlineEnabled&&(0,r.pC)(this._laserlineStyle)&&this.attached&&!this.isDraped}get laserlineStyle(){return this._laserlineStyle}set laserlineStyle(e){this._laserlineStyle=e,this._laserline.attached=this._laserlineAttached,(0,r.pC)(e)&&(this._laserline.style=e)}get laserlineEnabled(){return this._laserlineEnabled}set laserlineEnabled(e){this._laserlineEnabled!==e&&(this._laserlineEnabled=e,this._laserline.attached=this._laserlineAttached)}get renderOccluded(){return this._renderOccluded}set renderOccluded(e){e!==this._renderOccluded&&(this._renderOccluded=e,this._updateMaterial())}get _normalizedRenderOccluded(){return this.isDraped&&this._renderOccluded===g.yD.OccludeAndTransparentStencil?g.yD.OccludeAndTransparent:this._renderOccluded}get fadedExtensions(){return this._fadedExtensions}set fadedExtensions(e){this._fadedExtensions=(0,r.Pt)(e,E),this.recreateGeometry()}_updateMaterial(){const{materialParameters:e}=this;(0,r.WG)(this.object3dResources.resources)?.material.setParameters(e),(0,r.WG)(this.drapedResources.resources)?.material.setParameters(e)}get materialParameters(){return{width:this._width,color:this._color,stippleOffColor:this._stippleOffColor,stipplePattern:this._stipplePattern,stipplePreferContinuous:this._stipplePreferContinuous,innerWidth:this._innerWidth,innerColor:this._innerColor,falloff:this._falloff,hasPolygonOffset:this._polygonOffset,renderOccluded:this._normalizedRenderOccluded,writeDepth:this._writeDepthEnabled}}_createObject3DResources(e){const t=new w.U(this.materialParameters),s=new Array;return this._createObject3DGeometry(t,e,s),{material:t,geometries:s,forEach:e=>{e(t),s.forEach(e)}}}_destroyExternalResources(e){e.geometries=[],e.material.dispose()}_recreateObject3DGeometry(e,t){e.geometries.length=0,this._createObject3DGeometry(e.material,t,e.geometries)}_createObject3DGeometry(e,t,s){const r=this._createGeometry(e);s.push(r),t.addGeometry(r),this._updateVerticesObject3D(t)}_createDrapedResources(){const e=new w.U(this.materialParameters);return{material:e,geometries:[this._createDrapedGeometry(e)]}}_recreateDrapedGeometry(e){e.geometries=[this._createDrapedGeometry(e.material)]}_createDrapedGeometry(e){const t=this._createGeometry(e);this._updateVerticesDraped(t);const s=new y.z(t,{boundingInfo:t.boundingInfo});return s.computeBoundingSphere(s.transformation,s.boundingSphere),s}_createGeometry(e){const t=this.extensionType===D.FADED,s=t?[(0,o.c)(),(0,o.c)(),(0,o.c)(),(0,o.c)()]:[(0,o.c)(),(0,o.c)()];return(0,f.rh)(e,s,null,t?[1,1,1,0,1,1,1,1,1,1,1,1,1,1,1,0]:null)}_updateGeometry(){if(this.isDraped)this.drapedResources.recreateGeometry();else{const e=(0,r.WG)(this.object3dResources.object);e&&this._updateVerticesObject3D(e)}}_updateVerticesObject3D(e){const t=this._lineSegment;this._updateVertexAttributesObject3D(e,t),this._laserline.intersectsLine=t}_updateVerticesDraped(e){this._updateVertexAttributesDraped(e,this._lineSegment)}get _lineSegment(){return this._extensionType===D.FADED?this._updateLineSegmentFinite(O):this._updateLineSegmentInfinite(this._extensionType,O)}_updateLineSegmentFinite(e){return(0,d.zk)(this._start,this._end,e)}_updateLineSegmentInfinite(e,t){const s=this.view.state.camera;switch((0,l.iL)(this._ray,b),e){case D.LINE:b.c0=-Number.MAX_VALUE;break;case D.RAY:case D.GROUND_RAY:{const e=this._ray.origin,t=(0,r.Pt)(this.view.elevationProvider.getElevation(e[0],e[1],e[2],this.view.renderCoordsHelper.spatialReference,"ground"),0),s=this.view.renderCoordsHelper.getAltitude(e);this._isWorldDown&&s<t&&(0,i.o)(b.ray.direction,b.ray.direction),this._extensionType===D.GROUND_RAY&&null!=t&&(b.c1=Math.abs(s-t));break}}if(!(0,h.zq)(s.frustum,b))return this._updateLineSegmentFinite(t);const o=(0,l.Ws)(b,C),n=(0,l.S$)(b,R);return(0,d.zk)(o,n,t)}_updateVertexAttributesObject3D(e,t){const s=e.geometries[0].getMutableAttribute(m.T.POSITION)?.data;if(!s)return;let r=0;for(const e of this._lineVertices(t))s[r++]=e[0],s[r++]=e[1],s[r++]=e[2];e.geometryVertexAttrsUpdated(e.geometries[0])}_updateVertexAttributesDraped(e,t){const s=e.getMutableAttribute(m.T.POSITION)?.data;if(!s)return;let r=0;for(const e of this._lineVertices(t))s[r++]=e[0],s[r++]=e[1],s[r++]=_.Rn;e.invalidateBoundingInfo()}*_lineVertices(e){this.extensionType===D.FADED?(yield(0,d.KU)(e,-this.fadedExtensions.start,C),yield(0,d.KU)(e,0,C),yield(0,d.KU)(e,1,C),yield(0,d.KU)(e,1+this.fadedExtensions.end,C)):(yield(0,d.KU)(e,0,C),yield(0,d.KU)(e,1,C))}}const b=(0,l.Ue)(),C=(0,o.c)(),R=(0,o.c)(),O=(0,d.Ue)();var D,P;(P=D||(D={}))[P.LINE=0]="LINE",P[P.RAY=1]="RAY",P[P.GROUND_RAY=2]="GROUND_RAY",P[P.FADED=3]="FADED";const G=1/3,E={start:G,end:G}},2790:(e,t,s)=>{s.d(t,{k:()=>O});var r=s(31355),i=s(61681),o=s(6766),n=s(8909),a=s(88589),l=s(18916),h=s(90472),d=s(37116),c=s(48358),u=s(83772),p=s(74710),_=s(17444),f=s(40199),g=s(29642),y=s(24370),m=s(41942),w=s(47481),v=s(7358),b=s(13304),C=s(21414),R=s(65392);class O extends _.i{constructor(e){super(e),this._attachmentOrigin=(0,c.Tx)(0,0,0,null),this._attachmentOriginDirty=!0,this.events=new r.Z,this._geometry=null,this._width=1,this._color=(0,l.f)(1,0,1,1),this._innerWidth=0,this._innerColor=(0,l.f)(1,1,1,1),this._stipplePattern=null,this._stippleOffColor=null,this._falloff=0,this._elevationInfo=null,this._laserlineStyle=null,this._laserlineEnabled=!1,this._renderOccluded=v.yD.OccludeAndTransparentStencil,this._attachmentOrigin.spatialReference=e.view.spatialReference,this._laserline=new f.W({view:e.view}),this.applyProps(e),this.attached=e.attached??!0}destroy(){this._laserline.destroy(),super.destroy()}createObject3DResourceFactory(e){return{view:e,createResources:e=>this._createObject3DResources(e),destroyResources:e=>this._destroyExternalResources(e),recreateGeometry:(e,t)=>{e.geometries.length=0,this._recreateGeometry(t,e.material,e.geometries)}}}createDrapedResourceFactory(e){return{view:e,createResources:()=>this._createDrapedResources(),destroyResources:e=>this._destroyExternalResources(e),recreateGeometry:e=>{e.geometries=this._createRenderGeometriesDraped(e.material),this._attachmentOriginChanged()}}}get _laserlineAttached(){return this.attached&&this.visible&&(0,i.pC)(this._laserlineStyle)&&!this.isDraped&&this.laserlineEnabled}onAttachedChange(e){this._laserline.attached=this._laserlineAttached,e&&this._attachmentOriginChanged()}get geometry(){return this._geometry}set geometry(e){this._geometry=e,this.recreateGeometry()}get width(){return this._width}set width(e){e!==this._width&&(this._width=e,this._updateMaterial())}get color(){return this._color}set color(e){(0,a.g)(e,this._color)||((0,a.c)(this._color,e),this._updateMaterial())}get innerWidth(){return this._innerWidth}set innerWidth(e){e!==this._innerWidth&&(this._innerWidth=e,this._updateMaterial())}get innerColor(){return this._innerColor}set innerColor(e){(0,a.g)(e,this._innerColor)||((0,a.c)(this._innerColor,e),this._updateMaterial())}get stipplePattern(){return this._stipplePattern}set stipplePattern(e){const t=(0,i.pC)(e)!==(0,i.pC)(this._stipplePattern);this._stipplePattern=e,t?this.recreate():this._updateMaterial()}get stippleOffColor(){return this._stippleOffColor}set stippleOffColor(e){e&&this._stippleOffColor&&(0,a.g)(e,this._stippleOffColor)||(this._stippleOffColor=e?(0,l.c)(e):null,this._updateMaterial())}get falloff(){return this._falloff}set falloff(e){e!==this._falloff&&(this._falloff=e,this._updateMaterial())}get elevationInfo(){return this._elevationInfo}set elevationInfo(e){this._elevationInfo=e,this.recreateGeometry()}get laserlineStyle(){return this._laserlineStyle}set laserlineStyle(e){this._laserlineStyle=e,this._laserline.attached=this._laserlineAttached,(0,i.pC)(e)&&(this._laserline.style=e)}get laserlineEnabled(){return this._laserlineEnabled}set laserlineEnabled(e){this._laserlineEnabled!==e&&(this._laserlineEnabled=e,this._laserline.attached=this._laserlineAttached)}get renderOccluded(){return this._renderOccluded}set renderOccluded(e){e!==this._renderOccluded&&(this._renderOccluded=e,this._updateMaterial())}get attachmentOrigin(){if(!this._attachmentOriginDirty)return this._attachmentOrigin;const e=(0,i.WG)(this.object3dResources.resources)?.geometries;if(!e||0===e.length)return null;(0,o.s)(G,0,0,0);let t=0;for(const s of e)s.computeAttachmentOrigin(P)&&((0,o.a)(G,G,P),t++);return 0===t?null:((0,o.g)(G,G,1/t),this.view.renderCoordsHelper.fromRenderCoords(G,this._attachmentOrigin),this._attachmentOriginDirty=!1,this._attachmentOrigin)}_updateMaterial(){(0,i.pC)(this.object3dResources.resources)&&this.object3dResources.resources.material.setParameters(this._materialParameters),(0,i.pC)(this.drapedResources.resources)&&this.drapedResources.resources.material.setParameters(this._materialParameters)}get _isClosed(){return(0,i.pC)(this.geometry)&&"polygon"===this.geometry.type}get _materialParameters(){return{width:this._width,color:this._color,stippleOffColor:this._stippleOffColor,stipplePattern:this._stipplePattern,stipplePreferContinuous:!1,isClosed:this._isClosed,falloff:this._falloff,innerColor:this._innerColor,innerWidth:this._innerWidth,join:"round",hasPolygonOffset:!0,renderOccluded:this._normalizedRenderOccluded}}get _normalizedRenderOccluded(){return this.isDraped&&this._renderOccluded===v.yD.OccludeAndTransparentStencil?v.yD.OccludeAndTransparent:this._renderOccluded}_recreateGeometry(e,t,s){this._createRenderGeometries(t,s);for(const t of s)e.addGeometry(t);this._attachmentOriginChanged()}_attachmentOriginChanged(){this._attachmentOriginDirty=!0,this.events.emit("attachment-origin-changed")}_destroyExternalResources(e){e.geometries=[],e.material.dispose()}_createObject3DResources(e){const t=new R.U(this._materialParameters),s=new Array;return this._recreateGeometry(e,t,s),{material:t,geometries:s,forEach:e=>{e(t),s.forEach(e)}}}_createDrapedResources(){const e=new R.U(this._materialParameters);return{material:e,geometries:this._createRenderGeometriesDraped(e)}}_createRenderGeometriesDraped(e){const t=this.geometry;if((0,i.Wi)(t)||(0,i.Wi)(this.view.basemapTerrain.spatialReference))return[];const s=(0,m.r)(t,this.view.basemapTerrain.spatialReference),r=[];for(const{position:t}of s.lines){const s={overlayInfo:{spatialReference:this.view.basemapTerrain.spatialReference,renderCoordsHelper:this.view.renderCoordsHelper},attributeData:{position:t},removeDuplicateStartEnd:this._isClosed},i=new b.z((0,y.Y)(e,s)),o=(0,d.cS)(D);(0,d.G1)(o,t),(0,a.s)(i.boundingSphere,.5*(o[0]+o[3]),.5*(o[1]+o[4]),0,.5*Math.sqrt((o[3]-o[0])*(o[3]-o[0])+(o[4]-o[1])*(o[4]-o[1]))),r.push(i)}return r}calculateMapBounds(e){if((0,i.Wi)(this.object3dResources.resources))return!1;const t=this.view.renderCoordsHelper;for(const s of this.object3dResources.resources.geometries){const r=s.vertexAttributes.get(C.T.POSITION),i=(0,w.bg)(r.data.length);(0,h.CM)(r.data,t.spatialReference,0,i,this.view.spatialReference,0,r.data.length/3),(0,d.G1)(e,i)}return!0}_createRenderGeometries(e,t){const s=this.geometry;if((0,i.Wi)(s))return;const r=(0,m.V)(s,this.view.elevationProvider,this.view.renderCoordsHelper,g.o.fromElevationInfo(this.elevationInfo??new p.Z({mode:(0,u.VW)(s,null)}))),o=new Array;for(const{position:s,mapPositions:i}of r.lines){const r={mapPositions:i,attributeData:{position:s},removeDuplicateStartEnd:this._isClosed};t.push((0,y.Y)(e,r)),o.push(s)}this._laserline.pathVerticalPlane=o}}const D=(0,d.Ue)(),P=(0,n.c)(),G=(0,n.c)()},76169:(e,t,s)=>{s.d(t,{l:()=>i});var r=s(76868);class i{constructor(e){this._attached=!1,this._resourcesCreated=!1,this._visible=!0,this.view=e,this._handle=(0,r.YP)((()=>this.view.ready),(e=>{this._resourcesCreated&&(e?this._createResources():this._destroyResources())}))}applyProps(e){let t=!1;for(const s in e)s in this?"attached"===s?t=e[s]:this[s]=e[s]:console.error("Cannot set unknown property",s);this.attached=t}destroy(){this.attached=!1,this._handle.remove()}get attached(){return this._attached}set attached(e){e!==this._attached&&this.view._stage&&(this._attached=e,this._attached&&!this._resourcesCreated?this._createResources():!this._attached&&this._resourcesCreated&&this._destroyResources(),this.onAttachedChange(e))}onAttachedChange(e){}get visible(){return this._visible}set visible(e){e!==this._visible&&(this._visible=e,this.attached&&this.updateVisibility(e))}_createResources(){this.createResources(),this._resourcesCreated=!0,this.updateVisibility(this.visible)}_destroyResources(){this.destroyResources(),this._resourcesCreated=!1}}},75354:(e,t,s)=>{s.d(t,{F:()=>a});var r=s(36663),i=s(31355),o=s(81977),n=(s(7283),s(7753),s(40266));let a=class extends i.Z.EventedAccessor{constructor(e){super(e),this.tracking=!1,this.displaying=!1,this.isDraped=!1}};(0,r._)([(0,o.Cb)({constructOnly:!0})],a.prototype,"graphic",void 0),(0,r._)([(0,o.Cb)()],a.prototype,"tracking",void 0),(0,r._)([(0,o.Cb)()],a.prototype,"displaying",void 0),(0,r._)([(0,o.Cb)()],a.prototype,"isDraped",void 0),a=(0,r._)([(0,n.j)("esri.views.3d.layers.graphics.GraphicState")],a)},63084:(e,t,s)=>{s.r(t),s.d(t,{ElevationProfileView3D:()=>E});var r=s(44584),i=s(61681),o=s(76868),n=s(89815),a=s(55109),l=s(67979),h=s(23148),d=s(78668),c=s(83772),u=s(13540),p=s(2790),_=s(75354),f=s(7358),g=s(42780);class y{constructor(e){this._params=e,this._highlightTask=null,this._highlightHandle=null,this._visualElementHandle=null}destroy(){this.remove()}remove(){this._highlightTask=(0,i.IM)(this._highlightTask),this._highlightHandle=(0,i.hw)(this._highlightHandle),this._visualElementHandle=(0,i.hw)(this._visualElementHandle)}showHighlight(e){if(this.remove(),(0,i.Wi)(e)||!m(e))return;const t=e.layer;this._highlightTask=(0,l.vr)((async s=>{const r=await this._params.view.whenLayerView(t);(0,d.k_)(s),(0,g.tl)(r)&&(this._highlightHandle=r.highlight(e))}))}showReshaping(e){if(this.remove(),(0,i.Wi)(e))return;const t=this._params.view,s=new p.k({view:t,geometry:m(e)?e.geometry:null,attached:!1,elevationInfo:(0,c.RL)(e),renderOccluded:f.yD.OccludeAndTransparentStencil}),r=new _.F({graphic:e}),n=[(0,o.YP)((()=>r.isDraped),(e=>{s.isDraped=e})),r.on("changed",(()=>{s.geometry=m(e)?e.geometry:null})),t.trackGraphicState(r),t.maskOccludee(e),(0,h.ed)(s)];u.Xd.visualElements.lineGraphics.outline.apply(s),s.attached=!0,this._visualElementHandle=(0,h.AL)(n)}}function m(e){return(0,i.pC)(e.geometry)&&"polyline"===e.geometry.type}var w=s(36663),v=s(30936),b=s(53443),C=s(618),R=s(81977),O=(s(7283),s(7753),s(40266)),D=s(1983),P=s(90819);let G=class extends b.Z{constructor(e){super(e),this._chartData=null,this._visualElements=[],this._handles=new r.Z}initialize(){const e=(0,C.P)((e=>{this._update(e)}),100);this._handles.add([(0,o.YP)((()=>({spatialReference:this.view.spatialReference,chartData:this._chartData})),e,o.tX),e])}destroy(){this._handles.destroy(),this._destroyVisualElements()}remove(){this._destroyVisualElements()}update(e){this._chartData=e}_update(e){const{chartData:t}=e;if((0,i.Wi)(t))return this.remove();if(!t.refined)return;const s=this._visualElements,r=t.lines.filter((e=>e.viewVisualizationEnabled)),o=r.length;for(;s.length>o;)s.pop().destroy();const a=(0,n.iE)().profileLinesStyle3D;for(;s.length<o;){const e=new p.k({view:this.view,elevationInfo:{mode:"absolute-height",offset:0},innerWidth:a.width-a.outlineSize,width:a.width,falloff:a.falloff,color:a.outlineColor,renderOccluded:a.renderOccluded});s.push(e)}const l=e.spatialReference;for(let e=0;e<o;++e){const t=s[e],i=r[o-1-e];t.geometry=this._createLineGeometry(i,l),t.innerColor=(0,D.b)(v.Z.toUnitRGBA(i.color))}}_createLineGeometry(e,t){const s=(0,i.Pt)(e.samples,[]),r=s.length-1,o=[];let n=[];for(let e=0;e<=r;e++){const{x:t,y:a,z:l}=s[e];(0,i.pC)(l)&&n.push([t,a,l]),(e===r||(0,i.Wi)(l))&&n.length&&(o.push(n),n=[])}return new P.Z({paths:o,hasZ:!0,spatialReference:t})}_destroyVisualElements(){this._visualElements.forEach((e=>e.destroy())),this._visualElements.length=0}};(0,w._)([(0,R.Cb)()],G.prototype,"view",void 0),(0,w._)([(0,R.Cb)()],G.prototype,"_chartData",void 0),G=(0,w._)([(0,O.j)("esri.widgets.ElevationProfile.support.ProfileLines3D")],G);class E{constructor(e,t){this._handles=new r.Z,this._inputRepresentation=new y({view:e}),this._hoveredPoints=new a.l({view:e}),this._profileLines=new G({view:e}),this._handles.add([(0,o.YP)((()=>t.viewModel.hoveredPoints),(e=>this._hoveredPoints.update(e)),o.tX),(0,o.YP)((()=>{const{state:e,editable:s,highlightEnabled:r,viewModel:o}=t,n=o.input;return(0,i.yw)(n,(e=>{e.commitProperty("geometry"),e.commitProperty("layer")})),{input:n,state:e,editable:s,highlightEnabled:r}}),(e=>this._updateInputRepresentation(e)),o.tX),(0,o.YP)((()=>t.viewModel.chartData),(e=>this._profileLines.update(e)),o.tX),(0,o.YP)((()=>(0,i.yw)(t.viewModel.input,(e=>e.geometry))),(()=>{this._profileLines.remove()}),o.tX)])}destroy(){this._handles=(0,i.SC)(this._handles),this._inputRepresentation=(0,i.SC)(this._inputRepresentation),this._hoveredPoints=(0,i.SC)(this._hoveredPoints),this._profileLines=(0,i.SC)(this._profileLines)}_updateInputRepresentation({input:e,state:t,editable:s,highlightEnabled:r}){const i=this._inputRepresentation;if(!r)return i.remove();t===n.dd.Selected?i.showHighlight(e):t!==n.dd.Created||s?i.remove():i.showReshaping(e)}}},55109:(e,t,s)=>{s.d(t,{l:()=>u});var r=s(36663),i=s(53443),o=s(41831),n=s(61681),a=s(76868),l=s(81977),h=(s(7283),s(7753),s(40266)),d=s(89815),c=s(83097);let u=class extends i.Z{constructor(e){super(e),this._hoveredPoints=new o.Z}initialize(){this.addHandles((0,a.YP)((()=>this._hoveredPoints.toArray().map((({anchor:e,element:t})=>({screenLocation:e.screenLocation,element:t})))),(e=>{for(const{screenLocation:t,element:s}of e)(0,n.yw)(t,(({x:e,y:t})=>{s.style.transform=`translate(${e}px, ${t}px)`}))}),a.tX))}destroy(){this._hoveredPoints.drain((e=>this._destroyHoveredPoint(e)))}update(e){const t=this.view,s=this._hoveredPoints,r=e.length;for(;this._hoveredPoints.length>r;)this._destroyHoveredPoint(this._hoveredPoints.pop());for(;this._hoveredPoints.length<r;){const e=this._makeHoveredPoint();s.push(e),t.surface?.appendChild(e.element)}for(let t=0;t<r;++t){const i=s.getItemAt(r-1-t),o=e[t];this._updateHoveredPoint(i,o)}}_makeHoveredPoint(){const{size:e,borderStyle:t,borderColor:s,borderWidth:r,boxShadow:i}=(0,d.iE)().hoveredPointsStyle,o=this.view,n=new c.Z({view:o,screenLocationEnabled:!0}),a=document.createElement("div"),l=a.style;return l.position="absolute",l.top="0",l.left="0",l.contain="strict",l.boxSizing="border-box",l.width=`${e}px`,l.height=`${e}px`,l.marginTop=`-${e/2}px`,l.marginLeft=`-${e/2}px`,l.border=`${t} ${r}px ${s}`,l.borderRadius=`${e}px`,l.boxShadow=i,{anchor:n,element:a}}_updateHoveredPoint({anchor:e,element:t},s){e.screenLocationEnabled=!0,e.location=s.hoveredPoint;const r=t.style;r.display="block",r.background=s.color.toCss()}_destroyHoveredPoint({anchor:e,element:t}){e.destroy(),this.view.surface?.removeChild(t)}};(0,r._)([(0,l.Cb)()],u.prototype,"view",void 0),(0,r._)([(0,l.Cb)()],u.prototype,"_hoveredPoints",void 0),u=(0,r._)([(0,h.j)("esri.widgets.ElevationProfile.support.HoveredPoints")],u)}}]);