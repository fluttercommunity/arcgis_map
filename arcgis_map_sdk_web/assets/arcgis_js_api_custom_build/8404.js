"use strict";(self.webpackChunkarcgis_webpack01=self.webpackChunkarcgis_webpack01||[]).push([[8404],{7505:(e,t,r)=>{r.d(t,{G6:()=>M,Ie:()=>P,J9:()=>C,RF:()=>p,U1:()=>w,vY:()=>c,ym:()=>d});var a=r(61681),n=r(53736);const i=(e,t,r)=>[t,r],s=(e,t,r)=>[t,r,e[2]],o=(e,t,r)=>[t,r,e[2],e[3]];function c(e){return e?{originPosition:"upper-left"===e.originPosition?"upperLeft":"lower-left"===e.originPosition?"lowerLeft":e.originPosition,scale:e.tolerance?[e.tolerance,e.tolerance]:[1,1],translate:(0,a.pC)(e.extent)?[e.extent.xmin,e.extent.ymax]:[0,0]}:null}function l({scale:e,translate:t},r){return Math.round((r-t[0])/e[0])}function m({scale:e,translate:t},r){return Math.round((t[1]-r)/e[1])}function h(e,t,r){const a=[];let n,i,s,o;for(let c=0;c<r.length;c++){const h=r[c];c>0?(s=l(e,h[0]),o=m(e,h[1]),s===n&&o===i||(a.push(t(h,s-n,o-i)),n=s,i=o)):(n=l(e,h[0]),i=m(e,h[1]),a.push(t(h,n,i)))}return a.length>0?a:null}function u({scale:e,translate:t},r){return r*e[0]+t[0]}function f({scale:e,translate:t},r){return t[1]-r*e[1]}function g(e,t,r){const a=new Array(r.length);if(!r.length)return a;const[n,i]=e.scale;let s=u(e,r[0][0]),o=f(e,r[0][1]);a[0]=t(r[0],s,o);for(let e=1;e<r.length;e++){const c=r[e];s+=c[0]*n,o-=c[1]*i,a[e]=t(c,s,o)}return a}function y(e,t,r){const a=new Array(r.length);for(let n=0;n<r.length;n++)a[n]=g(e,t,r[n]);return a}function p(e,t,r,a,n){return t.x=l(e,r.x),t.y=m(e,r.y),t!==r&&(a&&(t.z=r.z),n&&(t.m=r.m)),t}function d(e,t){return e&&t?(0,n.wp)(t)?p(e,{},t,!1,!1):(0,n.l9)(t)?function(e,t,r,a,n){const c=function(e,t,r,a){const n=[],c=r?a?o:s:a?s:i;for(let r=0;r<t.length;r++){const a=h(e,c,t[r]);a&&a.length>=2&&n.push(a)}return n.length?n:null}(e,r.paths,a,n);return c?(t.paths=c,t):null}(e,{},t,!1,!1):(0,n.oU)(t)?function(e,t,r,a,n){const c=function(e,t,r,a){const n=[],c=r?a?o:s:a?s:i;for(let r=0;r<t.length;r++){const a=h(e,c,t[r]);a&&a.length>=3&&n.push(a)}return n.length?n:null}(e,r.rings,a,n);return c?(t.rings=c,t):null}(e,{},t,!1,!1):(0,n.aW)(t)?function(e,t,r,a,n){return t.points=function(e,t,r,a){return h(e,r?a?o:s:a?s:i,t)}(e,r.points,a,n),t}(e,{},t,!1,!1):(0,n.YX)(t)?function(e,t,r,a,n){return t.xmin=l(e,r.xmin),t.ymin=m(e,r.ymin),t.xmax=l(e,r.xmax),t.ymax=m(e,r.ymax),t}(e,{},t):null:null}function C(e,t,r,n,c){return(0,a.pC)(r)&&(t.points=function(e,t,r,a){return g(e,r?a?o:s:a?s:i,t)}(e,r.points,n,c)),t}function w(e,t,r,n,i){return(0,a.Wi)(r)||(t.x=u(e,r.x),t.y=f(e,r.y),t!==r&&(n&&(t.z=r.z),i&&(t.m=r.m))),t}function P(e,t,r,n,c){return(0,a.pC)(r)&&(t.rings=function(e,t,r,a){return y(e,r?a?o:s:a?s:i,t)}(e,r.rings,n,c)),t}function M(e,t,r,n,c){return(0,a.pC)(r)&&(t.paths=function(e,t,r,a){return y(e,r?a?o:s:a?s:i,t)}(e,r.paths,n,c)),t}},556:(e,t,r)=>{r.d(t,{Z:()=>o});var a=r(95215),n=r(10927),i=r(89626),s=r(60789);class o{constructor(e){this._resourceManager=e}dispose(){this._rasterizationCanvas=null}rasterizeJSONResource(e,t,r){if(this._rasterizationCanvas||(this._rasterizationCanvas=document.createElement("canvas")),"simple-fill"===e.type||"esriSFS"===e.type){const[r,n,i]=a.fN.rasterizeSimpleFill(this._rasterizationCanvas,e.style,t);return{size:[n,i],image:new Uint32Array(r.buffer),sdf:!1,simplePattern:!0,anchorX:0,anchorY:0}}if("simple-line"===e.type||"esriSLS"===e.type||"line"===e.type&&e.dashTemplate){let t,r;if("simple-line"===e.type||"esriSLS"===e.type)switch(t=(0,a.U1)(e.style,e.cap),e.cap){case"butt":r="Butt";break;case"square":r="Square";break;default:r="Round"}else t=e.dashTemplate,r=e.cim.capStyle;const[n,i,s]=a.fN.rasterizeSimpleLine(t,r);return{size:[i,s],image:new Uint32Array(n.buffer),sdf:!0,simplePattern:!0,anchorX:0,anchorY:0}}let s,o,c;if("simple-marker"===e.type||"esriSMS"===e.type||"line-marker"===e.type?(s=a.B$.fromSimpleMarker(e),c=(0,i.Fp)(s)):e.cim&&"CIMHatchFill"===e.cim.type?(s=a.B$.fromCIMHatchFill(e.cim),o=new n.Z(s.frame.xmin,-s.frame.ymax,s.frame.xmax-s.frame.xmin,s.frame.ymax-s.frame.ymin)):e.cim.markerPlacement&&"CIMMarkerPlacementInsidePolygon"===e.cim.markerPlacement.type?(s=a.B$.fromCIMInsidePolygon(e.cim),o=new n.Z(s.frame.xmin,-s.frame.ymax,s.frame.xmax-s.frame.xmin,s.frame.ymax-s.frame.ymin)):(s=e.cim,c=(0,i.Fp)(s)),c&&!r){const[e,t,r]=(0,i.RL)(c);return e?{size:[t,r],image:new Uint32Array(e.buffer),sdf:!0,simplePattern:!0,anchorX:0,anchorY:0}:null}const[l,m,h,u,f]=a.B$.rasterize(this._rasterizationCanvas,s,o,this._resourceManager,!r);return l?{size:[m,h],image:new Uint32Array(l.buffer),sdf:!1,simplePattern:!1,anchorX:u,anchorY:f}:null}rasterizeImageResource(e,t,r,a){this._rasterizationCanvas||(this._rasterizationCanvas=document.createElement("canvas")),this._rasterizationCanvas.width=e,this._rasterizationCanvas.height=t;const n=this._rasterizationCanvas.getContext("2d");r instanceof ImageData?n.putImageData(r,0,0):(r.setAttribute("width",`${e}px`),r.setAttribute("height",`${t}px`),n.drawImage(r,0,0,e,t));const i=n.getImageData(0,0,e,t),o=new Uint8Array(i.data);if(a)for(const e of a)if(e&&e.oldColor&&4===e.oldColor.length&&e.newColor&&4===e.newColor.length){const[t,r,a,n]=e.oldColor,[i,s,c,l]=e.newColor;if(t===i&&r===s&&a===c&&n===l)continue;for(let e=0;e<o.length;e+=4)t===o[e]&&r===o[e+1]&&a===o[e+2]&&n===o[e+3]&&(o[e]=i,o[e+1]=s,o[e+2]=c,o[e+3]=l)}let c;for(let e=0;e<o.length;e+=4)c=o[e+3]/255,o[e]=o[e]*c,o[e+1]=o[e+1]*c,o[e+2]=o[e+2]*c;let l=o,m=e,h=t;const u=512;if(m>=u||h>=u){const r=m/h;r>1?(m=u,h=Math.round(u/r)):(h=u,m=Math.round(u*r)),l=new Uint8Array(4*m*h);const a=new Uint8ClampedArray(l.buffer);(0,s.TT)(o,e,t,a,m,h,!1)}return{size:[m,h],image:new Uint32Array(l.buffer),sdf:!1,simplePattern:!1,anchorX:0,anchorY:0}}}},48024:(e,t,r)=>{r.r(t),r.d(t,{previewCIMSymbol:()=>x});var a,n,i=r(95550),s=r(30936),o=r(66341),c=r(78668),l=r(21130),m=r(53736),h=r(75312),u=r(19849),f=r(556),g=r(89417),y=r(60789),p=r(97500),d=r(37939);(n=a||(a={})).Legend="legend",n.Preview="preview";const C=(e,t,r)=>{if(e&&e.targetSize){let a;if(r){const t=Math.max(r.frame.xmax-r.frame.xmin,r.frame.ymax-r.frame.ymin);a=e.targetSize/(0,i.F2)(t)}else a=e.targetSize/t.referenceSize;return a}return e&&e.scaleFactor?e.scaleFactor:1},w={fill:{legend:{frame:{xmax:15,xmin:0,ymax:15,ymin:0},geometry:{rings:[[[0,15],[15,7.5],[15,0],[0,0],[0,15]]]},canvasPaths:{rings:[[[0,15],[0,0],[15,7.5],[15,15],[0,15]]]}},preview:{frame:{xmax:100,xmin:0,ymax:100,ymin:0},geometry:{rings:[[[0,100],[100,100],[100,0],[0,0],[0,100]]]},canvasPaths:{rings:[[[0,100],[0,0],[100,0],[100,100],[0,100]]]}}},stroke:{legend:{frame:{xmax:24,xmin:0,ymax:2,ymin:-2},geometry:{paths:[[[0,0],[12,0],[24,0]]]},canvasPaths:{paths:[[[0,2],[12,2],[24,2]]]}},preview:{frame:{xmax:100,xmin:0,ymax:2,ymin:-2},geometry:{paths:[[[0,0],[50,0],[100,0]]]},canvasPaths:{paths:[[[0,2],[50,2],[100,2]]]}}}};function P(e,t,r,a){let n,i;return"function"==typeof e.materialHash?(n=(0,e.materialHash)(t,r,a),i=(0,h.S)(e.cim,e.materialOverrides)):(n=e.materialHash,i=e.cim),{analyzedCIM:i,hash:n}}var M=r(83773),v=r(64194);const z=new class{constructor(e,t){this._spatialReference=e,this._avoidSDF=t,this._resourceCache=new Map,this._pictureMarkerCache=new Map,this._textRasterizer=new g.Z,this._cimResourceManager=new u.Z,this._rasterizer=new f.Z(this._cimResourceManager)}async rasterizeCIMSymbolAsync(e,t,r,a,n,i,s,o){a=a||(t?null!=t.centroid?"esriGeometryPolygon":(0,m.Ji)(t.geometry):null)||function(e){if(!(e&&e.data&&e.data.symbol))return null;switch(e.data.symbol.type){case"CIMPointSymbol":case"CIMTextSymbol":return"esriGeometryPoint";case"CIMLineSymbol":return"esriGeometryPolyline";case"CIMPolygonSymbol":return"esriGeometryPolygon";default:return null}}(e);const c=await this.analyzeCIMSymbol(e,t?function(e){return(e?Object.keys(e):[]).map((t=>({name:t,alias:t,type:"string"==typeof e[t]?"esriFieldTypeString":"esriFieldTypeDouble"})))}(t.attributes):null,r,a,o);return this.rasterizeCIMSymbol(c,t,a,n,i,s)}async analyzeCIMSymbol(e,t,r,a,n){const i=[],s=t?{geometryType:a,spatialReference:this._spatialReference,fields:t}:null;let o;await(0,h.c)(e.data,s,this._cimResourceManager,i,this._avoidSDF),(0,c.k_)(n);for(const e of i)"CIMPictureMarker"!==e.cim.type&&"CIMPictureFill"!==e.cim.type&&"CIMPictureStroke"!==e.cim.type||(o||(o=[]),o.push(this._fetchPictureMarkerResource(e,n))),r&&"text"===e.type&&"string"==typeof e.text&&e.text.includes("[")&&(e.text=(0,y.Qs)(r,e.text,e.cim.textCase));return o&&await Promise.all(o),i}async _fetchPictureMarkerResource(e,t){const r=e.materialHash;if(!this._pictureMarkerCache.get(r)){const a=(await(0,o.default)(e.cim.url,{responseType:"image",signal:t&&t.signal})).data;this._pictureMarkerCache.set(r,a)}}rasterizeCIMSymbol(e,t,r,a,n,i){const s=[];for(const o of e){a&&"function"==typeof a.scaleFactor&&(a.scaleFactor=a.scaleFactor(t,n,i));const e=this._getRasterizedResource(o,t,r,a,n,i);if(!e)continue;let c=0,l=e.anchorX||0,m=e.anchorY||0,h=!1,u=0,f=0;if("esriGeometryPoint"===r){const e=C(a,o,null);if(u=(0,y.hf)(o.offsetX,t,n,i)*e||0,f=(0,y.hf)(o.offsetY,t,n,i)*e||0,"marker"===o.type)c=(0,y.hf)(o.rotation,t,n,i)||0,h=!!o.rotateClockwise&&o.rotateClockwise;else if("text"===o.type){if(c=(0,y.hf)(o.angle,t,n,i)||0,void 0!==o.horizontalAlignment)switch(o.horizontalAlignment){case"left":l=-.5;break;case"right":l=.5;break;default:l=0}if(void 0!==o.verticalAlignment)switch(o.verticalAlignment){case"top":m=.5;break;case"bottom":m=-.5;break;case"baseline":m=-.25;break;default:m=0}}}null!=e&&s.push({angle:c,rotateClockWise:h,anchorX:l,anchorY:m,offsetX:u,offsetY:f,rasterizedResource:e})}return this.getSymbolImage(s)}getSymbolImage(e){const t=document.createElement("canvas"),r=t.getContext("2d");let a=0,n=0,s=0,o=0;const c=[];for(let t=0;t<e.length;t++){const l=e[t],m=l.rasterizedResource;if(!m)continue;const h=m.size,u=l.offsetX,f=l.offsetY,g=l.anchorX,y=l.anchorY,p=l.rotateClockWise||!1;let d=l.angle,C=(0,i.F2)(u)-h[0]*(.5+g),w=(0,i.F2)(f)-h[1]*(.5+y),P=C+h[0],M=w+h[1];if(d){p&&(d=-d);const e=Math.sin(d*Math.PI/180),t=Math.cos(d*Math.PI/180),r=C*t-w*e,a=C*e+w*t,n=C*t-M*e,i=C*e+M*t,s=P*t-M*e,o=P*e+M*t,c=P*t-w*e,l=P*e+w*t;C=Math.min(r,n,s,c),w=Math.min(a,i,o,l),P=Math.max(r,n,s,c),M=Math.max(a,i,o,l)}a=C<a?C:a,n=w<n?w:n,s=P>s?P:s,o=M>o?M:o;const v=r.createImageData(m.size[0],m.size[1]);v.data.set(new Uint8ClampedArray(m.image.buffer));const z={offsetX:u,offsetY:f,rotateClockwise:p,angle:d,rasterizedImage:v,anchorX:g,anchorY:y};c.push(z)}t.width=s-a,t.height=o-n;const l=-a,m=o;for(let e=0;e<c.length;e++){const t=c[e],a=this._imageDataToCanvas(t.rasterizedImage),n=t.rasterizedImage.width,s=t.rasterizedImage.height,o=l-n*(.5+t.anchorX),h=m-s*(.5-t.anchorY);if(t.angle){const e=(360-t.angle)*Math.PI/180;r.save(),r.translate((0,i.F2)(t.offsetX),-(0,i.F2)(t.offsetY)),r.translate(l,m),r.rotate(e),r.translate(-l,-m),r.drawImage(a,o,h),r.restore()}else r.drawImage(a,o+(0,i.F2)(t.offsetX),h-(0,i.F2)(t.offsetY))}const h=new d.e({x:l/t.width-.5,y:m/t.height-.5});return{imageData:0!==t.width&&0!==t.height?r.getImageData(0,0,t.width,t.height):r.createImageData(1,1),anchorPosition:h}}_imageDataToCanvas(e){this._imageDataCanvas||(this._imageDataCanvas=document.createElement("canvas"));const t=this._imageDataCanvas,r=t.getContext("2d");return t.width=e.width,t.height=e.height,r.putImageData(e,0,0),t}_imageTo32Array(e,t,r,a){this._imageDataCanvas||(this._imageDataCanvas=document.createElement("canvas"));const n=this._imageDataCanvas,i=n.getContext("2d");if(n.width=t,n.height=r,i.drawImage(e,0,0,t,r),a){i.save();const n=new s.Z(a);i.fillStyle=n.toHex(),i.globalCompositeOperation="multiply",i.fillRect(0,0,t,r),i.globalCompositeOperation="destination-atop",i.drawImage(e,0,0,t,r),i.restore()}return new Uint32Array(i.getImageData(0,0,t,r).data.buffer)}_getRasterizedResource(e,t,r,n,i,s){let o,c,m,h,u=null,f=null;if("esriGeometryPolyline"===r||"esriGeometryPolygon"===r){const h=n&&n.style?n.style:a.Legend,g="esriGeometryPolyline"===r?w.stroke[h]:w.fill[h];if("line"===e.type){if("CIMSolidStroke"!==e.cim.type){if("CIMPictureStroke"===e.cim.type){const r=(0,y.hf)(e.width,t,i,s),a=(0,y.hf)(e.color,t,i,s),{image:n,width:o,height:c}=this._getPictureResource(e,r,a);return this._rasterizePictureResource(e,n,o,c,g,r)}return null}({analyzedCIM:o,hash:m}=P(e,t,i,s)),c=this._embedCIMLayerInVectorMarker(o,g)}else if("marker"===e.type){if("CIMPictureMarker"===e.cim.type){const r=(0,y.hf)(e.size,t,i,s),a=(0,y.hf)(e.color,t,i,s),{image:n,width:o,height:c}=this._getPictureResource(e,r,a);return this._rasterizePictureResource(e,n,o,c,g,r)}if("CIMVectorMarker"!==e.cim.type)return null;e.cim.offsetX=(0,y.hf)(e.offsetX,t,i,s),e.cim.offsetY=(0,y.hf)(e.offsetY,t,i,s),e.cim.rotation=(0,y.hf)(e.rotation,t,i,s),e.cim.markerPlacement=e.markerPlacement,({analyzedCIM:o}=P(e,t,i,s)),m=(0,l.hP)(JSON.stringify(o)).toString(),c=this._embedCIMLayerInVectorMarker(o,g),u=(0,y.hf)(e.size,t,i,s),f=e.path}else{if("text"===e.type)return null;if("fill"===e.type){if("CIMHatchFill"===e.cim.type||"CIMVectorMarker"===e.cim.type||"CIMPictureMarker"===e.cim.type||"CIMPictureFill"===e.cim.type){const r=e.cim.size||e.cim.height;let a,n,c;if("CIMPictureMarker"===e.cim.type||"CIMPictureFill"===e.cim.type)({image:a,width:n,height:c}=this._getPictureResource(e,r,(0,y.hf)(e.color,t,i,s)));else{({analyzedCIM:o,hash:m}=P(e,t,i,s));const l=this._rasterizer.rasterizeJSONResource({cim:o,type:e.type,url:e.url,mosaicHash:m,size:r,path:f},1,this._avoidSDF);a=l.image,n=l.size[0],c=l.size[1]}return this._rasterizePictureResource(e,a,n,c,g,null)}if("CIMSolidFill"!==e.cim.type)return null;({analyzedCIM:o,hash:m}=P(e,t,i,s)),c=this._embedCIMLayerInVectorMarker(o,g)}}}else{if("text"===e.type)return h=this._rasterizeTextResource(e,t,n,i,s),h;({analyzedCIM:o,hash:m}=P(e,t,i,s));const r=C(n,e,null);if("CIMPictureMarker"===e.cim.type){const a=(0,y.hf)(e.size,t,i,s)*r,{image:n,width:o,height:c}=this._getPictureResource(e,a,(0,y.hf)(e.color,t,i,s));return h={image:n,size:[o,c],sdf:!1,simplePattern:!1,anchorX:e.anchorPoint?e.anchorPoint.x:0,anchorY:e.anchorPoint?e.anchorPoint.y:0},h}(0,p.FW)(o,r,{preserveOutlineWidth:!1}),c=o}m+=r,n&&(m+=JSON.stringify(n));const g=this._resourceCache;return g.has(m)?g.get(m):(h=this._rasterizer.rasterizeJSONResource({cim:c,type:e.type,url:e.url,mosaicHash:m,size:u,path:f},window.devicePixelRatio||1,this._avoidSDF),g.set(m,h),h)}_rasterizeTextResource(e,t,r,a,n){const i=C(r,e,null),s=(0,y.hf)(e.text,t,a,n);if(!s||0===s.length)return null;const o=(0,y.hf)(e.fontName,t,a,n),c=(0,y.hf)(e.style,t,a,n),l=(0,y.hf)(e.weight,t,a,n),m=(0,y.hf)(e.decoration,t,a,n),h=(0,y.hf)(e.size,t,a,n)*i,u=(0,y.hf)(e.horizontalAlignment,t,a,n),f=(0,y.hf)(e.verticalAlignment,t,a,n),g=(0,y.nn)((0,y.hf)(e.color,t,a,n)),p=(0,y.nn)((0,y.hf)(e.outlineColor,t,a,n)),d={color:g,size:h,horizontalAlignment:u,verticalAlignment:f,font:{family:o,style:c,weight:l,decoration:m},halo:{size:(0,y.hf)(e.outlineSize,t,a,n)||0,color:p,style:c},pixelRatio:1,premultiplyColors:!this._avoidSDF};return this._textRasterizer.rasterizeText(s,d)}_rasterizePictureResource(e,t,r,a,n,s){const o=document.createElement("canvas"),c=o.getContext("2d");o.height=(0,i.F2)(Math.max(n.frame.ymax-n.frame.ymin,s)),o.width=(0,i.F2)(n.frame.xmax-n.frame.xmin);const l=c.createImageData(r,a);l.data.set(new Uint8ClampedArray(t.buffer));const h=this._imageDataToCanvas(l),u=c.createPattern(h,"repeat"),f=Math.cos((-e.cim.rotation||0)*Math.PI/180),g=Math.sin((-e.cim.rotation||0)*Math.PI/180);u.setTransform({m11:f,m12:g,m21:-g,m22:f,m41:(0,i.F2)(e.cim.offsetX)||0,m42:(0,i.F2)(e.cim.offsetY)||0});const y=n.canvasPaths;let p,d,C;(0,m.oU)(y)?(p=y.rings,c.fillStyle=u,d=c.fill,C=["evenodd"]):(0,m.l9)(y)&&(p=y.paths,c.strokeStyle=u,c.lineWidth=s,d=c.stroke,p[0][0][1]=o.height/2,p[0][1][1]=o.height/2),c.beginPath();for(const e of p){const t=e?e.length:0;if(t>1){let r=e[0];c.moveTo((0,i.F2)(r[0]),(0,i.F2)(r[1]));for(let a=1;a<t;++a)r=e[a],c.lineTo((0,i.F2)(r[0]),(0,i.F2)(r[1]));c.closePath()}}d.apply(c,C);const w=c.getImageData(0,0,o.width,o.height),P=new Uint8Array(w.data);return{size:[o.width,o.height],image:new Uint32Array(P.buffer),sdf:!1,simplePattern:!1,anchorX:0,anchorY:0}}_getPictureResource(e,t,r){const a=this._pictureMarkerCache.get(e.materialHash);if(!a)return null;const n=a.height/a.width,s=t?n>1?(0,i.F2)(t):(0,i.F2)(t)/n:a.width,o=t?n>1?(0,i.F2)(t)*n:(0,i.F2)(t):a.height;return{image:this._imageTo32Array(a,s,o,r),width:s,height:o}}_embedCIMLayerInVectorMarker(e,t){const r=(0,m.oU)(t.geometry)?"CIMPolygonSymbol":"CIMLineSymbol",a=t.frame;return{type:"CIMVectorMarker",frame:a,size:a.ymax-a.ymin,markerGraphics:[{type:"CIMMarkerGraphic",geometry:t.geometry,symbol:{type:r,symbolLayers:[e]}}]}}}(null,!0),b=M.b_.maxSize;async function x(e,t={}){const{size:r,maxSize:a,node:n,opacity:s}=t,o=t.cimOptions||t,{feature:c,fieldMap:l,geometryType:m,style:h}=o,u=(0,p.kW)(e),f="number"==typeof r?r:null,g=Math.min(null!=f?f:u,null!=a?a:(0,i.Wz)(b));g!==u&&(e=e.clone(),(0,p.PI)(e,g,{preserveOutlineWidth:!0}));let y=3;e&&e.data&&e.data.symbol&&"CIMPointSymbol"!==e.data.symbol.type&&(y=1);const d=await z.rasterizeCIMSymbolAsync(e,c,l,m,{scaleFactor:y,style:h}),C=document.createElement("canvas");C.width=d.imageData.width,C.height=d.imageData.height,C.getContext("2d").putImageData(d.imageData,0,0);let w=C.width/y,P=C.height/y;if(null!=r&&(null==t?.scale||t?.scale)){const e=w/P;w=e<=1?Math.ceil(g*e):g,P=e<=1?g:Math.ceil(g/e)}const M=new Image(w,P);M.src=C.toDataURL(),null!=s&&(M.style.opacity=`${s}`);let x=M;if(null!=t.effectView){const e={shape:{type:"image",x:0,y:0,width:w,height:P,src:M.src},fill:null,stroke:null,offset:[0,0]};x=(0,v.w)([[e]],[w,P],{effectView:t.effectView})}return n&&n.appendChild(x),x}},31090:(e,t,r)=>{var a,n;function i(e){switch(e){case"left":return a.Left;case"right":return a.Right;case"center":return a.Center}}function s(e){switch(e){case"top":return n.Top;case"middle":return n.Center;case"baseline":return n.Baseline;case"bottom":return n.Bottom}}function o(e){switch(e){case"above-left":case"esriServerPointLabelPlacementAboveLeft":return[a.Right,n.Bottom];case"above-center":case"above-along":case"esriServerPointLabelPlacementAboveCenter":case"esriServerLinePlacementAboveAlong":return[a.Center,n.Bottom];case"above-right":case"esriServerPointLabelPlacementAboveRight":return[a.Left,n.Bottom];case"center-left":case"esriServerPointLabelPlacementCenterLeft":return[a.Right,n.Center];case"center-center":case"center-along":case"esriServerPointLabelPlacementCenterCenter":case"esriServerLinePlacementCenterAlong":case"always-horizontal":case"esriServerPolygonPlacementAlwaysHorizontal":return[a.Center,n.Center];case"center-right":case"esriServerPointLabelPlacementCenterRight":return[a.Left,n.Center];case"below-left":case"esriServerPointLabelPlacementBelowLeft":return[a.Right,n.Top];case"below-center":case"below-along":case"esriServerPointLabelPlacementBelowCenter":case"esriServerLinePlacementBelowAlong":return[a.Center,n.Top];case"below-right":case"esriServerPointLabelPlacementBelowRight":return[a.Left,n.Top];default:return console.debug(`Found invalid placement type ${e}`),[a.Center,n.Center]}}function c(e){switch(e){case a.Right:return-1;case a.Center:return 0;case a.Left:return 1;default:return console.debug(`Found invalid horizontal alignment ${e}`),0}}function l(e){switch(e){case n.Top:return 1;case n.Center:return 0;case n.Bottom:case n.Baseline:return-1;default:return console.debug(`Found invalid vertical alignment ${e}`),0}}function m(e){switch(e){case"left":return a.Left;case"right":return a.Right;case"center":return a.Center}}function h(e){switch(e){case"above-along":case"below-along":case"center-along":case"esriServerLinePlacementAboveAlong":case"esriServerLinePlacementBelowAlong":case"esriServerLinePlacementCenterAlong":return!0;default:return!1}}r.d(t,{Hd:()=>m,M7:()=>a,NS:()=>h,TR:()=>n,b7:()=>s,g:()=>c,kH:()=>i,qv:()=>o,tf:()=>l}),function(e){e[e.Left=-1]="Left",e[e.Center=0]="Center",e[e.Right=1]="Right"}(a||(a={})),function(e){e[e.Top=1]="Top",e[e.Center=0]="Center",e[e.Bottom=-1]="Bottom",e[e.Baseline=2]="Baseline"}(n||(n={}))},8530:(e,t,r)=>{r.d(t,{Au:()=>n,Jz:()=>s,UJ:()=>i});const a=new Float32Array(1);function n(e){return[255&e,(65280&e)>>>8,(16711680&e)>>>16,(4278190080&e)>>>24]}function i(e,t){return 65535&e|t<<16}function s(e,t,r,a){return 255&e|(255&t)<<8|(255&r)<<16|a<<24}new Uint32Array(a.buffer)}}]);